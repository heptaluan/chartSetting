!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).d3Chart={})}(this,function(t){"use strict";function x(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2*Math.PI,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0,o=t,r=e,a=n;Math.abs(a-r-2*Math.PI)<=1e-5&&(a-=1e-5);var l=Math.cos(r-Math.PI/2)*o,s=Math.sin(r-Math.PI/2)*o,u=Math.cos(a-Math.PI/2)*o,c=Math.sin(a-Math.PI/2)*o,h=0,d=1;function _(){return o+" "+o+" 0 "+h+" "+d+" "}return Math.abs(a-r)>=Math.PI&&(h=1),void 0!==i?d=isNaN(Number(i))?1:Number(i):void 0===i&&(a+r)/2>Math.PI/2&&(a+r)/2<Math.PI/2*3&&(d=0),d?"M"+l+" "+s+"A"+_()+" "+u+" "+c:"M"+u+" "+c+"A"+_()+" "+l+" "+s}function k(t){return"none"!==t.style("display")?t.node().getBBox():{x:0,y:0,width:0,height:0}}function e(t){t.style("display","block")}function n(t){t.style("display","none")}function E(t,e,n){t.attr("transform","translate("+e+","+n+")")}function i(t){var e=t+Math.floor(1e9*Math.random()).toString(32)+Date.now().toString(32);return null==document.getElementById(e)?e:i(t)}function C(t){return t.filter(function(t){return!1!==t.active})}function S(t,e,n,i){var o=Math.min(t,e)/2,r=t/2,a=e/2,l=0;if(Math.abs(i-n)<=Math.PI/2){var s=Math.min(i,n),u=Math.max(i,n);o=Math.min(t,e),0<=s&&u<=Math.PI/2?(r=(t-o)/2,a=(e-o)/2+o,l=1):s>=Math.PI/2&&u<=Math.PI?(r=(t-o)/2,a=(e-o)/2,l=2):s>=Math.PI&&u<=3*Math.PI/2?(r=(t-o)/2+o,a=(e-o)/2,l=3):s>=3*Math.PI/2&&u<=2*Math.PI&&(r=(t-o)/2+o,a=(e-o)/2+o,l=4)}return{radius:o,cx:r,cy:a,quadrant:l}}function y(t){var e=t.split(/[\-\/]/);if(3!==e.length)return t;if(e[0].length<4){var n=d3.range(4-e[0].length).map(function(){return 0}).join("");e[0]=n+e[0]}return 1===e[1].length&&(e[1]="0"+e[1]),1===e[2].length&&(e[2]="0"+e[2]),e.join("-")}function w(t,e){var n,i=window.location.href;return void 0===e&&(e="Safari"==(-1<(n=navigator.userAgent).indexOf("Opera")||-1<n.indexOf("OPR")?"Opera":-1<n.indexOf("compatible")&&-1<n.indexOf("MSIE")?"IE":-1<n.indexOf("Edge")?"Edge":-1<n.indexOf("Firefox")?"Firefox":-1<n.indexOf("Safari")&&-1==n.indexOf("Chrome")?"Safari":-1<n.indexOf("Chrome")&&-1<n.indexOf("Safari")?"Chrome":window.ActiveXObject||"ActiveXObject"in window?"IE>=11":"Unkonwn")&&!/\/#\//.test(i)),e?i+t:t}function u(t,e){var n=/[^\u4e00-\u9fa5\w-]/gi;return e=null==e||n.test(e)?"-":e,t.toString().replace(n,e)}function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return Math.abs(parseFloat(t))||e}function p(t){for(var e=t.x,n=void 0===e?0:e,i=t.y,o=void 0===i?0:i,r=t.width,a=void 0===r?100:r,l=t.height,s=void 0===l?100:l,u=t.cornerRadius,c=void 0===u?0:u,h=t.roundCorners,d=void 0===h?[0,1,2,3]:h,_=n,f=o,p=n+a,y=o+s,v=Math.min(Math.min(a,s)/2,c),g=v+" "+v+" 0 0 1",m=["L"+_+" "+f,"L"+p+" "+f,"L"+p+" "+y,"L"+_+" "+y],x=["A"+g+" "+(_+v)+" "+f,"A"+g+" "+p+" "+(f+v),"A"+g+" "+(p-v)+" "+y,"A"+g+" "+_+" "+(y-v)],k=[],S=0;S<=3;S++){var w=d.includes(S)?x[S]:m[S];k.push(w)}return"\n    M"+_+" "+(f+v)+"\n    "+k[0]+"\n    H"+(p-v)+"\n    "+k[1]+"\n    V"+(y-v)+"\n    "+k[2]+"\n    H"+(_+v)+"\n    "+k[3]+"\n    Z\n  "}var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),s=function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,i)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(i):void 0},c=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},g=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},l=function(){function t(){r(this,t),this.elem=null,this._pos=[0,0],this._show=!0,this.id=i("")}return a(t,[{key:"update",value:function(){}},{key:"show",value:function(){return e(this.elem),this._show=!0,this}},{key:"hide",value:function(){return n(this.elem),this._show=!1,this}},{key:"width",value:function(){return k(this.elem).width}},{key:"height",value:function(){return k(this.elem).height}},{key:"translate",value:function(t,e){return arguments.length?(this.pos=[t,e],E(this.elem,t,e),this):this.pos}},{key:"isShow",get:function(){return this._show}}]),t}();function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];return!e.length||e[0].length<(n||2)||t.some(function(t){return void 0===e[0][t]})}function O(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return t.slice(1).some(function(t){return!isNaN(parseFloat(t[e]))})}function d(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),m(t,[n,i])||!O(t,i))return[];var o=[],r=t[0][n],a=t[0][i];return t.slice(1).forEach(function(t){var e=parseFloat(t[i]);isNaN(e)||o.push({name:t[n],value:+t[i],nameLabel:r,valueLabel:a})}),o.forEach(function(t,e){t.key=u(t.name)+"-"+e}),o}function _(t,e){var n=0,i=!1,o=[];e.forEach(function(t){"objCol"===t.function?(n=t.index,i=t.isLegend):"vCol"===t.function&&0==t.configurable&&o.push(t.index)});var r={},a=[],l=t.length,s=t[0];if(i){for(var u=[],c=1;c<l;c++)u.push(t[c].length);u.sort(function(t,e){return e-t});for(var h=1;h<l;h++){var d=t[h],_=d[n];if(_){for(var f={name:_,data:[]},p=0;p<u[0];p++){var y=s[p];p!==n&&y&&f.data.push({name:y,value:""==d[p]?0:d[p]})}a.push(f)}}}else{for(var v=1;v<s.length;v++)-1==o.indexOf(v)&&v!==n&&s[v]&&(r[s[v]]={name:s[v],data:[]});for(var g=[],m=1;m<l;m++)g.push(t[m].length);g.sort(function(t,e){return e-t});for(var x=1;x<l;x++){var k=t[x],S=k[n];if(S)for(var w=0;w<g[0];w++)if(-1==o.indexOf(w)){var b=s[w];w!==n&&b&&r[b].data.push({name:S,value:""==k[w]?0:k[w]})}}for(var O in r)a.push(r[O])}return a.forEach(function(t,e){t.key=t.name+"-"+e}),a}function A(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:12,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"sans-serif",r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"50%",a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"middle",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"...",s=t.append("text").style("text-anchor",a).style("font-size",i+"px").style("font-family",o).attr("dy","0.35em");return s.append("textPath").attr("startOffset",r).attr("xlink:href",function(){return"#"+e.attr("id")}).text(function(){var t=e.node().getTotalLength();return I(n,t,i,o,l)}),s}function H(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"sans-serif";if(!t.toString||!t)return 0;var i=d3.select("defs");i.empty()&&(i=d3.select("svg").append("defs"));var o=i.append("text").style("font-size",e+"px").style("font-family",n).text(t.toString()),r=o.node().getComputedTextLength();return o.remove(),r}function M(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"sans-serif";return Math.ceil(d3.max(t,function(t){return H(t,e,n)}))}function I(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:12,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"sans-serif",o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"...";if(H(t,n,i)<=e)return t;if(H(o,n,i)>=e)return"";for(var r=t.toString().split(""),a=r.length,l="",s=0;s<a;s++)if(H((l+=r[s])+o,n,i)>e)return 0===s?"":l.slice(0,s)+o}var f="legend-group",v=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","legend"),e.group=e.elem.append("g"),e._data=[],e._shapeType="circle",e._shapeWidth=16,e._shapeHeight=16,e._shapeStroke="none",e._rowGap=6,e._colGap=20,e._innerGap=6,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._limitedWidth=400,e._horizontalAlign="center",e._onClick=function(){},e._each=function(){},e._orient="horizontal",e}return c(n,l),a(n,[{key:"update",value:function(){var o=this,r=o.group,a=Math.max(o._shapeHeight,o._fontSize),l=o._limitedWidth-o._shapeWidth-o._innerGap,s=0,u=0;o.elem.selectAll("."+f).remove();var c=r.append("g").attr("class",f);o._data.forEach(function(t){var e=I(t.name,l,o._fontSize,o._fontFamily),n=o._shapeWidth+o._innerGap+H(e,o._fontSize,o._fontFamily);if("vertical"===o._orient)o._legendItem(t,c,0,u),u=u+a+o._rowGap;else{var i=s+n+o._colGap;i>o._limitedWidth&&(s=0,i=n+o._colGap,u+=a+o._rowGap,c=r.append("g").attr("class",f)),o._legendItem(t,c,s,u),s=i}});var t=k(r).width;return"center"===o._horizontalAlign?r.call(E,o._limitedWidth/2-t/2,0):"left"===o._horizontalAlign?r.call(E,0,0):"right"===o._horizontalAlign&&r.call(E,o._limitedWidth-t,0),o}},{key:"_shapeElem",value:function(t){var e=void 0;return(e="rect"===this._shapeType?t.append("rect").attr("width",this._shapeWidth).attr("height",this._shapeHeight):t.append("circle").attr("cx",this._shapeWidth/2).attr("cy",this._shapeHeight/2).attr("r",Math.min(this._shapeWidth,this._shapeHeight)/2)).attr("class","legend-shape"),e}},{key:"_legendItem",value:function(t,e,n,i){var o=e.append("g").datum(t).attr("class","legend-item").call(E,n,i).on("click",this._onClick).each(this._each);return this._shapeElem(o).style("fill",t.color),o.append("text").attr("x",this._shapeWidth+this._innerGap).attr("y",this._shapeHeight/2).attr("dy","0.35em").style("text-anchor","start").style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("fill",this._fontColor).text(I(t.name,this._limitedWidth-this._shapeWidth-this._innerGap,this._fontSize,this._fontFamily)),o}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}},{key:"shapeWidth",value:function(t){return arguments.length?(this._shapeWidth=t,this):this._shapeWidth}},{key:"shapeHeight",value:function(t){return arguments.length?(this._shapeHeight=t,this):this._shapeHeight}},{key:"rowGap",value:function(t){return arguments.length?(this._rowGap=t,this):this._rowGap}},{key:"colGap",value:function(t){return arguments.length?(this._colGap=t,this):this._colGap}},{key:"innerGap",value:function(t){return arguments.length?(this._innerGap=t,this):this._innerGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"onClick",value:function(t){return arguments.length?(this._onClick=t,this):this._onClick}},{key:"each",value:function(t){return arguments.length?(this._each=t,this):this._each}}]),n}(),F=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("text"),e._text="",e._fontSize=24,e._fontFamily="noto",e._fontWeight="normal",e._color="#000",e._textAnchor="middle",e._dy="1em",e}return c(n,l),a(n,[{key:"update",value:function(){var t=this;return t.elem.attr("dy",t._dy).style("fill",t._color).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("font-weight",t._fontWeight).style("text-anchor",t._textAnchor).text(t._text),t}},{key:"text",value:function(t){return arguments.length?(this._text=t,this):this._text}},{key:"color",value:function(t){return arguments.length?(this._color=t,this):this._color}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontWeight",value:function(t){return arguments.length?(this._fontWeight=t,this):this._fontWeight}},{key:"textAnchor",value:function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor}},{key:"dy",value:function(t){return arguments.length?(this._dy=t,this):this._dy}}]),n}(),R=function(t){function i(t){r(this,i);var e=h(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),n=t._groups?t:d3.select(t);return e.elem=n.append("div").attr("class","chart-tooltip").style("position","absolute").style("pointer-events","none").style("-moz-user-select","none").style("-webkit-user-select","none").style("-ms-user-select","none").style("user-select","none"),"static"!=n.style("position")&&"initial"!=n.style("position")||n.style("position","relative"),e._data=[],e._x=0,e._y=0,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#fff",e._backgroundColor="rgba(0,0,0,0.7)",e._borderRadius=5,e._padding={top:5,right:8,bottom:5,left:8},e._textAlign="left",e._locked=!1,e._scale=1,e._scaleValue=1,e}return c(i,l),a(i,[{key:"update",value:function(){var t=this,e=t._fontSize;if(t._locked)return t;t._scaleValue="function"==typeof t._scale?t._scale():t._scale,t.elem.style("background-color",t._backgroundColor).style("border-radius",t._borderRadius+"px").style("font-size",e+"px").style("font-family",t._fontFamily).style("color",t._fontColor).style("text-align",t._textAlign).style("padding",t._padding.top+"px "+t._padding.right+"px "+t._padding.bottom+"px "+t._padding.left+"px");var n=t.elem.selectAll("div").data(t._data);n.exit().remove();var i=n.enter().append("div").attr("class","tooltip-row").style("white-space","nowrap");i.append("span").attr("class","tooltip-color-circle"),i.append("span").attr("class","tooltip-text");var o=i.merge(n);return o.select(".tooltip-color-circle").style("width","0px").style("height","0px").style("border-radius","50%").style("display","inline-block").style("margin","0px").style("vertical-align","middle").filter(function(t){return t.color}).style("width",e+"px").style("height",e+"px").style("background-color",function(t){return t.color}).style("margin-right","3px"),o.select(".tooltip-text").text(function(t){return t.text}).style("vertical-align","middle"),this}},{key:"move",value:function(t){var e=this;if(e._locked||!e.isShow)return e;var n=e._scaleValue||1,i=0,o=0,r=e.elem,a=r.node().parentNode,l=r.node().getBoundingClientRect(),s=a.getBoundingClientRect(),u=t||d3.mouse(a);return o=u[0]+l.width+8>s.width?u[0]-l.width-8:u[0]+8,i=u[1]+l.height+5>s.height?u[1]-l.height-0:u[1]+0,r.transition().duration(10).style("top",i/n+"px").style("left",o/n+"px"),e}},{key:"show",value:function(){return this._locked||(e(this.elem),this._show=!0),this}},{key:"hide",value:function(){return this._locked||(n(this.elem),this._show=!1),this}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"lock",value:function(t){return arguments.length?(this._locked=t,this):this._locked}},{key:"scale",value:function(t){return arguments.length?(this._scale=t,this):this._scale}}]),i}();function W(t,n){return t.forEach(function(t,e){t.color=n[e],t.color_special=n[e+1]}),t}var z=function(){function n(t,e){r(this,n),this._blockData=t,this._projectTheme=e,this._dataSrc=t.dataSrc,this._blockTheme=t.theme,this._props=t.props,this._columnMap=this._props.map,this._legend=this._props.legend,this._font=this._props.font,this._axis=this._props.axis,this._title=this._props.titleDisplay,this._label=this._props.label,this._display=this._props.display,this._animation=this._props.animation,this._dataSolveFunc=d}return a(n,[{key:"dataSolveFunc",value:function(t){return arguments.length&&"function"==typeof t?(this._dataSolveFunc=t,this):this._dataSolveFunc}},{key:"generateColorList",value:function(t){var e,n,i,o=this._props.colors.type,r=(e=this._props.colors.list,n=this._blockData,i=this._projectTheme,e.map(function(t){return function(t,e,n){var i=void 0;if("number"==typeof t){var o=e.theme&&e.theme.colors;i=o&&o[t%o.length]||n&&n.colors[t]||"#000"}else i=t;return i}(t,n,i)}));if(!t)return r;var a=r;switch(o){case"linear":var l=r.slice(0,2),s=d3.scaleLinear().domain([0,t-1]).range(l);a=d3.range(t).map(function(t,e){return s(e)});break;case"single":a=d3.range(t).map(function(){return r[0]});break;default:if(a=r.slice(0),r.length<t)for(var u=r.length;a.push(r[u%r.length]),++u<t;);}return a}},{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return W(t,this.generateColorList(t.length))}},{key:"dataType",get:function(){var t="2d";if("cross-table"===this._dataSrc.dataType)t="cross-table";else{var e=this._dataSrc.data;t=e[1]?"2sheet":e[0].length+"d"}return t}},{key:"width",get:function(){return parseFloat(this._props.size.width)-2}},{key:"height",get:function(){return parseFloat(this._props.size.height)-2}},{key:"font",get:function(){return{fontSize:this._font.fontSize||this._blockData.theme.fonts.fontSize||12,color:this._font.color||this._blockData.theme.fonts.fontColor||"#000",fontFamily:this._font.fontFamily||this._blockData.theme.fonts.fontFamily||"sans-serif"}}},{key:"display",get:function(){return Object.assign({},this._props.display)}},{key:"legend",get:function(){return{show:!1!==this._legend.show,xPosition:this._legend.xPosition,yPosition:this._legend.yPosition}}},{key:"tooltipShow",get:function(){return this._props.tooltip}},{key:"axis",get:function(){return{color:this._axis.color||this._blockTheme.axis.color,x:this._axis.x,y:this._axis.y,y1:this._axis.y1}}},{key:"label",get:function(){return Object.assign({},this._props.label)}},{key:"grid",get:function(){var t=this._axis.grid;return{showX:"all"===t.show||"x"===t.show,showY:"all"===t.show||"y"===t.show,color:t.color||this._blockTheme.grid&&this._blockTheme.grid.color||"#ccc"}}},{key:"backgroundColor",get:function(){return this._props.backgroundColor||"transparent"}},{key:"title",get:function(){var t=this._title||{};return{show:!1!==t.show,text:t.text||"",xPosition:t.xPosition||"center",yPosition:t.yPosition||"top",fontSize:t.fontSize||24,color:t.color||"#000",fontFamily:t.fontFamily||"noto"}}}]),n}(),L=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t._groups?t.append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1"):d3.select(t).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1"),e.defs=e.elem.append("defs"),e.group=e.elem.append("g").attr("class","svg-group"),e.mainGroup=e.group.append("g").attr("class","main-group"),e.title=new F(e.group),e.legend=new v(e.group),e.tooltip=new R(t),e.labelTextClass="chart-label-text",e._data=[],e._width=400,e._height=400,e._backgroundColor=null,e._fontSize=12,e._fontColor="#000",e._fontFamily="sans-serif",e._transition=!0,e._duration=500,e._legendShow=!0,e._legendX="center",e._legendY="bottom",e._titleShow=!0,e._titleText="",e._titleX="center",e._titleY="top",e._titleFontSize=24,e._titleColor="#000",e._titleFontFamily="sans-serif",e._marginTop=9,e._marginRight=5,e._marginBottom=9,e._marginLeft=5,e._gapPadding=15,e._sortValue=0,e._sortedDataCopy=null,e._dataType="2d",e._tooltipShow=!0,e}return c(n,l),a(n,[{key:"update",value:function(){return this.styleSvg(),this.sortData(),this.removeLabelText(),this.updateTitle(),this.updateLegend(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateTitle",value:function(){var t=this,e=t.title;if(!t._titleShow)return e.hide();var n="center"===t._titleX?"middle":"left"===t._titleX?"start":"end";e.text(t._titleText).color(t._titleColor).fontSize(t._titleFontSize).fontFamily(t._titleFontFamily).fontWeight("bold").textAnchor(n).dy("1em"),e.update(),e.show()}},{key:"updateLegend",value:function(){var t=this,e=t.legend,n=t.widthOfNoMargin;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(n).fontSize(t._fontSize).fontFamily(t._fontFamily).fontColor(t._fontColor).horizontalAlign(t._legendX).each(function(t){var e=!1===t.active;d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy;t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"updateCore",value:function(){}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateCore()}},{key:"removeLabelText",value:function(){this.elem.selectAll("."+this.labelTextClass).remove()}},{key:"styleSvg",value:function(){this.elem.attr("width",this._width).attr("height",this._height).style("background-color",this._backgroundColor).style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("user-select","none"),this.group.call(E,this._marginLeft,this._marginTop)}},{key:"layout",value:function(){var t=this.title,e=this.legend,n=this.mainGroup,i=t.height(),o=e.height(),r=this.heightOfMainGroup,a=this._titleText?this._gapPadding:0,l=this._legendShow?this._gapPadding:0,s="top",u="bottom",c=this._titleY,h=this._legendY;c!==s&&c!==u&&(c=s),h!==s&&h!==u&&(h=u);var d=0,_=0,f=0;c===s&&h===s?(d=0,f=(_=i+a)+o+l):c===u&&h===u?(f=0,d=(_=r+l)+o+a):c===s&&h===u?(d=0,_=(f=i+a)+r+l):(_=0,d=(f=o+l)+r+a);var p=this.widthOfNoMargin,y="center"===this._titleX?p/2:"left"===this._titleX?0:p;t.translate(y,d),e.translate(0,_),n.call(E,0,f)}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"backgroundColor",value:function(t){return arguments.length?(this._backgroundColor=t,this):this._backgroundColor}},{key:"legendShow",value:function(t){return arguments.length?(this._legendShow=t,this):this._legendShow}},{key:"legendX",value:function(t){return arguments.length?(this._legendX=t,this):this._legendX}},{key:"legendY",value:function(t){return arguments.length?(this._legendY=t,this):this._legendY}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"gapPadding",value:function(t){return arguments.length?(this._gapPadding=parseFloat(t),this):this._gapPadding}},{key:"marginTop",value:function(t){return arguments.length?(this._marginTop=parseFloat(t),this):this._marginTop}},{key:"marginRight",value:function(t){return arguments.length?(this._marginRight=parseFloat(t),this):this._marginRight}},{key:"marginBottom",value:function(t){return arguments.length?(this._marginBottom=parseFloat(t),this):this._marginBottom}},{key:"marginLeft",value:function(t){return arguments.length?(this._marginLeft=parseFloat(t),this):this._marginLeft}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"sortValue",value:function(t){return arguments.length?(this._sortValue=parseFloat(t),this):this._sortValue}},{key:"dataType",value:function(t){return arguments.length?(this._dataType=t,this):this._dataType}},{key:"tooltipShow",value:function(t){return arguments.length?(this._tooltipShow=t,this):this._tooltipShow}},{key:"titleShow",value:function(t){return arguments.length?(this._titleShow=t,this):this._titleShow}},{key:"titleText",value:function(t){return arguments.length?(this._titleText=t,this):this._titleText}},{key:"titleColor",value:function(t){return arguments.length?(this._titleColor=t,this):this._titleColor}},{key:"titleFontSize",value:function(t){return arguments.length?(this._titleFontSize=t,this):this._titleFontSize}},{key:"titleFontFamily",value:function(t){return arguments.length?(this._titleFontFamily=t,this):this._titleFontFamily}},{key:"titleX",value:function(t){return arguments.length?(this._titleX=t,this):this._titleX}},{key:"titleY",value:function(t){return arguments.length?(this._titleY=t,this):this._titleY}},{key:"sortData",value:function(){var t=this._data.slice(0),e=this._sortValue,n=this._dataType,i=t.map(function(t){return t.color}),o=void 0;"cross-table"===n?(t.forEach(function(t){t.sum=d3.sum(t.data,function(t){return t.value})}),o=1===e?function(t,e){return t.sum-e.sum}:-1===e?function(t,e){return e.sum-t.sum}:null):o=1===e?function(t,e){return t.value-e.value}:-1===e?function(t,e){return e.value-t.value}:null,this._sortedDataCopy=o?t.sort(o).map(function(t,e){return t.color=i[e],t}):t}},{key:"buildOption",value:function(t,e){var n=new z(t,e),i=d;switch(n.dataType){case"cross-table":i=_;break;default:i=d}return n.dataSolveFunc(i),n}},{key:"setPublicOption",value:function(t){this.data(t.data).backgroundColor(t.backgroundColor).width(t.width).height(t.height),this.fontFamily(t.font.fontFamily).fontSize(t.font.fontSize).fontColor(t.font.color),this.titleShow(t.title.show).titleText(t.title.text).titleColor(t.title.color).titleFontFamily(t.title.fontFamily).titleFontSize(t.title.fontSize).titleX(t.title.xPosition).titleY(t.title.yPosition),this.legendShow(t.legend.show).legendX(t.legend.xPosition).legendY(t.legend.yPosition),this.tooltipShow(t.tooltipShow),this.dataType(t.dataType)}},{key:"setSelfOption",value:function(t){}},{key:"setOption",value:function(t,e,n){var i=this.buildOption(t,e);this.setPublicOption(i),this.setSelfOption(i),this.update()}},{key:"widthOfNoMargin",get:function(){var t=this._width-this._marginLeft-this._marginRight;return 0<t?t:0}},{key:"heightOfNoMargin",get:function(){var t=this._height-this._marginTop-this._marginBottom;return 0<t?t:0}},{key:"heightOfMainGroup",get:function(){var t=this._titleText?this.title.height()+this._gapPadding:0,e=this._legendShow?this.legend.height()+this._gapPadding:0,n=this.heightOfNoMargin-e-t;return 0<n?n:0}},{key:"activeData",get:function(){return C(this.sortedDataCopy)}},{key:"sortedDataCopy",get:function(){return this._sortedDataCopy}}]),n}(),T=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g"),e.group=e.elem.append("g"),e._data=[],e._transition=!0,e._duration=300,e._onTransitionStart=function(){},e._onTransitionEnd=function(){},e._onMouseover=function(){},e._onMousemove=function(){},e._onMouseout=function(){},e}return c(n,l),a(n,[{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"onTransitionStart",value:function(t){return arguments.length?(this._onTransitionStart="function"==typeof t?t:function(){},this):this._onTransitionStart}},{key:"onTransitionEnd",value:function(t){return arguments.length?(this._onTransitionEnd="function"==typeof t?t:function(){},this):this._onTransitionEnd}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),P=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pie"),e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._innerRadius=0,e._outerRadius=0,e._startAngle=0,e._endAngle=2*Math.PI,e._cornerRadius=0,e._padAngle=.01,e._padRadius=null,e._areaBorderColor="#fff",e._areaBorderWidth=1,e._innerRadiusRatio=.75,e._sortMethod=null,e}return c(n,T),a(n,[{key:"update",value:function(){var o=this;o._data;o.arcFunc.innerRadius(o._innerRadius).outerRadius(o._outerRadius).cornerRadius(o._cornerRadius).padAngle(o._padAngle).padRadius(o._padRadius),o.pieFunc.value(function(t){return Math.abs(t.value)}).startAngle(o._startAngle).endAngle(o._endAngle).sort(o._sortMethod);var t=o.pieFunc(o._data),e=o.group.selectAll("path").data(t,function(t){return t.data.key});return e.exit().remove(),e.merge(e.enter().append("path")).attr("d",o.arcFunc).style("stroke",o._areaBorderColor).style("stroke-width",o._areaBorderWidth).style("fill",function(t){return t.data.color}).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("d",function(n){var i=d3.interpolateNumber(o._innerRadius,o._outerRadius);return function(t){var e=i(t);return o.arcFunc.outerRadius(e),o.arcFunc(n)}}).on("start",o._onTransitionStart).on("end",o._onTransitionEnd),o}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}}]),n}(),D=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pie-chart"),e.core=e.pie=new P(e.mainGroup),e._innerRadius=0,e._cornerRadius=null,e._padAngle=0,e._startAngle=0,e._endAngle=2*Math.PI,e._labelRadiusRatio=.5,e._innerRadiusRatio=null,e._areaBorderWidth=1,e._areaBorderColor="#fff",e._labelShow=!0,e}return c(n,L),a(n,[{key:"updateCore",value:function(){var r=this,a=r.pie,t=r.widthOfNoMargin,e=.9*t,n=r.heightOfMainGroup,i=r._startAngle,o=r._endAngle,l=S(e,n,i,o),s=l.radius,u=r._innerRadius||(r._innerRadiusRatio?r._innerRadiusRatio*s:0);a.data(r.activeData).innerRadius(u).outerRadius(s).cornerRadius(r._cornerRadius).areaBorderColor(r._areaBorderColor).areaBorderWidth(r._areaBorderWidth).startAngle(i).endAngle(o).padAngle(r._padAngle).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(1!=a.data().length){var i="arc-path-"+t.data.key.replace(/\s*/g,"")+"-"+r.id,o=x((u+s)*r._labelRadiusRatio,t.startAngle+.025,t.endAngle-.025);A(n,r.defs.select("#"+i).empty()?r.defs.append("path").attr("d",o).attr("id",i):r.defs.select("#"+i).attr("d",o),t.data.name,r._fontSize,r._fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._fontColor),r._labelShow?d3.selectAll("."+r.labelTextClass).style("display","block"):d3.selectAll("."+r.labelTextClass).style("display","none")}else n.append("text").attr("class",r.labelTextClass).attr("dy","0.35em").style("text-anchor","middle").text(t.data.name).style("pointer-events","none")}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(s,1.05*s);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}});var e=[{text:""+i.data.name,color:i.data.color},{text:i.data.valueLabel+": "+i.data.value}];r.tooltip.data(e).update().show()}).onMousemove(function(){r.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*s,s);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}}),r.tooltip.hide()});var c=l.cx+(t-e)/2,h=l.cy;r.pie.translate(c,h).update()}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n.display?n.display:this._labelShow)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),n}(),j=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._padAngle=.01,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=10,e._areaBorderColor="#fff",e._areaBorderWidth=0,e._labelShow=!0,e}return c(n,D),a(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n.display?n.display:this._labelShow)}}]),n}(),G=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._padAngle=.01,e._labelRadiusRatio=.8,e._cornerRadius=10,e._areaBorderColor="#fff",e._areaBorderWidth=0,e}return c(n,D),a(n,[{key:"setSelfOption",value:function(t){var e=t.display;0!==Object.getOwnPropertyNames(e).length&&this.cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor)}}]),n}(),B=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","wave-circle"),e.group=e.elem.append("g"),e._outerDonut=e.group.append("path"),e._innerCircle=e.group.append("circle"),e._textElem=e.group.append("text"),e._clipTextElem=e.group.append("text"),e._waveClip=e.group.append("defs").append("clipPath"),e._waveClipPath=e._waveClip.append("path"),e._radius=50,e._value=60,e._clipId=i("wave-clip"),e._waveCount=3,e._waveColor="#178BCA",e._outerCircleColor=null,e._minValue=0,e._maxValue=100,e._circleThickness=.05,e._circleFillGap=.05,e._waveHeightRatio=.05,e._waveRiseTime=1e3,e._waveAnimateTime=1500,e._waveRise=!0,e._textSize=.5,e._textSuffix="%",e._textColor="#045681",e._waveTextColor="#A4DBf8",e}return c(n,l),a(n,[{key:"update",value:function(){for(var i=this,t=i._radius,e=i._radius,n=i._circleThickness*i._radius,o=i._circleFillGap*i._radius,r=i._radius-n-o,a=i._textSize*i._radius,l=2*i._radius/i._waveCount,s=i._waveCount+1,u=l*s,c=i._waveHeightRatio*i._radius,h=(1-(i.value<i._minValue?i._minValue:i.value>i._maxValue?i._maxValue:i.value)/(i._maxValue-i._minValue))*i._radius*2,d=[],_=0;_<100;_++){var f=_*(s*Math.PI*2)/100,p=Math.sin(f);d.push({x:f,y:p})}var y,v,g=d3.scaleLinear().domain([0,2*Math.PI*s]).range([0,u]),m=d3.scaleLinear().domain([-1,1]).range([0,c]),x=d3.area().x(function(t){return g(t.x)}).y0(function(t){return m(t.y)}).y1(function(t){return 2*i._radius});return i._waveClip.attr("id",i._clipId).call(E,0,h),i._waveClipPath.datum(d).attr("d",x),i._outerDonut.attr("d",d3.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(i._radius-n).outerRadius(i._radius)).style("fill",i._outerCircleColor||i._waveColor).call(E,t,e),i._innerCircle.attr("cx",t).attr("cy",e).attr("r",r).style("fill",i._waveColor).attr("clip-path","url("+w("#"+i._clipId)+")"),i._textElem.attr("x",t).attr("y",e).attr("text-anchor","middle").attr("font-size",a+"px").attr("dy","0.35em").style("fill",i._textColor).text(i.value+i._textSuffix),i._clipTextElem.attr("x",t).attr("y",e).attr("text-anchor","middle").attr("font-size",a+"px").attr("dy","0.35em").style("fill",i._waveTextColor).text(i.value+i._textSuffix).attr("clip-path","url("+w("#"+i._clipId)+")"),y=d3.transition().duration(i._waveRiseTime).ease(d3.easeLinear),v=function(){var e=this,n=d3.interpolate(i._minValue,i.value);return function(t){e.textContent=d3.format("d")(n(t))+i._textSuffix}},i._waveClip.call(E,0,2*i._radius).transition(y).call(E,0,h),i._textElem.text("0"+i._textSuffix).transition(y).tween("text",v),i._clipTextElem.text("0"+i._textSuffix).transition(y).tween("text",v),function t(){i._waveClipPath.attr("transform","translate("+(-u+2*i._radius)+",0)").transition().duration(i._waveAnimateTime).ease(d3.easeLinear).attr("transform","translate(0,0)").on("end",t)}(),i}},{key:"value",value:function(t){return arguments.length?(this.value=t,this):this.value}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"waveColor",value:function(t){return arguments.length?(this._waveColor=t,this):this._waveColor}},{key:"waveCount",value:function(t){return arguments.length?(this._waveCount=t,this):this._waveCount}}]),n}(),N=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","wave-circle-chart"),e._circleMargin=2,e._labelMargin=2,e._maxCountOfOneLine=5,e._marginLeft=20,e._marginRight=20,e}c(n,L),a(n,[{key:"updateCore",value:function(){var e=this,t=e.activeData,n=t.length,o=e.widthOfNoMargin,i=e.heightOfMainGroup,r=Math.min(e._maxCountOfOneLine,n),a=Math.ceil(n/r),l=o/r,s=i/a,u=1.2*e.fontSize()+2*e._labelMargin,c=s-u,h=(Math.min(l,c)-2*e._circleMargin)/2,d=e.mainGroup.selectAll("g.wave-circle-item").data(t,function(t){return t.name});if(d.exit().remove(),t.length){var _=d.enter().append("g").attr("class","wave-circle-item");_.append("g"),_.append("text").attr("class",e.labelTextClass);var f=_.merge(d);f.select("g").call(E,e._circleMargin+l/2-h,e._circleMargin+c/2-h).each(function(t,e){d3.select(this).selectAll("*").remove(),new B(d3.select(this)).radius(h).waveColor(t.color).value(t.value).update()}),f.select("."+this.labelTextClass).call(E,l/2,2*e._circleMargin+c/2+h+e._labelMargin).attr("dy","0.85em").style("text-anchor","middle").style("fill",e._fontColor).text(function(t){return I(t.name,l,e._fontSize,e._fontFamily)});var p=n%r,y=(Math.ceil(n/r)-1)*r;f.attr("transform",function(t,e){var n=e%r*l,i=Math.floor(e/r)*s;return p&&y<=e&&(n=o/p*(e%r+.5)-h),"translate("+n+","+i+")"})}}},{key:"removeLabelText",value:function(){}},{key:"maxCountOfOneLine",value:function(t){return arguments.length?(this._maxCountOfOneLine=t,this):this._maxCountOfOneLine}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rose-pie"),e._stroke="#fff",e._strokeWidth=1,e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._radius=0,e._cornerRadius=0,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e}return c(n,T),a(n,[{key:"update",value:function(){var t=this,e=t._data,n=t._startAngle,i=t._endAngle,o=d3.max(e,function(t){return Math.abs(t.value)}),r=t._radius,a=d3.scaleLinear().domain([0,o]).range([0,r]),l=t.arcFunc.innerRadius(0).outerRadius(function(t){return a(Math.abs(t.data.value))}).cornerRadius(t._cornerRadius),s=t.pieFunc.value(1).startAngle(n).endAngle(i).sort(t._sortMethod),u=t.group.selectAll("g.arc-group").data(s(e),function(t){return t.data.key});u.exit().remove();var c=u.enter().append("g").attr("class","arc-group");c.append("path"),u.merge(c).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).select("path").style("stroke",t._stroke).style("stroke-width",t._strokeWidth).style("fill",function(t){return t.data.color}).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attrTween("d",function(n){var i=d3.interpolateNumber(0,a(Math.abs(n.data.value)));return function(t){var e=i(t);return l.outerRadius(e),l(n)}}).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}()),V=function(t){function e(){r(this,e);var t=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._showX=!0,t._showY=!0,t._stroke="#ccc",t._strokeDasharray="2 2",t}return c(e,l),a(e,[{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}}]),e}(),Y="grid-arc-path",X="grid-line",Q=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","polar-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=5,e}return c(n,V),a(n,[{key:"update",value:function(){var n=this,o=n._startAngle,r=n._endAngle,a=n._radius,l=n.group.style("fill","none").style("stroke",n._stroke).style("stroke-dasharray",n._strokeDasharray);!function(){if(!n._showX)return l.selectAll("."+Y).remove();var i=n._donutCount,t=l.selectAll("."+Y).data(d3.range(i));t.exit().remove(),t.enter().append("path").attr("class",Y).merge(t).attr("d",function(t,e){var n=a/i*(e+1);return x(n,o,r)})}(),function(){if(!n._showY)return l.selectAll("."+X).remove();var t=n._sectorCount||1,i=(r-o)/t,e=l.selectAll("."+X).data(d3.range(t+1));e.exit().remove(),e.enter().append("line").attr("class",X).merge(e).attr("x1",0).attr("y1",0).attr("x2",function(t,e){var n=o+i*e;return Math.cos(n-Math.PI/2)*a}).attr("y2",function(t,e){var n=o+i*e;return Math.sin(n-Math.PI/2)*a})}()}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=parseFloat(t),this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}}]),n}(),q=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.grid=null,e._gridStroke="#ccc",e._gridStrokeDasharray="3 3",e._gridShowX=!0,e._gridShowY=!0,e}return c(n,L),a(n,[{key:"gridStroke",value:function(t){return arguments.length?(this._gridStroke=t,this):this._gridStroke}},{key:"gridStrokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}},{key:"gridShowX",value:function(t){return arguments.length?(this._gridShowX=t,this):this._gridShowX}},{key:"gridShowY",value:function(t){return arguments.length?(this._gridShowY=t,this):this._gridShowY}},{key:"setPublicOption",value:function(t){s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setPublicOption",this).call(this,t);var e=t.grid;this.gridStroke(e.color).gridShowX(e.showX).gridShowY(e.showY)}}]),n}(),Z=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rose-chart"),e.core=e.rose=new N(e.mainGroup),e.grid=new Q(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e}return c(n,q),a(n,[{key:"updateCore",value:function(){var c=this,h=c.rose,t=c.grid,e=c._startAngle,n=c._endAngle,i=c.widthOfNoMargin,o=c.heightOfMainGroup,d=c._fontSize,r=i-6*d,a=o-6*d,l=S(r,a,e,n),s=l.radius,u=l.cx,_=l.cy,f=s+10,p=f+d;t.donutCount(6).sectorCount(c.activeData.length).startAngle(e).endAngle(n).radius(f).stroke(c._gridStroke).strokeDasharray(c._gridStrokeDasharray).showX(c._gridShowX).showY(c._gridShowY),h.data(c.activeData).radius(s).startAngle(e).endAngle(n).cornerRadius(c._cornerRadius).stroke(c._stroke).strokeWidth(c._strokeWidth).sortMethod(c._sortMethod).transition(c._transition).duration(c._duration).onTransitionEnd(function(t,e){var n=h.arcFunc.outerRadius()(t),i=d3.select(this.parentNode),o=t.startAngle,r=t.endAngle,a="arc-path-"+t.data.key+"-"+c.id,l=x(n-d,o+.015,r-.015);A(i,c.defs.select("#"+a).empty()?c.defs.append("path").attr("d",l).attr("id",a):c.defs.select("#"+a).attr("d",l),t.data.value.toString(),d,c._fontFamily).classed(c.labelTextClass,!0).style("pointer-events","none").style("fill","#fff");var s="outer-arc-path-"+t.data.key+"-"+c.id,u=x(p,o+.015,r-.015);A(i,c.defs.select("#"+s).empty()?c.defs.append("path").attr("d",u).attr("id",s):c.defs.select("#"+s).attr("d",u),t.data.name,d,c._fontFamily).attr("class",c.labelTextClass).style("pointer-events","none").style("fill",c._fontColor)}).onMouseover(function(t,e){d3.select(this).transition().style("opacity",.8);var n=[{text:""+t.data.name,color:t.data.color},{text:t.data.valueLabel+": "+t.data.value}];c.tooltip.data(n).update().show()}).onMousemove(function(){c.tooltip.move()}).onMouseout(function(t){d3.select(this).transition().style("opacity",1),c.tooltip.hide()});var y=(i-r)/2+u,v=(o-a)/2+_,g=l.quadrant,m=(p-s)/2;switch(g){case 4:y+=m,v+=m;break;case 1:y-=m,v+=m;break;case 2:y-=m,v-=m;break;case 3:y+=m,v-=spcae}t.translate(y,v).update(),h.translate(y,v).update()}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"setSelfOption",value:function(t){var e=t.display;this.cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).stroke(e.areaBorderColor||this._stroke).strokeWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._strokeWidth))}}]),n}(),U=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._startAngle=3*Math.PI/2,e._endAngle=2*Math.PI,e}c(n,Z)}(),"icon-bar-group"),K="icon-bar-clip-path",J=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-bar"),e.defs=e.elem.append("defs"),e._width=400,e._height=400,e._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},e._backFill="#ccc",e._countOfOneRow=20,e._padding=2,e}return c(n,T),a(n,[{key:"update",value:function(){var n=this,t=n._data,e=n._width,i=n._height,o=n._icon,r=n._countOfOneRow,a=n._padding,l=t.length,s=d3.max(t,function(t){return t.value}),u=e/r,c=i/Math.max(1,l),h=Math.min((u-2*a)/o.width,(c-2*a)/o.height),d=(u-2*a)*h,_=o.height*h,f=function(t){return r<=s?r*t.value/s:t.value},p=n.defs,y="icon-"+n.id;p.select("#"+y).empty()&&p.append("path").attr("id",y).attr("d",o.path);var v=p.selectAll("."+K).data(t,function(t){return t.name});v.exit().remove();var g=v.enter().append("clipPath").attr("class",K).attr("id",function(t,e){return"icon-clip-"+e+"-"+n.id});g.append("rect"),g.merge(v).select("rect").attr("x",0).attr("y",-1).attr("width",function(t){return f(t)*u}).attr("height",c);var m=n.group.selectAll("."+U).data(t,function(t){return t.key});m.exit().remove(),m.selectAll("*").remove();var x=m.enter().append("g").attr("class",U).merge(m).attr("transform",function(t,e){return"translate(0, "+c*e+")"}).each(n._onTransitionStart).each(n._onTransitionEnd).on("mouseover",n._onMouseover).on("mousemove",n._onMousemove).on("mouseout",n._onMouseout),k=x.append("rect").attr("class","icon-bar-back-rect"),S=x.append("g").attr("class","icon-bar-back-group").call(E,0,(c-_)/2),w=x.append("g").attr("class","icon-bar-front-group").call(E,0,(c-_)/2).attr("clip-path",function(t,e){return"url(#icon-clip-"+e+"-"+n.id+")"});return k.attr("width",e).attr("height",c).style("opacity",0),S.selectAll("g").data(d3.range(r)).enter().append("g").attr("transform",function(t,e){return"translate("+(u*e+Math.max((u-d)/2,a))+",0)"}).append("path").attr("d",o.path).style("fill",n._backFill).attr("transform","scale("+h+")"),w.each(function(t,e){d3.select(this).selectAll("g").data(function(t){return d3.range(Math.ceil(f(t)))}).enter().append("g").attr("transform",function(t,e){return"translate("+(u*e+Math.max((u-d)/2,a))+",0)"}).append("path").attr("d",o.path).style("fill",t.color).style("stroke-width",1/h).attr("transform","scale("+h+")")}),n}},{key:"backFill",value:function(t){return arguments.length?(this._backFill=t,this):this._backFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}(),$=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-bar-chart"),e.core=e.iconBar=new J(e.mainGroup),e._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},e._iconBackFill="#ccc",e._countOfOneRow=10,e._iconPadding=2,e._innerPadding=5,e}c(n,L),a(n,[{key:"updateCore",value:function(){var o=this,r=o.iconBar,i=o.tooltip,t=o.activeData,e=o.widthOfNoMargin,n=o.heightOfMainGroup,a=o._fontSize,l=.25*e,s=t.length?d3.max(t,function(t){return H(t.name,a,o._fontFamily)}):0,u=Math.min(l,s);r.data(o.activeData).width(o.widthOfNoMargin-u-o._innerPadding).height(n).backFill(o._iconBackFill).countOfOneRow(o._countOfOneRow).icon(o._icon).padding(o._iconPadding),r.translate(u+o._innerPadding,0).onMouseover(function(t,e){var n=[{text:""+t.name,color:t.color},{text:t.valueLabel+": "+t.value}];i.data(n).update().show(),d3.select(this).select(".icon-bar-front-group").selectAll("path").style("stroke","#000")}).onMousemove(function(t,e){i.move()}).onMouseout(function(t,e){i.hide(),d3.select(this).select(".icon-bar-front-group").selectAll("path").style("stroke","none")}).onTransitionStart(function(t,e){var n=d3.select(this),i=o.heightOfMainGroup/r.data().length;n.append("text").attr("class",o.labelTextClass).attr("x",-o._innerPadding).attr("y",i/2).attr("dy","0.35em").style("text-anchor","end").style("fill",o._fontColor).text(I(t.name,u,a,o._fontFamily))}),r.update()}},{key:"iconBackFill",value:function(t){return arguments.length?(this._iconBackFill=t,this):this._iconBackFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"iconPadding",value:function(t){return arguments.length?(this._iconPadding=t,this):this._iconPadding}}])}(),"radial-bar-group"),tt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-bar"),e.arcFunc=d3.arc(),e._innerRadius=0,e._outerRadius=100,e._lineRatio=.7,e._startAngle=0,e._endAngle=2*Math.PI*.75,e._cornerRadius=0,e._showMark=!1,e._markRadius=5,e._minLineWidth=2,e}return c(n,T),a(n,[{key:"update",value:function(){var t=this,e=t._data,n=t._outerRadius,i=t._innerRadius,o=t._startAngle,r=t._endAngle,a=t._lineRatio,l=t.group,s=t.arcFunc,u=e.length,c=d3.max(e,function(t){return Math.abs(t.value)}),h=(n-i)/u,d=Math.max(h*a,t._minLineWidth),_=function(t,e){return i+h*(e+1)-d/2},f=d3.scaleLinear().domain([0,c]).range([o,r]),p=function(t){return f(Math.abs(t))};s.innerRadius(function(t,e){return _(0,e)-d/2}).outerRadius(function(t,e){return _(0,e)+d/2}).startAngle(o).endAngle(function(t){return p(t.value)}).cornerRadius(t._cornerRadius);var y=l.selectAll("."+$).data(e,function(t){return t.key});y.exit().remove();var v=y.enter().append("g").attr("class",$);v.append("path").attr("class","arc-path"),t._showMark&&v.append("circle").attr("class","mark-circle");var g=v.merge(y).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._showMark?g.select("circle").attr("cx",function(t,e){return _(0,e)*Math.cos(p(t.value)-Math.PI/2)}).attr("cy",function(t,e){return _(0,e)*Math.sin(p(t.value)-Math.PI/2)}).attr("r",t._markRadius).style("fill",function(t){return t.color}).style("opacity",1):g.select("circle").style("opacity",0),g.select("path").style("fill",function(t){return t.color}).attr("d",function(t,e){return s({value:0},e)}).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attrTween("d",function(e,n){var i=d3.interpolate(o,p(e.value));return function(t){return s.endAngle(i(t)),s(e,n)}}).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"lineRatio",value:function(t){return arguments.length?(this._lineRatio=t,this):this._lineRatio}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"showMark",value:function(t){return arguments.length?(this._showMark=t,this):this._showMark}},{key:"markRadius",value:function(t){return arguments.length?(this._markRadius=t,this):this._markRadius}},{key:"minLineWidth",value:function(t){return arguments.length?(this._minLineWidth=t,this):this._minLineWidth}}]),n}(),et=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-bar-chart"),e.core=e.radialBar=new tt(e.mainGroup),e._innerRadiusRatio=.1,e._startAngle=0,e._endAngle=2*Math.PI*.75,e._showMark=!1,e._markRadius=10,e._sortValue=1,e._minLineWidth=2,e._lineRatio=.7,e._cornerRadius=0,e}return c(n,L),a(n,[{key:"updateCore",value:function(){var t=this,i=t.tooltip,e=t.radialBar,n=t.widthOfNoMargin,o=t.heightOfMainGroup,r=Math.min(n,o)/2,a=r*t._innerRadiusRatio;e.data(t.activeData).innerRadius(a).outerRadius(r).startAngle(t._startAngle).endAngle(t._endAngle).lineRatio(t._lineRatio).cornerRadius(t._cornerRadius).showMark(t._showMark).markRadius(t._markRadius).minLineWidth(t._minLineWidth).transition(t._transition).duration(t._duration).onMouseover(function(t,e){d3.select(this).style("opacity",.8);var n=[{text:""+t.name,color:t.color},{text:t.valueLabel+": "+t.value}];i.data(n).update().show()}).onMousemove(function(){i.move()}).onMouseout(function(){d3.select(this).style("opacity",1),i.hide()}).onTransitionStart(t._onTransitionStart()).onTransitionEnd(t._onTransitionEnd()),e.translate(n/2,o/2).update()}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"lineRatio",value:function(t){return arguments.length?(this._lineRatio=t,this):this._lineRatio}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"showMark",value:function(t){return arguments.length?(this._showMark=t,this):this._showMark}},{key:"markRadius",value:function(t){return arguments.length?(this._markRadius=t,this):this._markRadius}},{key:"minLineWidth",value:function(t){return arguments.length?(this._minLineWidth=t,this):this._minLineWidth}},{key:"_onTransitionStart",value:function(){var r=this;return function(t,e){var n=d3.select(this.parentNode),i=r.radialBar.arcFunc,o=(i.innerRadius()(t,e)+i.outerRadius()(t,e))/2;n.append("text").attr("class",r.labelTextClass).attr("x","-5px").attr("y",-o).attr("dy","0.35em").style("text-anchor","end").style("fill",r._fontColor).text(t.name)}}},{key:"_onTransitionEnd",value:function(){var c=this;return function(t,e){var n=d3.select(this.parentNode),i=c.radialBar.arcFunc,o=(i.innerRadius()(t,e)+i.outerRadius()(t,e))/2,r=i.startAngle()(t,e),a=i.endAngle()(t,e),l=a>Math.PI/2&&a<=3*Math.PI/2,s="arc-path-"+t.key+"-"+c.id,u=x(o,r,a-.05,!l);A(n,c.defs.select("#"+s).empty()?c.defs.append("path").attr("d",u).attr("id",s):c.defs.select("#"+s).attr("d",u),t.value,c._fontSize,c._fontFamily,l?"0%":"100%").attr("class",c.labelTextClass).style("text-anchor",l?"start":"end").style("pointer-events","none").style("fill","#fff")}}},{key:"setSelfOption",value:function(t){var e=t.display;0!==Object.getOwnPropertyNames(e).length&&this.lineRatio(o(e.barWidthPercent?e.barWidthPercent:this._lineRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius))}}]),n}(),nt=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-line-chart"),e._lineRatio=0,e._innerRadiusRatio=.2,e._showMark=!0,e._markRadius=10,e._minLineWidth=1,e}c(n,et),a(n,[{key:"_onTransitionEnd",value:function(){}},{key:"setSelfOption",value:function(t){var e=t.display;0!==Object.getOwnPropertyNames(e).length&&this.markRadius(o(e.endPointRadius?e.endPointRadius:this._markRadius)).minLineWidth(o(e.lineWidth?e.lineWidth:this._minLineWidth)).lineRatio(0)}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","axis"),e.group=e.elem.append("g"),e.axisFunc=null,e._orient="bottom",e._type="category",e._scaleFunc=null,e._tickSize=6,e._tickPadding=3,e._tickCount=null,e._tickFormat=null,e._minTickDistance=null,e._axisLineShow=!0,e._tickShow=!0,e._title="",e._titleShow=!0,e._titlePadding=5,e._fontSize=12,e._fontColor="#000",e._fontFamily="sans-serif",e._lineStroke="#000",e._transition=!0,e._duration=500,e._tickValues=[],e._tickValueTexts=[],e}return c(n,l),a(n,[{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"scaleFunc",value:function(t){return arguments.length?(this._scaleFunc=t,this):this._scaleFunc}},{key:"tickSize",value:function(t){return arguments.length?(this._tickSize=t,this):this._tickSize}},{key:"tickPadding",value:function(t){return arguments.length?(this._tickPadding=t,this):this._tickPadding}},{key:"tickFormat",value:function(t){return arguments.length?(this._tickFormat=t,this):this._tickFormat}},{key:"tickCount",value:function(t){return arguments.length?(this._tickCount=t,this):this._tickValues.length||this._tickCount}},{key:"minTickDistance",value:function(t){return arguments.length?(this._minTickDistance=t,this):this._minTickDistance}},{key:"tickLineShow",value:function(t){return arguments.length?(this._tickLineShow=t,this):this._tickLineShow}},{key:"axisLineShow",value:function(t){return arguments.length?(this._axisLineShow=t,this):this._axisLineShow}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}},{key:"titlePadding",value:function(t){return arguments.length?(this._titlePadding=t,this):this._titlePadding}},{key:"titleShow",value:function(t){return arguments.length?(this._titleShow=t,this):this._titleShow}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"lineStroke",value:function(t){return arguments.length?(this._lineStroke=t,this):this._lineStroke}},{key:"tickLabelShow",value:function(t){return arguments.length?(this._tickLabelShow=t,this):this._tickLabelShow}},{key:"tickShow",value:function(t){return arguments.length?(this._tickShow=t,this):this._tickShow}},{key:"titleHeight",get:function(){return this._title&&this._titleShow?1.25*this._fontSize+this._titlePadding:0}},{key:"tickLocations",get:function(){var e=this;return this._tickValues.map(function(t){return e._scaleFunc(t)})}}]),n}()),it="axis-group",ot="x-title",rt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis x"),e._orient="bottom",e._type="category",e._allowedMaxTextHeight=30,e._tickTextRotate=0,e._tickTextHeight=0,e}return c(n,nt),a(n,[{key:"update",value:function(){var n=this,i=n._orient,t=n._scaleFunc,e=n.group,o=n._fontSize,r=n._tickTextRotate,a=n._tickValueTexts,l=void 0;(l=n.axisFunc="top"===i?d3.axisTop(t):d3.axisBottom(t)).tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding);var s=e.select("."+it).empty()?e.append("g").attr("class",it):e.select("."+it);s.style("font-size",o+"px").style("font-family",n._fontFamily).transition().duration(n._transition?n._duration:0).call(l).on("start",function(t,e){s.selectAll(".tick text").style("fill",n._fontColor).attr("dx",0).attr("dy","0.71em").attr("transform","rotate(0)").style("text-anchor","middle").text(function(t,e){return a[e]}).filter(function(){return r}).attr("dx","-0.5em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"top"!==i}).attr("dy","0.5em"),s.selectAll(".tick line").style("stroke",n._lineStroke),s.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")});var u=Math.abs(t.range()[0]-t.range()[1]);if(n._titleShow&&n._title){var c=e.select("."+ot).empty()?e.append("g").attr("class",ot):e.select("."+ot),h=c.select("text").empty()?c.append("text"):c.select("text");c.call(E,u/2,n.height),h.attr("dy","0.5em").attr("text-anchor","middle").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dy","-0.5em").text(n._title)}else e.select("."+ot).remove()}},{key:"compute",value:function(){var e=this,n=[],i=[],o=0,r=0;function a(){e._tickTextRotate=o,e._tickValues=n,e._tickValueTexts=i,e._tickTextHeight=r}var t=e._scaleFunc,l=e._type,s=e._fontSize,u=e._minTickDistance||60,c=e._allowedMaxTextHeight,h=Math.abs(t.range()[0]-t.range()[1]),d=void 0,_=void 0;if(n="category"===l?t.domain():t.ticks(),y())return e;if("category"===l&&d<u){var f=Math.ceil(u/d);if(n=n.filter(function(t,e){return e%f==0}),y())return e}o="top"===e._orient?45:-45;var p=Math.abs(Math.sin(Math.PI/4));return _*p<c?(r=_*p,i=n):(r=c,i=n.map(function(t){return I(t,r/p,s,e._fontFamily)})),a(),e;function y(){var t=!1;return d=h/n.length,(_=d3.max(n,function(t){return H(t,s,e._fontFamily)}))<d&&(o=0,i=n,r=1.125*s,a(),t=!0),t}}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"height",get:function(){var t=0;return this.isShow&&(t=(this._tickShow?this._tickSize+this._tickPadding+1.5*this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.25*this._fontSize:0)),t}}]),n}(),at="axis-group",lt="y-title",st=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis y"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return c(n,nt),a(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,r=t._tickValueTexts,a=void 0;a=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),a.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+at).empty()?i.append("g").attr("class",at):i.select("."+at);if(s.transition().duration(t._transition?t._duration:0).call(a).on("start",function(){s.selectAll(".tick text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return r[e]}),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")}),t._titleShow&&t._title){var u=i.select("."+lt).empty()?i.append("g").attr("class",lt):i.select("."+lt),c=u.select("text").empty()?u.append("text"):u.select("text"),h=H(t._title,o,t._fontFamily);c.attr("x",h>=2*t.width?2-t.width:0).attr("y",-this._fontSize).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",h>=2*t.width?"start":"middle").text(t._title)}else i.select("."+lt).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,r=e._type,a=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===r?o.domain():o.ticks(e._tickCount);var s=d3.max(t,function(t){return H(t,a,e._fontFamily)});return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,a,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),ut=function(t){function o(t){r(this,o);var e=h(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.xAxis=null,e.yAxis=null,e.yAxisDoubleY=null,e.xScale=null,e.yScale=null,e._marginLeft=35,e._marginRight=40,e._marginTop=19,e._gapPadding=20,e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._xDomain=null,e._yDomain=null,e._clipShow=null,e._xTitle="",e._yTitle="",e._axisLineStroke=null,e._xTickShow=!0,e._yTickShow=!0,e}return c(o,q),a(o,[{key:"update",value:function(){return this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this.updateTitle(),this.updateAxis(),this.updateCore(),this.updateScale(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,r=t._xType,a=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),o.domain(t._yDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(r).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(a).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var d=n.titleHeight,_=(h-e.allowedMaxTextHeight())/(3*u);n.tickCount(_),n.compute(),i.range([0,c-n.width]),e.compute(),o.nice().range([h-d-e.height,0]);var f=n.width,p=h-e.height,y=n.width,v=d;e.translate(f,p).update(),n.translate(y,v).update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"updateScale",value:function(){}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain||[]).slice().sort(d3.ascending),n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=void 0;if(t.length){var o=d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),r=1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})});i=o<0?r<=0?[o,0]:[o,r]:[0,r]}else i=[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"clipShow",value:function(t){return arguments.length?(this._clipShow=t,this):this._clipShow}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"yLeftName",value:function(t){return arguments.length?(this._yLeftName=t,this):this._yLeftName}},{key:"yLeftTitle",value:function(t){return arguments.length?(this._yLeftTitle=t,this):this._yLeftTitle}},{key:"yRightName",value:function(t){return arguments.length?(this._yRightName=t,this):this._yRightName}},{key:"yRightTitle",value:function(t){return arguments.length?(this._yRightTitle=t,this):this._yRightTitle}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{};this.axisLineStroke(e.color).xTitle(n.name).yTitle(i.name).xTickShow(n.labelShow).yTickShow(i.labelShow).xDomain(n.range).yDomain(i.range).clipShow(i.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return 0<e?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.yAxis?this.yAxis.titleHeight:0,n=this.heightOfMainGroup-t-e;return 0<n?n:0}}]),o}(),ct=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("line").attr("class","guide-line"),e._x1=0,e._y1=0,e._x2=0,e._y2=100,e._stroke="#000",e._strokeDasharray="3 3",e}return c(n,l),a(n,[{key:"update",value:function(){var t=this;return t.elem.attr("x1",t._x1).attr("y1",t._y1).attr("x2",t._x2).attr("y2",t._y2).style("stroke",t._stroke).style("stroke-dasharray",t._strokeDasharray).style("pointer-events","none"),t}},{key:"x1",value:function(t){return arguments.length?(this._x1=t,this):this._x1}},{key:"y1",value:function(t){return arguments.length?(this._y1=t,this):this._y1}},{key:"x2",value:function(t){return arguments.length?(this._x2=t,this):this._x2}},{key:"y2",value:function(t){return arguments.length?(this._y2=t,this):this._y2}},{key:"x",value:function(t){return arguments.length?(this._x1=this._x2=t,this):[this._x1,this._x2]}},{key:"y",value:function(t){return arguments.length?(this._y1=this._y2=t,this):[this._y1,this._y2]}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}}]),n}(),ht=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","scatter-plot"),e._xScale=null,e._yScale=null,e._radius=function(){return 3},e._fill=null,e._stroke=null,e._strokeWidth=1,e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){var n=this,t=n.group,e=n._data,i=n._xScale,o=n._yScale,r=t.selectAll("g").data(e,function(t){return t.name});return r.exit().remove(),r.enter().append("g").merge(r).each(function(t){var e=d3.select(this).selectAll("circle").data(t.data);e.exit().remove(),e.enter().append("circle").attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.value)||0}).merge(e).style("fill",n._fill||t.color).style("stroke",n._stroke||t.color).style("stroke-width",n._strokeWidth).attr("r",n._radius).attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.value)||0})}),n}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),dt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","area-plot"),e._xScale=null,e._yScale=null,e._areaFunc=null,e._curve=d3.curveLinear,e._fillOpacity=.7,e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._areaFunc||d3.area().x(function(t){return e._xScale(t.name)}).y0(e._yScale.range()[0]).y1(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill",function(t){return t.color}).style("fill-opacity",e._fillOpacity).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}}]),n}(),_t=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","line-plot"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._strokeWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._lineFunc||d3.line().x(function(t){return e._xScale(t.name)}).y(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill","none").style("stroke",function(t){return e._stroke||t.color||"#000"}).style("stroke-width",e._strokeWidth).style("stroke-dasharray",e._strokeDasharry).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),ft=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("clipPath").attr("id",e.id),e.rect=e.elem.append("rect"),e._width=100,e._height=100,e._transition=!0,e._duration=500,e._paddingVertical=[5,0],e._paddingHorizontal=[20,20],e}return c(n,l),a(n,[{key:"update",value:function(){var t=this,e=t.rect,n=t._width,i=t._paddingVertical,o=t._paddingHorizontal;return e.attr("x",-n-o[0]).attr("y",-i[0]).attr("width",n+o[0]+o[1]).attr("height",t._height+i[0]+i[1]),e.transition().duration(t._transition?t._duration:0).attr("x",-o[0]),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"paddingVertical",value:function(t){return arguments.length?(this._paddingVertical=t,this):this._paddingVertical}},{key:"paddingHorizontal",value:function(t){return arguments.length?(this._paddingHorizontal=t,this):this._paddingHorizontal}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),n}(),pt="grid-x-line",yt="grid-y-line",vt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","plane-grid"),e.group=e.elem.append("g"),e._width=400,e._height=400,e._xTickLocations=[],e._yTickLocations=[],e}return c(n,V),a(n,[{key:"update",value:function(){var e=this,n=e._width,i=e._height,o=e.group.style("fill","none").style("stroke",e._stroke).style("stroke-dasharray",e._strokeDasharray).style("pointer-events","none");!function(){if(!e._showX)return o.selectAll("."+pt).remove();var t=o.selectAll("."+pt).data(e._yTickLocations);t.exit().remove(),t.enter().append("line").attr("class",pt).merge(t).attr("x1",0).attr("y1",function(t){return t+.5}).attr("x2",n).attr("y2",function(t){return t+.5})}(),function(){if(!e._showY)return o.selectAll("."+yt).remove();var t=o.selectAll("."+yt).data(e._xTickLocations);t.exit().remove(),t.enter().append("line").attr("class",yt).merge(t).attr("y1",0).attr("x1",function(t){return t}).attr("y2",i).attr("x2",function(t){return t})}()}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"xTickLocations",value:function(t){return arguments.length?(this._xTickLocations=t,this):this._xTickLocations}},{key:"yTickLocations",value:function(t){return arguments.length?(this._yTickLocations=t,this):this._yTickLocations}}]),n}(),gt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem=t.append("g").attr("class","bands-overlay").style("opacity",0),e._data=[],e._bandHeight=100,e._bandWidth=50,e._isScalePoint=!0,e._onMouseover=function(){},e._onMousemove=function(){},e._onMouseout=function(){},e}return c(n,l),a(n,[{key:"update",value:function(){var t=this,e=t._data,n=t.elem,i=t._bandWidth,o=t._bandHeight,r=t._isScalePoint?i/2:0,a=n.selectAll("rect").data(e);return a.exit().remove(),a.enter().append("rect").merge(a).attr("x",function(t,e){return i*e-r}).attr("y",0).attr("width",i).attr("height",o).style("fill","#000").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"bandWidth",value:function(t){return arguments.length?(this._bandWidth=t,this):this._bandWidth}},{key:"bandHeight",value:function(t){return arguments.length?(this._bandHeight=t,this):this._bandHeight}},{key:"isScalePoint",value:function(t){return arguments.length?(this._isScalePoint=t,this):this._isScalePoint}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),mt=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.areaPlot=new dt(e.coreGroup),e.linePlot=new _t(e.coreGroup),e.grid=new vt(e.coreGroup),e.overlay=new gt(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.guideScatter=new ht(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yLabel="",e._xLabel="",e._sortValue=-1,e._curve=d3.curveCardinal,e}c(n,ut),a(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=t.grid,i=t.areaPlot,o=t.linePlot,a=t.guideScatter,l=t.tooltip,r=t.overlay,s=t.guideLine,u=t.clipArea,c=t.xScale,h=t.yScale,d=t.widthOfCore,_=t.heightOfCore;e.width(d).height(_).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(c).yScale(h).curve(t._curve),o.data(n).xScale(c).yScale(h).curve(t._curve),a.data(n).xScale(c).yScale(h).fill("#fff"),s.y1(0).y2(_).strokeDasharray(t._gridStrokeDasharray),r.data(c.domain()).bandWidth(c.step()).bandHeight(_).onMouseover(function(t,e){var i=t,o=[{text:i}],r=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});r.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:t.name+": "+n[0].value,color:t.color})}),l.data(o).update(),s.x(c(i)).update(),a.data(r).update(),l.show(),s.show(),a.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),s.hide(),a.hide()}),u.width(d).height(_).transition(t._transition).duration(t._duration),t.coreGroup.call(E,t.yAxis.width+.5,t.yAxis.titleHeight).attr("clip-path","url(#"+u.id+")"),a.elem.style("pointer-events","none"),e.update(),r.update(),u.update(),i.update(),o.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","ranking-line-plot"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._strokeWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){var n=this,t=n._data,e=n._lineFunc||d3.line().x(function(t){return n._xScale(t.name)}).y(function(t){return n._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});e.curve(n._curve);var i=n.group,o=i.selectAll("path").data(t,function(t){return t.key});o.exit().remove(),o.enter().append("path").merge(o).style("fill","none").style("stroke",function(t){return n._stroke||t.color||"#000"}).style("stroke-width",n._lineWidth).style("stroke-dasharray",n._strokeDasharry).transition().duration(n._transition?n._duration:0).attr("d",function(t){return e(t.data)});var r=n._xScale,a=n._yScale,l=i.selectAll("g").data(t,function(t){return t.name});return l.exit().remove(),l.enter().append("g").attr("class","ranking-text-group").merge(l).each(function(t){var e=d3.select(this).selectAll("text").data(t.data);e.exit().remove(),e.enter().append("text").attr("x",function(t){return r(t.name)||0}).attr("y",function(t){return t.total?a(t.total)||0:a(t.value)||0}).merge(e).text(function(t){return t.value}).style("fill",n._fill||t.color).attr("x",function(t){return r(t.name)||0}).attr("y",function(t){return t.total?a(t.total)||0:a(t.value)||0}).attr("text-anchor","middle").style("display",n._labelShow?"block":"none")}),null==n._labelShow||null==n._positionOptions||null==n._positionChoice?i.selectAll(".ranking-text-group text").style("display","none"):0==n._positionOptions.indexOf(n._positionChoice)?i.selectAll(".ranking-text-group text").attr("dy",.4*-n._fontSize):1==n._positionOptions.indexOf(n._positionChoice)&&i.selectAll(".ranking-text-group text").attr("dy",1.3*n._fontSize),n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}()),xt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.linePlot=new mt(e.coreGroup),e.scatterPlot=new ht(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.grid=new vt(e.coreGroup),e.overlay=new gt(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.guideScatter=new ht(e.coreGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._showPoints=!0,e._curve=d3.curveCardinal,e._strokeWidth=2,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=t.grid,i=t.linePlot,o=t.scatterPlot,r=t.clipArea,a=t.tooltip,l=t.overlay,s=t.guideLine,u=t.guideScatter,c=t.xScale,h=t.yScale,d=t.widthOfCore,_=t.heightOfCore;e.width(d).height(_).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(c).yScale(h).fontSize(t._fontSize).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).curve(t._curve).strokeWidth(t._strokeWidth),o.data(n).xScale(c).yScale(h).stroke("#fff").strokeWidth(2),s.y1(0).y2(_).strokeDasharray(t._gridStrokeDasharray),u.xScale(c).yScale(h).fill("#fff"),l.data(c.domain()).bandWidth(c.step()).bandHeight(_).onMouseover(function(t,e){var i=t,o=[{text:i}],r=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});r.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:t.name+": "+n[0].value,color:t.color})}),a.data(o).update().show(),s.x(c(i)).update().show(),u.data(r).update().show()}).onMousemove(function(){a.move()}).onMouseout(function(){a.hide(),s.hide(),u.hide()}),r.width(d).height(_).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.call(E,t.yAxis.width+.5,t.yAxis.titleHeight),0!=t._clipShow.length&&(t.coreGroup.attr("clip-path","url(#"+r.id+")"),r.update()),u.elem.style("pointer-events","none"),l.update(),e.update(),i.update(),t._showPoints?o.update().show():o.hide()}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n.display?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};this.strokeWidth(o(e.lineWidth)).curve(i[e.lineType]||d3.curveLinear)}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),kt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","step-line-chart"),e._showPoints=!1,e._curve=d3.curveStepAfter,e._strokeWidth=2,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,xt),a(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&this.strokeWidth(o(e.lineWidth?e.lineWidth:this._strokeWidth)).curve(i[e.lineType]||this._curve)}}]),n}();function St(t,e){return t.sourceLinks.length?t.depth:e-1}function wt(t){return function(){return t}}function bt(t,e){return Ct(t.source,e.source)||t.index-e.index}function Ot(t,e){return Ct(t.target,e.target)||t.index-e.index}function Ct(t,e){return t.y0-e.y0}function At(t){return t.value}function Mt(t){return(t.y0+t.y1)/2}function Ft(t){return Mt(t.source)*t.value}function Rt(t){return Mt(t.target)*t.value}function Wt(t){return t.index}function zt(t){return t.nodes}function Lt(t){return t.links}function Tt(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function Pt(){var r=0,s=0,a=1,u=1,l=24,c=8,e=Wt,h=St,n=zt,i=Lt,d=32;function o(){var t={nodes:n.apply(null,arguments),links:i.apply(null,arguments)};return function(t){t.nodes.forEach(function(t,e){t.index=e,t.sourceLinks=[],t.targetLinks=[]});var o=d3.map(t.nodes,e);t.links.forEach(function(t,e){t.index=e;var n=t.source,i=t.target;"object"!==(void 0===n?"undefined":b(n))&&(n=t.source=Tt(o,n)),"object"!==(void 0===i?"undefined":b(i))&&(i=t.target=Tt(o,i)),n.sourceLinks.push(t),i.targetLinks.push(t)})}(t),t.nodes.forEach(function(t){t.value=Math.max(d3.sum(t.sourceLinks,At),d3.sum(t.targetLinks,At))}),function(t){var e,n,i;for(e=t.nodes,n=[],i=0;e.length;++i,e=n,n=[])e.forEach(function(t){t.depth=i,t.sourceLinks.forEach(function(t){n.indexOf(t.target)<0&&n.push(t.target)})});for(e=t.nodes,n=[],i=0;e.length;++i,e=n,n=[])e.forEach(function(t){t.height=i,t.targetLinks.forEach(function(t){n.indexOf(t.source)<0&&n.push(t.source)})});var o=(a-r-l)/(i-1);t.nodes.forEach(function(t){t.x1=(t.x0=r+Math.max(0,Math.min(i-1,Math.floor(h.call(null,t,i))))*o)+l})}(t),function(t){var e=d3.nest().key(function(t){return t.x0}).sortKeys(d3.ascending).entries(t.nodes).map(function(t){return t.values});n=d3.min(e,function(t){return(u-s-(t.length-1)*c)/d3.sum(t,At)}),e.forEach(function(t){t.forEach(function(t,e){t.y1=(t.y0=e)+t.value*n})}),t.links.forEach(function(t){t.width=t.value*n}),l();var n;for(var i=1,o=d;0<o;--o)a(i*=.99),l(),r(i),l();function r(n){e.forEach(function(t){t.forEach(function(t){if(t.targetLinks.length){var e=(d3.sum(t.targetLinks,Ft)/d3.sum(t.targetLinks,At)-Mt(t))*n;t.y0+=e,t.y1+=e}})})}function a(n){e.slice().reverse().forEach(function(t){t.forEach(function(t){if(t.sourceLinks.length){var e=(d3.sum(t.sourceLinks,Rt)/d3.sum(t.sourceLinks,At)-Mt(t))*n;t.y0+=e,t.y1+=e}})})}function l(){e.forEach(function(t){var e,n,i,o=s,r=t.length;for(t.sort(Ct),i=0;i<r;++i)e=t[i],0<(n=o-e.y0)&&(e.y0+=n,e.y1+=n),o=e.y1+c;if(0<(n=o-c-u))for(o=e.y0-=n,e.y1-=n,i=r-2;0<=i;--i)e=t[i],0<(n=e.y1+c-o)&&(e.y0-=n,e.y1-=n),o=e.y0})}}(t),_(t),t}function _(t){t.nodes.forEach(function(t){t.sourceLinks.sort(Ot),t.targetLinks.sort(bt)}),t.nodes.forEach(function(t){var e=t.y0,n=e;t.sourceLinks.forEach(function(t){t.y0=e+t.width/2,e+=t.width}),t.targetLinks.forEach(function(t){t.y1=n+t.width/2,n+=t.width})})}return o.update=function(t){return _(t),t},o.nodeId=function(t){return arguments.length?(e="function"==typeof t?t:wt(t),o):e},o.nodeAlign=function(t){return arguments.length?(h="function"==typeof t?t:wt(t),o):h},o.nodeWidth=function(t){return arguments.length?(l=+t,o):l},o.nodePadding=function(t){return arguments.length?(c=+t,o):c},o.nodes=function(t){return arguments.length?(n="function"==typeof t?t:wt(t),o):n},o.links=function(t){return arguments.length?(i="function"==typeof t?t:wt(t),o):i},o.size=function(t){return arguments.length?(r=s=0,a=+t[0],u=+t[1],o):[a-r,u-s]},o.extent=function(t){return arguments.length?(r=+t[0][0],a=+t[1][0],s=+t[0][1],u=+t[1][1],o):[[r,s],[a,u]]},o.iterations=function(t){return arguments.length?(d=+t,o):d},o}function Dt(t){return[t.source.x1,t.y0]}function jt(t){return[t.target.x0,t.y1]}function Gt(){return d3.linkHorizontal().source(Dt).target(jt)}function Bt(){return d3.linkVertical().source(function(t){return[t.y0,t.source.x1]}).target(function(t){return[t.y1,t.target.x0]})}var Nt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sankey-plot"),e.sankeyFunc=Pt(),e._width=400,e._height=400,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._strokeOpacity=.3,e._sortByIndex=!0,e._onMouseoverLink=function(){},e._onMousemoveLink=function(){},e._onMouseoutLink=function(){},e._eventOnDrag=function(){},e}return c(n,T),a(n,[{key:"update",value:function(){var i=this,e=i._width,o=i._height,t=i._data,r=i.sankeyFunc,n=i.group;r.nodeId(function(t){return t.key}).size([e,o]);var a,l=r.nodePadding(),s=r(t),u=s.nodes.filter(function(t){return t.sourceLinks.length||t.targetLinks.length});i._sortByIndex&&(a=d3.max(u,function(t){return t.depth})+1,d3.range(a).forEach(function(e){var t=u.filter(function(t){return t.depth===e}).sort(function(t,e){return t.index-e.index}),n=d3.min(t,function(t){return t.y0});t.forEach(function(t){var e=t.y1-t.y0;t.y0=n,t.y1=n+e,n+=e+l})}),r.update(s));var c=(n.select(".links-group").empty()?n.append("g").attr("class","links-group").style("fill","none"):n.select(".links-group")).selectAll(".link").data(s.links);c.exit().remove();var h=c.enter().append("path").attr("class","link").merge(c).attr("d",Gt()).style("stroke",function(t){return t.source.color}).style("stroke-width",function(t){return Math.max(1,t.width)}).style("stroke-opacity",i._strokeOpacity).on("mouseover",i._onMouseoverLink).on("mousemove",i._onMousemoveLink).on("mouseout",i._onMouseoutLink),d=(n.select(".nodes-group").empty()?n.append("g").attr("class","nodes-group"):n.select(".nodes-group")).selectAll(".node-group").data(u);d.exit().remove();var _=d.enter().append("g").attr("class","node-group");_.append("rect"),_.append("text");var f=_.merge(d).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout);f.select("rect").attr("x",function(t){return t.x0}).attr("y",function(t){return t.y0}).attr("width",function(t){return Math.max(0,t.x1-t.x0)}).attr("height",function(t){return Math.max(0,t.y1-t.y0)}).style("fill",function(t){return t.color}).style("stroke","#333"),f.select("text").attr("x",function(t){return t.x1<=e/2?t.x1+6:t.x0-6}).attr("y",function(t){return(t.y0+t.y1)/2}).attr("dy","0.35em").style("text-anchor",function(t){return t.x1<=e/2?"start":"end"}).style("font-size",i._fontSize+"px").style("font-family",i._fontFamily).style("fill",i._fontColor).text(function(t){return t.y1-t.y0+l<i._fontSize?"":t.name});var p=d3.drag().on("start",function(){d3.select(this).raise()}).on("drag",function(t){var e=d3.event.dy,n=t.y1-t.y0;t.y0=Math.max(0,Math.min(t.y0+e,o-n)),t.y1=t.y0+n,d3.select(this).select("rect").attr("y",t.y0),d3.select(this).select("text").attr("y",function(t){return(t.y0+t.y1)/2}),r.update(s),h.attr("d",Gt()),i._eventOnDrag()});return f.style("cursor","move").call(p),i}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"strokeOpacity",value:function(t){return arguments.length?(this._strokeOpacity=t,this):this._strokeOpacity}},{key:"onMouseoverLink",value:function(t){return arguments.length?(this._onMouseoverLink="function"==typeof t?t:function(){},this):this._onMouseoverLink}},{key:"onMousemoveLink",value:function(t){return arguments.length?(this._onMousemoveLink="function"==typeof t?t:function(){},this):this._onMousemoveLink}},{key:"onMouseoutLink",value:function(t){return arguments.length?(this._onMouseoutLink="function"==typeof t?t:function(){},this):this._onMouseoutLink}},{key:"eventOnDrag",value:function(t){return arguments.length?(this._eventOnDrag="function"==typeof t?t:function(){},this):this._eventOnDrag}},{key:"sortByIndex",value:function(t){return arguments.length?(this._sortByIndex=t,this):this._sortByIndex}}]),n}();function Et(t,e){var a=0,l=1,s=2;if(e.forEach(function(t){"objCol"===t.function?a=t.index:"targetCol"===t.function?l=t.index:"vCol"===t.function&&(s=t.index)}),m(t,[a,l,s])||!O(t,s))return{names:[],nodes:[],links:[],valueLabel:""};var u=[],c=[],h=[],d={},_={};return t.slice(1).forEach(function(t){var e=t[a],n=t[l],i=+t[s],o=e+"-s",r=n+"-t";_[e]||(h.push(e),_[e]=!0),_[n]||(h.push(n),_[n]=!0),d[o]||(u.push({name:e,key:o}),d[o]=!0),d[r]||(u.push({name:n,key:r}),d[r]=!0),i&&c.push({source:o,target:r,value:i})}),{names:h,nodes:u,links:c,valueLabel:t[0][s]}}function Ht(c,t){var h=0,d=1,_=2;if(t.forEach(function(t){"objCol"===t.function?h=t.index:"targetCol"===t.function?d=t.index:"vCol"===t.function&&(_=t.index)}),m(c,[h,d,_])||h===d||!O(c,_))return{names:[],nodes:[],links:[],valueLabel:""};for(var f=[],p=[],y=[],v={},e=function(t,e){var n=c[t],i=n[h],o=n[d],r=+n[_],a=i,l=o;if(!a||!l||!r||function(t,e,n){if(e===n)return!0;if(t[e]&&0<=t[e].ancestors.indexOf(t[n]))return!0;return!1}(v,a,l))return"continue";v[a]||(f.push({name:i,key:a}),y.push(i),v[a]={ancestors:[],decendents:[]}),v[l]||(f.push({name:o,key:l}),y.push(o),v[l]={ancestors:[],decendents:[]});var s=v[a],u=v[l];[s].concat(g(s.ancestors)).forEach(function(t){var e;(e=t.decendents).push.apply(e,[u].concat(g(u.decendents)))}),[u].concat(g(u.decendents)).forEach(function(t){var e;(e=t.ancestors).push.apply(e,[s].concat(g(s.ancestors)))}),p.push({source:a,target:l,value:r})},n=1,i=c.length;n<i;n++)e(n);return{names:y,nodes:f,links:p,valueLabel:c[0][_]}}var It=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=this.generateColorList(t.names.length),n=d3.scaleOrdinal().domain(t.names).range(e);return t.nodes.forEach(function(t){return t.color=n(t.name)}),t.legendData=t.names.map(function(t){return{name:t,color:n(t)}}),t}}]),n}(),Vt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sankey-chart"),e.sankey=new Nt(e.mainGroup),e._marginLeft=20,e._marginRight=20,e}return c(n,L),a(n,[{key:"updateCore",value:function(){var t=this,n=t.sankey,i=t.tooltip,o=t._data.valueLabel;n.data(t.activeData).width(t.widthOfNoMargin).height(t.heightOfMainGroup).fontSize(t._fontSize).fontFamily(t._fontFamily).fontColor(t._fontColor).onMouseover(function(e){var t=[{color:e.color,text:e.name},{text:o+""+Math.max(d3.sum(e.sourceLinks,function(t){return t.value}),d3.sum(e.targetLinks,function(t){return t.value}))}];n.elem.selectAll(".link").filter(function(t){return t.source===e||t.target===e}).style("stroke-opacity",.9),i.data(t).update().show()}).onMousemove(function(t){i.move()}).onMouseout(function(e){i.hide(),n.elem.selectAll(".link").filter(function(t){return t.source===e||t.target===e}).style("stroke-opacity",n.strokeOpacity())}).onMouseoverLink(function(t){var e=[{text:t.source.name+"  "+t.target.name+""+t.value}];d3.select(this).style("stroke-opacity",.9),i.data(e).update().show()}).onMousemoveLink(function(t){i.move()}).onMouseoutLink(function(t){d3.select(this).style("stroke-opacity",n.strokeOpacity()),i.hide()}).eventOnDrag(function(){i.move()}),n.update()}},{key:"configLegend",value:function(){var t=this,i=t._data;t.legend.data(i.legendData).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.legendData.forEach(function(t){t.name===e.name&&(t.active=!n)}),i.nodes.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new It(t,e);return n.dataSolveFunc(Ht),n}},{key:"activeData",get:function(){var t=this._data.nodes,n=this._data.links.filter(function(e){return t.some(function(t){return!1!==t.active&&t.key===e.source})&&t.some(function(t){return!1!==t.active&&t.key===e.target})}).map(function(t){return Object.assign({},t)});return{nodes:t.filter(function(e){return!1!==e.active&&(n.some(function(t){return e.key===t.source})||n.some(function(t){return e.key===t.target}))}).map(function(t){return Object.assign({},t)}),links:n}}}]),n}(),Yt=(function(t){function e(t){return r(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}c(e,Vt),a(e,[{key:"buildOption",value:function(t,e){var n=new It(t,e);return n.dataSolveFunc(Et),n}}])}(),function(t){function e(t){return r(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return c(e,Nt),a(e,[{key:"update",value:function(){var i=this,o=i._width,e=i._height,t=i._data,r=i.sankeyFunc,n=i._fontSize,a=i.group.call(E,0,n);r.nodeId(function(t){return t.key}).size([e-2*n,o]);var l,s=r.nodePadding(),u=r(t),c=u.nodes.filter(function(t){return t.sourceLinks.length||t.targetLinks.length});i._sortByIndex&&(l=d3.max(c,function(t){return t.depth})+1,d3.range(l).forEach(function(e){var t=c.filter(function(t){return t.depth===e}).sort(function(t,e){return t.index-e.index}),n=d3.min(t,function(t){return t.y0});t.forEach(function(t){var e=t.y1-t.y0;t.y0=n,t.y1=n+e,n+=e+s})}),r.update(u));var h=(a.select(".links-group").empty()?a.append("g").attr("class","links-group").style("fill","none"):a.select(".links-group")).selectAll(".link").data(u.links);h.exit().remove();var d=h.enter().append("path").attr("class","link").merge(h).attr("d",Bt()).style("stroke",function(t){return t.source.color}).style("stroke-width",function(t){return Math.max(1,t.width)}).style("stroke-opacity",i._strokeOpacity).on("mouseover",i._onMouseoverLink).on("mousemove",i._onMousemoveLink).on("mouseout",i._onMouseoutLink),_=(a.select(".nodes-group").empty()?a.append("g").attr("class","nodes-group"):a.select(".nodes-group")).selectAll(".node-group").data(c);_.exit().remove();var f=_.enter().append("g").attr("class","node-group");f.append("rect"),f.append("text");var p=f.merge(_).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout);p.select("rect").attr("x",function(t){return t.y0}).attr("y",function(t){return t.x0}).attr("width",function(t){return Math.max(0,t.y1-t.y0)}).attr("height",function(t){return Math.max(0,t.x1-t.x0)}).style("fill",function(t){return t.color}).style("stroke","#333"),p.select("text").attr("y",function(t){return t.x0<=e/2?t.x0-6:t.x1+6}).attr("x",function(t){return(t.y0+t.y1)/2}).attr("dy",function(t){return t.x0<=e/2?"0":"0.66em"}).style("text-anchor","middle").style("font-size",n+"px").style("font-family",i._fontFamily).style("fill",i._fontColor).text(function(t){return I(t.name,t.y1-t.y0+s,n,i._fontFamily)});var y=d3.drag().on("start",function(){d3.select(this).raise()}).on("drag",function(t){var e=d3.event.dx,n=t.y1-t.y0;t.y0=Math.max(0,Math.min(t.y0+e,o-n)),t.y1=t.y0+n,d3.select(this).select("rect").attr("x",t.y0),d3.select(this).select("text").attr("x",function(t){return(t.y0+t.y1)/2}),r.update(u),d.attr("d",Bt()),i._eventOnDrag()});return p.style("cursor","move").call(y),i}}]),e}()),Xt=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","vetical-sankey-chart"),e.sankey=new Yt(e.mainGroup),e}c(n,Vt)}(),function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.keyArr,n=this.generateColorList(e.length);return t.legendData=e.map(function(t,e){return{name:t,color:n[e]}}),t}}]),n}());function Qt(t,e){var a=0,l=1,s=2;if(e.forEach(function(t){"objCol"===t.function?a=t.index:"targetCol"===t.function?l=t.index:"vCol"===t.function&&(s=t.index)}),m(t,[a,l,s])||!O(t,s))return{keyArr:[],matrix:[],valueLabel:""};var i=[],u={},o=0;t.slice(1).forEach(function(t){var e=t[a],n=t[l];void 0===u[e]&&(u[e]=o,i.push(e),o++),void 0===u[n]&&(u[n]=o,i.push(n),o++)});var c=d3.range(o).map(function(t){return d3.range(o).map(function(t){return 0})});return t.slice(1).forEach(function(t){var e=t[a],n=t[l],i=t[s],o=u[e],r=u[n];c[o][r]=Math.abs(i)||0}),{keyArr:i,matrix:c,valueLabel:t[0][s]}}var qt=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","chord"),e.chordFunc=d3.chord(),e._innerRadius=100,e._outerRadius=120,e._padAngle=.02,e._onMouseoverChord=function(){},e._onMousemoveChord=function(){},e._onMouseoutChord=function(){},e}return c(n,T),a(n,[{key:"update",value:function(){var t=this,e=t._data.matrix,n=t._data.nodes,i=t.group;if(!(n.length<=1)){var o=t._innerRadius,r=t._outerRadius,a=t._padAngle,l=t.chordFunc.padAngle(a).sortChords(d3.descending),s=d3.arc().innerRadius(o).outerRadius(r),u=d3.ribbon().radius(o);i.datum(l(e)).call(E,r,r);var c=i.selectAll(".arc-group").data(function(t){return t.groups});c.exit().remove();var h=c.enter().append("g").attr("class","arc-group");h.append("path").attr("class","arc-path"),h.merge(c).each(t._onTransitionEnd).select("path").attr("d",s).style("fill",function(t){return n[t.index].color}).style("stroke",function(t){return n[t.index].color}).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);var d=i.selectAll(".ribbon-path").data(function(t){return t});return d.exit().remove(),d.enter().append("path").attr("class","ribbon-path").merge(d).attr("d",u).style("fill",function(t){return n[t.source.index].color}).style("stroke",function(t){return d3.rgb(n[t.source.index].color).darker()}).style("fill-opacity",.8).style("stroke-opacity",.8).on("mouseover",t._onMouseoverChord).on("mousemove",t._onMousemoveChord).on("mouseout",t._onMouseoutChord),t}i.selectAll("*").remove()}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"onMouseoverChord",value:function(t){return arguments.length?(this._onMouseoverChord="function"==typeof t?t:function(){},this):this._onMouseoverChord}},{key:"onMousemoveChord",value:function(t){return arguments.length?(this._onMousemoveChord="function"==typeof t?t:function(){},this):this._onMousemoveChord}},{key:"onMouseoutChord",value:function(t){return arguments.length?(this._onMouseoutChord="function"==typeof t?t:function(){},this):this._onMouseoutChord}}]),n}(),Zt=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","chord-chart"),e.chord=new qt(e.mainGroup),e}c(n,L),a(n,[{key:"updateCore",value:function(){var o=this,t=o.activeData,r=t.nodes,n=o.chord,i=o.tooltip,e=o.widthOfNoMargin,a=o.heightOfMainGroup,l=o._fontSize,s=o._data.valueLabel,u=Math.min(e,a)/2-l,c=.9*u;function h(t,e){"number"==typeof e?n.group.selectAll(".ribbon-path").filter(function(t){return t.source.index!==e&&t.target.index!==e}).transition().style("opacity",t):n.group.selectAll(".ribbon-path").filter(function(t){return this!==e}).transition().style("opacity",t)}n.data(t).innerRadius(c).outerRadius(u).translate(e/2-u,a/2-u).onMouseover(function(t){var e=t.index,n=[{color:r[e].color,text:r[e].name},{text:s+""+t.value}];i.data(n).update().show(),h(0,e)}).onMousemove(function(){i.move()}).onMouseout(function(t){i.hide(),h(1,t.index)}).onMouseoverChord(function(t){var e=[];e=t.source.value===t.target.value?[{text:r[t.source.index].name+"  "+r[t.target.index].name+""+t.source.value}]:[{text:r[t.source.index].name+"  "+r[t.target.index].name+""+t.source.value},{text:r[t.target.index].name+"  "+r[t.source.index].name+""+t.target.value}],i.data(e).update().show(),h(.1,this)}).onMousemoveChord(function(){i.move()}).onMouseoutChord(function(t){i.hide(),h(1,this)}).onTransitionEnd(function(t){var e=d3.select(this),n="arc-path-"+t.index+"-"+o.id,i=x(u+l-2,t.startAngle,t.endAngle);A(e,o.defs.select("#"+n).empty()?o.defs.append("path").attr("d",i).attr("id",n):o.defs.select("#"+n).attr("d",i),r[t.index].name,l,o._fontFamily).attr("class",o.labelTextClass).style("pointer-events","none").style("fill",o._fontColor)}),n.update()}},{key:"configLegend",value:function(){var t=this,e=t.legend,i=t._data.legendData;e.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new Xt(t,e);return n.dataSolveFunc(Qt),n}},{key:"activeData",get:function(){var t=this._data,e=t.matrix,n=t.legendData,i=[];n.forEach(function(t,e){!1===t.active&&i.push(e)});var o=n.filter(function(t){return!1!==t.active}),r=[];return e.forEach(function(t,e){if(i.indexOf(e)<0){var n=[];t.forEach(function(t,e){i.indexOf(e)<0&&n.push(t)}),r.push(n)}}),{nodes:o,matrix:r}}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-pie"),e.defs=e.elem.append("defs"),e._width=400,e._height=400,e._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},e._countOfOneRow=20,e._rowCount=5,e._padding=2,e}return c(n,T),a(n,[{key:"update",value:function(){var y=this,v=y._data,g=y._width,t=y._height,e=y._padding,n=y._icon,m=y._countOfOneRow,l=y._rowCount,s=d3.sum(v,function(t){return t.value}),i=v.length,u=0,x=v.map(function(t){var e=s<=m*l?t.value:t.value/s*(m*l),n=u+e,i=u;u=n;var o=Math.floor(e),r=!1,a=!1;return i%1!=0&&(r=!0,o++),n%1!=0&&(a=!0,o++),{percent:e,count:o,startPercent:i,endPercent:n,hasHead:r,hasTail:a}});s<m*l&&(l=Math.ceil(s/m)),s<m&&(m=Math.ceil(s));var k=g/m,S=t/l,w=k-2*e,b=S-2*e,O=Math.min(w/n.width,b/n.height);return w=n.width*O,b=n.height*O,function(){var d=y.group,_=y.defs,f=y.id;d.selectAll("*").remove(),_.selectAll("*").remove();var p=f+"-icon";_.append("path").attr("id",p).attr("d",n.path);for(var t=function(e){var n=x[e];if(!n.percent)return"continue";var t=Math.floor(n.startPercent),i=n.startPercent%m*k,o=Math.floor(t/m)*S,r=Math.ceil(n.endPercent),a=n.endPercent%m==0?(n.endPercent-1)%m*k+k:n.endPercent%m*k,l=(Math.ceil(r/m)-1)*S,s=_.append("clipPath").attr("id","clip-path-"+f+"-"+e);s.append("path").attr("id","icon-overlay-"+f+"-"+e).attr("d",function(){var t=Math.floor(n.startPercent/m)<Math.floor(n.endPercent/m),e="M"+i+","+(o+S)+"V"+o+"H"+(t?g:a)+"V"+(t?l:l+S);return t&&(e+="H"+a+"v"+S+"H0V"+(o+S)),e+="Z"}).style("fill","transparent");for(var u=d.append("g").attr("clip-path","url(#clip-path-"+f+"-"+e+")"),c=function(n){var t=u.append("g").attr("transform",function(){var t=n%m*k,e=Math.floor(n/m)*S;return"translate("+t+","+e+")"});t.append("use").attr("class","icon-path-"+e).attr("xlink:href","#"+p).style("fill",v[e].color).style("stroke-width",1/O).attr("transform","translate("+(k-w)/2+", "+(S-b)/2+")scale("+O+")")},h=t;h<r;h++)c(h);u.append("use").datum({index:e,data:v[e]}).attr("xlink:href","#icon-overlay-"+f+"-"+e).on("mouseover",y._onMouseover).on("mousemove",y._onMousemove).on("mouseout",y._onMouseout)},e=0;e<i;e++)t(e)}(),y}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}()),Ut=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-pie-chart"),e.iconPie=new Zt(e.mainGroup),e}c(n,L),a(n,[{key:"updateCore",value:function(){var t=this,e=t.iconPie,n=t.tooltip,i=e.elem;e.data(t.activeData).width(t.widthOfNoMargin).height(t.heightOfMainGroup).onMouseover(function(t){i.selectAll(".icon-path-"+t.index).style("fill-opacity",.4);var e=[{color:t.data.color,text:t.data.name},{text:t.data.valueLabel+": "+t.data.value}];n.data(e).update().show()}).onMousemove(function(){n.move()}).onMouseout(function(t){i.selectAll(".icon-path-"+t.index).style("stroke","none").style("fill-opacity",1),n.hide()}),e.update()}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-pie"),e.overlayCircle=e.elem.append("defs").append("clipPath").attr("id","overlay-"+e.id).append("circle"),e._radius=0,e._cornerRadius=4,e._padAngle=.01,e._stroke="#fff",e._strokeWidth=1,e._each=function(){},e}return c(n,P),a(n,[{key:"update",value:function(){var t=this,e=t._data,n=t._radius,i=d3.partition().size([2*Math.PI,n])(d3.hierarchy(e).sum(function(t){return t.value})),o=i.descendants(),r=Math.min(d3.min(o,function(t){return t.value})/i.value*Math.PI,t._padAngle),a=d3.arc().startAngle(function(t){return t.x0}).endAngle(function(t){return t.x1}).innerRadius(function(t){return 1===t.depth?t.y0-3:t.y0}).outerRadius(function(t){return 1===t.depth?t.y1-3:t.y1}).padAngle(r).cornerRadius(t._cornerRadius);t.overlayCircle.attr("r",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",n);var l=t.group.call(E,n,n).attr("clip-path","url(#overlay-"+t.id+")").selectAll("g").data(o.filter(function(t){return 0!==t.depth}),function(t){return t.data.key});l.exit().remove();var s=l.enter().append("g");return s.append("path"),s.merge(l).select("path").attr("class","arc-path").attr("d",a).style("fill",function(t){if(t.data.color)return t.data.color;var e=t.parent,n=d3.scaleLinear().clamp(!1).domain([0,1]),i=d3.hsl(e.data.color),o=e.children.length;if(1===o)i.l+=.08;else{n.range([i.l+Math.min(.4,.08*o)/2,i.l-Math.min(.4,.08*o)/2]);var r=e.children.indexOf(t)/(o-1);i.l=n(r)}return i}).style("stroke",t._stroke).style("stroke-width",t._strokeWidth).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).each(t._each),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"each",value:function(t){return arguments.length?(this._each="function"==typeof t?t:function(){},this):this._each}}]),n}()),Kt=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.nodes,i=this.generateColorList(e.length);return e.forEach(function(t,e){var n=i[e];t.color=n}),t}}]),n}();function Jt(t,e){var r=0,a=1,l=2;if(e.forEach(function(t){"objCol"===t.function?r=t.index:"typeCol"===t.function?a=t.index:"vCol"===t.function&&(l=t.index)}),m(t,[r,a,l])||!O(t,l))return{nodes:[],valueLabel:""};var s={};t.slice(1).forEach(function(t,e){var n=t[r],i=t[a],o=t[l];s[n]?s[n].children.push({name:i,key:i+"-t-"+e,index:e,value:o}):s[n]={name:n,key:n+"-s-"+e,index:e,children:[{name:i,key:i+"-t-"+e,index:e,value:o}]}});var n=[];for(var i in s)n.push(s[i]);return n.forEach(function(t){return t.sum=d3.sum(t.children,function(t){return t.value})}),{nodes:n,valueLabel:t[0][l]}}var $t=function(t){function e(t){return r(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return c(e,L),a(e,[{key:"updateCore",value:function(){}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.nodes,o=i.map(function(t,e){return{name:t.name,color:t.color,key:t.name+"-"+e}});t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.key===e.key&&(t.active=!n)}),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort(function(t,e){return e.sum-t.sum||t.index-e.index}):1===this._sortValue&&t.sort(function(t,e){return t.sum-e.sum||t.index-e.index}),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new Kt(t,e);return n.dataSolveFunc(Jt),n}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter(function(t){return!1!==t.active})}}}]),e}(),te=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-donut-chart"),e.core=new Ut(e.mainGroup),e}c(n,$t),a(n,[{key:"updateCore",value:function(){var o=this,t=o.core,n=o.tooltip,i=o._data.valueLabel,e=o.widthOfNoMargin,r=o.heightOfMainGroup,a=Math.min(e,r)/2;t.data(o.activeData).radius(a).translate(e/2-a,r/2-a).transition(o._transition).duration(o._duration).onMouseover(function(t){var e=[{color:t.data.color||t.parent.data.color,text:t.data.name},{text:i+""+t.value}];n.data(e).update().show(),d3.select(this).transition().duration(20).style("fill-opacity",.7)}).onMousemove(function(){n.move()}).onMouseout(function(){n.hide(),d3.select(this).transition().duration(20).style("fill-opacity",1)}).each(function(t){var e=d3.select(this.parentNode),n="arc-path-"+t.data.key+"-"+t.depth+"-"+o.id,i=x(.5*(t.y0+t.y1),t.x0,t.x1);A(e,o.defs.select("#"+n).empty()?o.defs.append("path").attr("d",i).attr("id",n):o.defs.select("#"+n).attr("d",i),t.data.name,o._fontSize,o._fontFamily).attr("class",o.labelTextClass).style("pointer-events","none").style("fill",o._fontColor)}),t.update()}}])}(),function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.nodes,n=this.generateColorList(e.length);return e.forEach(function(t,e){return t.color=n[e]}),t}}]),n}());function ee(t,e){var n=0,i=1;return e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),m(t,[n,i])||!O(t,i)?{nodes:[],valueLabel:""}:{nodes:t.slice(1).map(function(t,e){return{name:t[n],key:t[n]+"-"+e,value:t[i]}}),valueLabel:t[0][i]}}var ne=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","treemap"),e._width=400,e._height=400,e._paddingInner=1,e}return c(n,T),a(n,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;if(e.children.length<1)return n.selectAll("*").remove(),t;var i=d3.treemap().size([t._width,t._height]).paddingInner(t._paddingInner).round(!0),o=d3.hierarchy(e).sum(function(t){return t.value});i(o);var r=n.selectAll(".node").data(o.leaves(),function(t){return t.data.key});r.exit().remove();var a=r.enter().append("g").attr("class","node");return a.append("rect"),a.merge(r).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).transition().duration(t._transition?t._duration:0).on("end",t._onTransitionEnd).select("rect").attr("x",function(t){return t.x0}).attr("y",function(t){return t.y0}).attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).style("fill",function(t){return t.data.color}),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}(),ie=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","one-level-treemap-chart"),e.treemap=new ne(e.mainGroup),e._sortValue=-1,e._marginLeft=20,e._marginRight=20,e}c(n,L),a(n,[{key:"updateCore",value:function(){var o=this,t=o.treemap,n=o.tooltip,e=o.widthOfNoMargin,i=o.heightOfMainGroup,r=o._data.valueLabel,a=o._fontSize,l=o._fontFamily;t.data(o.activeData).width(e).height(i).transition(o._transition).duration(o._duration).onMouseover(function(t){var e=[{color:t.data.color,text:t.data.name},{text:r+""+t.value}];n.data(e).update().show(),d3.select(this).style("fill-opacity",.7)}).onMousemove(function(){n.move()}).onMouseout(function(){n.hide(),d3.select(this).style("fill-opacity",1)}).onTransitionEnd(function(t){var e=t.y1-t.y0,n=t.x1-t.x0,i=d3.select(this).append("g").attr("class",o.labelTextClass).attr("font-size",a+"px").attr("font-family",l).style("fill",o._fontColor);a+10<e&&(i.append("text").attr("x",t.x0+6).attr("y",t.y0+6).attr("dy","0.75em").text(I(t.data.name,n-10,a,l)),2*a+10<e&&i.append("text").attr("x",t.x0+6).attr("y",t.y0+6).attr("dy","2em").text(I(t.value,n-10,a,l)))}),t.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.nodes;t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){-1===this._sortValue&&this._data.nodes.sort(function(t,e){return e.value-t.value}),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new te(t,e);return n.dataSolveFunc(ee),n}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter(function(t){return!1!==t.active})}}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-treemap"),e._clipId="clip-overlay-"+e.id,e.overlayRect=e.elem.append("defs").append("clipPath").attr("id",e._clipId).append("rect"),e.group.attr("clip-path","url(#"+e._clipId+")"),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleLinear(),e._width=400,e._height=400,e._paddingInner=1,e._paddingOuter=2,e._stroke="#fff",e._parentFillOpacity=.7,e._transition=!1,e._duration=400,e}return c(n,T),a(n,[{key:"update",value:function(){var o=this,t=o._data,r=o.group;if(t.children.length<1)return r.selectAll("*").remove(),o;var a=!1,l=!1,e=o._width,n=o._height,s=o.xScale.domain([0,1]).range([0,e]),u=o.yScale.domain([0,1]).range([0,n]),c=d3.hierarchy(t).sum(function(t){return t.value});function i(){var t=(r.select(".children-group").empty()?r.append("g").attr("class","children-group"):r.select(".children-group")).selectAll(".child-node").data(c.leaves(),function(t){return t.data.key});t.exit().remove();var e=t.enter().append("g").attr("class","child-node");e.append("rect"),e.merge(t).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).on("click",function(){l=!0,d(c)}).transition().duration(o._transition||l?o._duration:0).on("start",a?o._onTransitionStart:null).on("end.a",a?o._onTransitionEnd:null).on("end.b",function(){l=!1}).select("rect").attr("x",function(t){return s(t.x0)}).attr("y",function(t){return u(t.y0)}).attr("width",function(t){return s(t.x1)-s(t.x0)}).attr("height",function(t){return u(t.y1)-u(t.y0)}).style("fill",function(t){return t.parent.data.color}).style("stroke",o._stroke).style("stroke-width",o._paddingInner).style("opacity",1)}function h(){var t=r.select(".parent-group").empty()?r.append("g").attr("class","parent-group"):r.select(".parent-group"),e=c.descendants().filter(function(t){return 1===t.depth}),n=t.selectAll(".parent-node").data(e,function(t){return t.data.key});n.exit().remove();var i=n.enter().append("g").attr("class","parent-node");i.append("rect"),i.merge(n).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).on("click",function(t){l=!0,d(t)}).transition().duration(o._transition||l?o._duration:0).on("start.a",a?null:o._onTransitionStart).on("start.b",function(){t.style("display",a?"none":"block")}).on("end",a?null:o._onTransitionEnd).select("rect").attr("x",function(t){return s(t.x0)}).attr("y",function(t){return u(t.y0)}).attr("width",function(t){return s(t.x1)-s(t.x0)}).attr("height",function(t){return u(t.y1)-u(t.y0)}).style("fill",function(t){return t.data.color}).style("fill-opacity",o._parentFillOpacity).style("stroke",o._stroke).style("stroke-width",o._paddingOuter).style("opacity",1)}function d(t){var e=t.depth;s.domain([t.x0,t.x1]),u.domain([t.y0,t.y1]),a=1===e,i(),h()}return d3.treemap().size([1,1]).round(!1)(c),o.overlayRect.attr("width",e).attr("height",n),d(c),o}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}());!function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-treemap-chart"),e.treemap=new ie(e.mainGroup),e._sortValue=-1,e._marginLeft=20,e._marginRight=20,e}c(n,$t),a(n,[{key:"updateCore",value:function(){var l=this,s=l.treemap,n=l.tooltip,t=l.widthOfNoMargin,e=l.heightOfMainGroup,i=l._data.valueLabel,u=l._fontSize,c=l._fontFamily;s.data(l.activeData).width(t).height(e).onMouseover(function(t){var e=[{color:t.data.color||t.parent.data.color,text:t.data.name},{text:i+""+t.value}];n.data(e).update().show(),d3.select(this).select("rect").style("opacity",.5)}).onMousemove(function(){n.move()}).onMouseout(function(){n.hide(),d3.select(this).select("rect").style("opacity",1)}).onTransitionStart(function(){s.elem.selectAll("."+l.labelTextClass).remove()}).onTransitionEnd(function(t){var e=s.xScale,n=s.yScale,i=n(t.y1)-n(t.y0),o=e(t.x1)-e(t.x0),r=d3.select(this).append("g").attr("class",l.labelTextClass).attr("font-size",u+"px").attr("font-family",c).style("fill",l._fontColor),a="";u+10<i&&(a=I(t.data.name,o-10,u,c),r.append("text").attr("x",e(t.x0)+6).attr("y",n(t.y0)+6).attr("dy","0.75em").text(a),2*u+10<i&&a&&r.append("text").attr("x",e(t.x0)+6).attr("y",n(t.y0)+6).attr("dy","2em").text(I(t.value,o-10,u,c)))}),s.update()}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort(function(t,e){return e.sum-t.sum||t.index-e.index}).forEach(function(t){t.children.sort(function(t,e){return e.sum-t.sum||t.index-e.index})}):1===this._sortValue&&t.sort(function(t,e){return t.sum-e.sum||t.index-e.index}).forEach(function(t){t.children.sort(function(t,e){return t.sum-e.sum||t.index-e.index})}),this._sortedDataCopy=this._data}}])}();function oe(t,e){var n=0,i=0;if(e.forEach(function(t){"sourceCol"===t.function?n=t.index:"targetCol"===t.function&&(i=t.index)}),m(t,[n,i]))return{nodesObj:{},nodesArr:[],root:{}};for(var o=[],r={},a=0,l=t.length,s=1;s<l;s++){var u=t[s],c=u[n],h=u[i];if(c&&h&&c!==h){if(!r[c]){var d={name:c,index:a};r[c]=d,o.push(d),a++}if(!r[h]){var _={name:h,index:a};r[h]=_,o.push(_),a++}var f=r[c],p=r[h];p.parent||((p.parent=f).children?f.children.push(p):f.children=[p])}}var y=null,v=o.filter(function(t){return!t.parent});if(1===v.length)y=v[0];else{if(!(1<v.length))throw y={name:"",children:[]},new Error("");y={name:"",children:v}}return function e(t){var n=t.depth?t.depth:t.depth=0;t.children&&t.children.forEach(function(t){t.depth=n+1,e(t)})}(y),{nodesObj:r,nodesArr:o,root:y}}function re(t,e){var n=oe(t[0],e[0]),i=ee(t[1],e[1]);return n.nodesArr.forEach(function(e){i.nodes.forEach(function(t){e.name===t.name&&(e.value=t.value)})}),{root:n.root,valueLabel:i.valueLabel}}var ae=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=t.root;if(e&&e.children){var n=e.children.slice(0);e.name&&n.unshift(e),W(n,this.generateColorList(n.length))}return{root:t.root,valueLabel:t.valueLabel}}}]),n}(),le=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sunburst"),e.arcFunc=d3.arc(),e._radius=200,e._stroke="#fff",e._duration=750,e}return c(n,T),a(n,[{key:"update",value:function(){var u,c,r=this,t=r._data,e=r._radius,i=d3.hierarchy(t).sum(function(t){return t.value}),a=2*Math.PI,o=d3.partition().size([a,e]);o(i),c=u=.075,function n(t,e){if(1<t.depth){var i=t.parent,o=i.children.length-1,r=Math.pow(-1,t.depth),a=d3.hsl(i.data.color),l=a.l;c=r<0&&l<u*o?l/(o+2):0<r&&1-l<u*o?(1-l)/(o+2):u,a.l+=c*e*r,t.data.color=a.toString()}var s=t.children;s&&s.forEach(function(t,e){n(t,e)})}(i);var n=r.arcFunc.innerRadius(function(t){return Math.max(0,t.y0)}).outerRadius(function(t){return Math.max(0,t.y1)}).startAngle(function(t){return t.x0}).endAngle(function(t){return t.x1}),l=r.group,s=!1,h={oldState:f(i),newState:f(i),currentRootNode:i,currentClickedNode:i};function d(t){var e=t.data.name?t.descendants():t.descendants().slice(1),n=l.selectAll(".arc-group").data(e,function(t){return t.data.name});n.select("text").remove(),n.exit().transition().duration(r._transition||s?r._duration:0).on("start",r._onTransitionStart).remove().select("path").attrTween("d",function(t){return p.call(this,function(t){if(!s)return{x0:t.x0,x1:t.x1,y0:0,y1:0};if(t.depth<h.currentClickedNode.depth)return{x0:t.x0,x1:t.x1,y0:0,y1:0};return{x0:t.x0>=h.oldState.x1?a:0,x1:t.x0>=h.oldState.x1?a:0,y0:0,y1:0}}(t))});var i=n.enter().append("g").attr("class","arc-group");i.append("path").style("fill",function(t){return t.data.color}).style("stroke",r._stroke).each(function(t){this._currentArc=function(t){if(!s)return{x0:t.x0,x1:t.x1,y0:0,y1:0};return{x0:t.x0>=h.newState.x1?a:0,x1:t===h.currentRootNode||t.x0>=h.newState.x1?a:0,y0:0,y1:0}}(t)});var o=i.merge(n).on("click",_).on("mouseover",r._onMouseover).on("mousemove",r._onMousemove).on("mouseout",r._onMouseout);o.select("path").style("fill",function(t){return t.data.color}).style("stroke",r._stroke),o.transition().duration(r._transition||s?r._duration:0).on("start",r._onTransitionStart).on("end.a",r._onTransitionEnd).on("end.b",function(){s=!1}).select("path").attrTween("d",function(t){return p.call(this,f(t))})}function _(e){if(!s&&e.data.name!==i.data.name){s=!0;var t=(h.currentClickedNode=e)===h.currentRootNode?e.data.parent:e.data;h.oldState=f(e),h.currentRootNode=d3.hierarchy(t).sum(function(t){return t.value}),o(h.currentRootNode);var n=h.currentRootNode.descendants().filter(function(t){return t.data.name===e.data.name})[0];h.newState=f(n),d(h.currentRootNode)}}function f(t){return{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1}}function p(t){var e=d3.interpolate(this._currentArc,t);return this._currentArc=e(0),function(t){return n(e(t))}}return d(i),r}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}}]),n}();!function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sunburst-chart"),e.sunburst=new le(e.mainGroup),e._sortValue=-1,e}c(n,L),a(n,[{key:"updateCore",value:function(){var n=this,i=n.sunburst,o=n.tooltip,r=n.activeData,t=n.widthOfNoMargin,e=n.heightOfMainGroup,a=Math.min(t,e)/2,l=n._fontSize,s=n._fontFamily;i.data(r.root).radius(a).translate(t/2,e/2).transition(n._transition).duration(n._duration).onMouseover(function(t){var e=[{color:t.data.color,text:t.data.name},{text:r.valueLabel+""+t.value}];o.data(e).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(){o.hide()}).onTransitionStart(function(){d3.select(this).select("text").style("opacity",0).remove()}).onTransitionEnd(function(t){var r=i.arcFunc,e="";(e=0===t.depth?I(t.data.name,2*(t.y1-t.y0),l,s):t.y0*(t.x1-t.x0)<1.25*l?"":I(t.data.name,t.y1-t.y0,l,s))&&d3.select(this).append("text").attr("class",n.labelTextClass).style("pointer-events","none").style("font-size",l+"px").style("font-family",s).style("fill",n._fontColor).attr("transform",function(t){var e,n,i=90<(n=(((e=t).x0+e.x1)/2-Math.PI/2)/Math.PI*180)?n-180:n,o=r.centroid(t);return 0===t.depth&&(o=[i=0,0]),"translate("+o+")rotate("+i+")"}).append("tspan").attr("x",0).attr("y",0).attr("dy","0.35em").style("text-anchor","middle").style("fill",n._fontColor).text(e)}),i.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.root,i=e.children?e.children.map(function(t){return t}):[];e.name&&i.unshift(e),t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t=this._data,e=t.root;!function e(t){var n=Math.abs(t.value)||0;t.children&&t.children.forEach(function(t){n+=e(t)});t.sum=n;return n}(e),-1===this._sortValue&&function e(t){t.children&&t.children.sort(function(t,e){return e.sum-t.sum||t.index-e.index}).forEach(function(t){e(t)})}(e),this._sortedDataCopy=t}},{key:"buildOption",value:function(t,e){var n=new ae(t,e);return n.dataSolveFunc(re),n}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.root,n={name:e.name,color:e.color,value:e.value,sum:e.sum,children:e.children&&e.children.filter(function(t){return!1!==t.active})};return!1===e.active&&(n.children=[]),{root:n,valueLabel:t.valueLabel}}}])}();var se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAI6SURBVHjafJLLTlNhFIX7GlBaUJwABYlODIWWJoAil0QBQZyQoPGpIFigpVJNeAkSSCRATI2A1BZs6WnOIcSe/3Iu+ZxoC0njYI3WWoNv7xWwrOtDIYRRq9l12bYwtHaMXO67obU2bPuuL4QwLMs6CEipfyulkFLWBZDJfOZB52PW1zMAKNXwlVIoJW8CQkhTSokQAiEEnueSze4QDvURDvXSFoyQSmXxPLee+Zuv3in7vkelYrAwv0xieJpIzwCJ4WnmZpcolcr4vt+87PsehlGlVqshhSSfLxAbmuDk5AwpFbZtU6kY+L7XKEupTIDt7R0W5pfrzOXyFfHYJMXiBQCO4/Bm8T2bm9sASCmrAcdxzHT6E+FQL4nhafL5AuXSFQcHxwxGx9nf+0K5fEWxeMnTsRmCrT0kkxm01tXAt9yJ2Xn/EeFQL5GeKLHYJPHYFIPR53R3PWEwOk48PkU8NkkkEqU9/JCO9n6Ojr5WA1prM5ncoi0YITE8zenpD4rFS/b3D4gOPGN3d4+Li0vOz38yNjpDa0sXKyvrKKUazKlUlrnZpVvMlTvMruvweuEta2vpBvPta5dLV9i2jdaaQuGC2NAEZ2fnOI6DbduUSmU8z0Mp1ezPPpWKweLiO0ZHXhLpiTI68oL5V8uUfv3nz//W47ou6VSWtmCE9nAfrS3dfPiwhes2WZiUqum2NzY+cq+jn9XVzabbllLeBCzr+kgIadq2qEsIaWrHMY+Pc6bW2mzmW5Z1+GcAWWbj+pgdyZ8AAAAASUVORK5CYII=",ue=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","tree"),e._width=400,e._height=400,e._visibleDepth=5,e._maxRadius=20,e._textPadding=4,e._linkStrokeOpacity=.35,e._nodeFillOpacity=.45,e._nodeStrokeOpacity=.6,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._hasValue=!0,e}return c(n,T),a(n,[{key:"update",value:function(){var o=this,t=o._data,e=o._width,n=o._height,i=n/2,r=Math.min(o._maxRadius,Math.floor(.0375*n)),a=o._fontSize,l=o._fontFamily,s=o._textPadding,u=8*a,c=5*a,h=Math.min(H(t.name,a,l),u)+s+r,d=d3.hierarchy(t).sum(function(t){return t.value||0}),_=d.descendants(),f=d.leaves().length,p=d3.max(_,function(t){return t.depth})||1,y=d3.max(_,function(t){return t.value}),v=(e-h-c)/Math.min(o._visibleDepth,p),g=Math.max(n/f,a+4),m=v-2*s,x=d3.tree().nodeSize([g,v]).separation(function(t,e){return t.parent==e.parent?1:1.25}),k=d3.linkHorizontal().x(function(t){return t.y}).y(function(t){return t.x}),S=d3.zoom().scaleExtent([.1,3]);x(d);var w=d3.max(_,function(t){return t.x}),b=d3.min(_,function(t){return t.x}),O=n/2;(i<-b&&w<i||-b<i&&i<w)&&(O-=(w+b)/2);var C=d3.scaleSqrt().domain([0,y]).range([0,r]),A=o._hasValue,M=function(t){var e=t.depth?C(t.value):r/2;return A?e:r},F=function(t){return A?t.data.color:t._children?t.data.color:"#fff"},R=function(t){var e=A&&0===t.depth?r:M(t);return(t.children||t._children?-1:1)*(e+s)},W=!1,z=function(){return o._transition||W?o._duration:0},L=o.group;L.transition().duration(z).call(E,h,O),L.select(".bg-rect").empty()?L.append("rect").attr("class","bg-rect").attr("width",e).attr("height",n).style("opacity",0).call(E,-h,-O):L.select(".bg-rect");var T=L.select(".zoom-group").empty()?L.append("g").attr("class","zoom-group"):L.select(".zoom-group"),P=T.select(".links-group").empty()?T.append("g").attr("class","links-group"):T.select(".links-group"),D=T.select(".nodes-group").empty()?T.append("g").attr("class","nodes-group"):T.select(".nodes-group"),j=!1,G=L.select(".zoom-controller");function B(t){var n,e;x(d),n=t,(e=P.selectAll("path").data(d.links(),function(t){return t.target.data.name})).enter().append("path").attr("d",function(t){var e={x:n.x0,y:n.y0};return k({source:e,target:e})}).merge(e).style("fill","none").style("stroke-width",function(t){return 2*M(t.target)}).style("stroke",function(t){return t.target.data.color}).style("stroke-linecap","round").style("stroke-opacity",o._linkStrokeOpacity).transition().duration(z).attr("d",function(t){return k(t)}),e.exit().transition().duration(z).attr("d",function(t){var e={x:n.x,y:n.y};return k({source:e,target:e})}).remove(),function(e){var t=D.selectAll(".node-group").data(d.descendants(),function(t){return t.data.name}),n=t.enter().append("g").attr("class","node-group").style("cursor","pointer").attr("transform",function(t){return"translate("+e.y0+","+e.x0+")"}).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout);n.append("circle").attr("r",M).style("fill",F).style("fill-opacity",o._nodeFillOpacity).style("stroke",function(t){return t.data.color}).style("stroke-opacity",o._nodeStrokeOpacity),t.select("circle").style("fill",F).style("stroke",function(t){return t.data.color}),n.append("text").attr("x",R).attr("y",0).attr("dy","0.35em").style("text-anchor",function(t){return t.children||t._children?"end":"start"}).style("font-size",a+"px").style("font-family",l).style("fill",o._fontColor).style("fill-opacity",0).text(function(t){return t.depth?I(t.data.name,m,a,l):I(t.data.name,u,a,l)}),n.merge(t).on("click",N).transition().duration(z).attr("transform",function(t){return"translate("+t.y+","+t.x+")"}).on("end",function(){W=!1}).select("text").style("fill-opacity",1);var i=t.exit().transition().duration(z).attr("transform",function(){return"translate("+e.y+","+e.x+")"}).remove();i.select("circle").attr("r",0),i.select("text").style("fill-opacity",0)}(t),_.forEach(function(t){t.x0=t.x,t.y0=t.y})}function N(t){var e;W=!0,(e=t).children?(e._children=e.children,e.children=null):e._children&&(e.children=e._children,e._children=null),B(t=e)}G.empty()?(G=L.append("image").attr("class","zoom-controller").attr("x",-h).attr("y",-O).attr("xlink:href",se).on("click",function(){j=!j,L.on(".zoom",null),j?(G.attr("xlink:href","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGpSURBVHjafJLNruIwDIV5/zdBQqAKKHXzJxXYQlrgFdreRWgCG9rb5MyCuR0KM7OwFOXks3NsT+I4Pi+XS/MeURQZIjJRFH1oq9XKTKfT00QIceec4zWSJIHWObquQ1EUSJJkpCulsFgs7hPOuWGM4SeICIfDAd4HhAB4H6C1BhENb4QQmM/nZgSnaQrOOaqqhrUObdvBWoe6/oIQYkjwARMROBdDEiklrHVQSoEoBWMMnD8TjOA4jnE4HFFVNdI0BRG9wQQiQlmW0HkOInrCaZqa41Gj73tY6yClhJQS2+0Wzt2w3e4gpYQQAtdrg957nE5nzGYzM8myzHTdN0LA4NFaB+duaNsOzt2Gu8ejRQgB3ges1+tn5TzP0fd++KZSCrvdDs7dsN/voZSClBLXawPvAy6Xy7Pyj2etNer665+ek4RQlhWKovjj+bXbQgi8np+wHI3oo9vjOQuUZYWmsXg8WjSNRVXV/5/z64ZprYcNCwHI8wJEyV837P4KM8YQb2JonaNtOxTFCZvNZqT/hu8TzvmZMWbeg4hMlmWGiD40IYSJouj0awAemusiRGff+AAAAABJRU5ErkJggg==").select("title").text(""),L.call(S)):G.attr("xlink:href",se).select("title").text("")})).append("title").text(""):G.attr("x",-h).attr("y",-O),d.x0=d.x,d.y0=d.y,S.on("zoom",function(){var t=d3.event.transform;T.attr("transform",t)}),B(d)}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"linkStrokeOpacity",value:function(t){return arguments.length?(this._linkStrokeOpacity=t,this):this._linkStrokeOpacity}},{key:"nodeStrokeOpacity",value:function(t){return arguments.length?(this._nodeStrokeOpacity=t,this):this._nodeStrokeOpacity}},{key:"nodeFillOpacity",value:function(t){return arguments.length?(this._nodeFillOpacity=t,this):this._nodeFillOpacity}},{key:"visibleDepth",value:function(t){return arguments.length?(this._visibleDepth=t,this):this._visibleDepth}},{key:"textPadding",value:function(t){return arguments.length?(this._textPadding=t,this):this._textPadding}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"hasValue",value:function(t){return arguments.length?(this._hasValue=t,this):this._hasValue}}]),n}(),ce=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.root;if(e&&e.children){var n=e.children;W(n,this.generateColorList(n.length))}return{root:t.root||{children:[]},valueLabel:t.valueLabel}}}]),n}(),he=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","tree-chart"),e.tree=new ue(e.mainGroup),e._maxRadius=4,e._hasValue=!1,e._nodeFillOpacity=1,e}return c(n,L),a(n,[{key:"updateCore",value:function(){var n=this,i=n.tree,o=n.tooltip,r=n.activeData;if(!r.root||!r.root.children)return n;var t=n.widthOfNoMargin,e=n.heightOfMainGroup;i.data(r.root).width(t).height(e).maxRadius(n._maxRadius).hasValue(n._hasValue).nodeFillOpacity(n._nodeFillOpacity).transition(n._transition).duration(n._duration).fontSize(n._fontSize).fontFamily(n._fontFamily).fontColor(n._fontColor).onMouseover(function(e){d3.select(this).select("circle").style("fill-opacity",1).style("stroke-opacity",1),i.elem.select(".links-group").selectAll("path").filter(function(t){return t.target===e}).style("stroke-opacity",.7);var t=[{color:e.data.color,text:e.data.name}];n._hasValue&&t.push({text:r.valueLabel+""+e.value}),o.data(t).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(e){o.hide(),d3.select(this).select("circle").style("fill-opacity",i.nodeFillOpacity()).style("stroke-opacity",i.nodeStrokeOpacity()),i.elem.select(".links-group").selectAll("path").filter(function(t){return t.target===e}).style("stroke-opacity",i.linkStrokeOpacity())}),i.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.root.children||[];t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t,e=this._data.root;e&&e.children&&e.children.length&&((t=e).color=t.children[0].color,function e(t){1<t.depth&&(t.color=t.parent.color),t.children&&t.children.forEach(function(t){e(t)})}(t)),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new ce(t,e);return n.dataSolveFunc(oe),n}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.root;return{root:{name:e.name,color:e.color,value:e.value||0,children:e.children&&e.children.filter(function(t){return!1!==t.active})},valueLabel:t.valueLabel}}}]),n}();var de=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=t.root;if(e&&e.children){var n=e.children;W(n,this.generateColorList(n.length))}return{root:t.root||{children:[]},valueLabel:t.valueLabel}}}]),n}(),_e=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._hasValue=!0,e._maxRadius=20,e._nodeFillOpacity=.45,e}c(n,he),a(n,[{key:"buildOption",value:function(t,e){var n=new de(t,e);return n.dataSolveFunc(re),n}}])}(),function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.keys,n=this.generateColorList(e.length),i={};return e.forEach(function(t,e){return i[t]=n[e]}),t.colorMap=i,t}}]),n}());function fe(t,e){var i=0;if(e.forEach(function(t){"objCol"===t.function&&(i=+t.index)}),m(t,[i],2))return{keys:[],dataForStack:[]};var n=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(1===e.length)return t;var n=e.filter(function(t){return"objCol"===t.function||"vCol"===t.function&&t.configurable}).map(function(t){return t.index});return t.map(function(t){return t.filter(function(t,e){return 0<=n.indexOf(e)})})}(t,e),o=n[0];return{keys:o.filter(function(t,e){return e!==i}),dataForStack:n.slice(1).map(function(t){var n={};return t.forEach(function(t,e){e===i?n.name=t:n[o[e]]=t}),n})}}var pe=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stream-graph"),e}return c(n,dt),a(n,[{key:"update",value:function(){var e=this,n=e._data,t=e.group,i=n.stackData,o=e._areaFunc||d3.area().x(function(t){return e._xScale(t.data.name)}).y0(function(t){return e._yScale(t[0])}).y1(function(t){return e._yScale(t[1])}),r=t.selectAll("path").data(i,function(t){return t.key});return r.exit().remove(),r.enter().append("path").merge(r).style("fill",function(t){return n.colorMap[t.key]}).on("mouseover",e._onMouseover).on("mousemove",e._onMousemove).on("mouseout",e._onMouseout).transition().duration(e._transition?e._duration:0).attr("d",o),e}}]),n}(),ye=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.overlay=new gt(e.coreGroup),e.streamgraph=new pe(e.coreGroup),e.grid=new vt(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._marginLeft=50,e}c(n,ut),a(n,[{key:"updateCore",value:function(){var t=this,a=t.activeData,e=t.streamgraph,n=t.grid,l=t.tooltip,i=t.overlay,s=t.guideLine,o=t.clipArea,u=t.xScale,r=t.yScale,c=t.widthOfCore,h=t.heightOfCore,d=a.stackData,_=a.colorMap,f=d3.max(d,function(t){return d3.max(t,function(t){return Math.max(t[0],t[1])})}),p=d3.min(d,function(t){return d3.min(t,function(t){return Math.min(t[0],t[1])})});r.domain([p,f]).range([0,h]);var y=d3.area().x(function(t){return u(t.data.name)}).y0(function(t){return r(t[0])}).y1(function(t){return r(t[1])}).curve(d3.curveBasis);e.data(a).areaFunc(y).onMouseover(function(e){var t=e.key,n=[{text:t,color:_[t]}];l.data(n).update().show(),d3.select(this).raise().style("stroke","#000"),d3.select(this.parentNode).selectAll("path").filter(function(t){return t!=e}).style("fill-opacity",.3)}).onMousemove(function(t){l.move()}).onMouseout(function(){d3.select(this).style("stroke","none"),d3.select(this.parentNode).selectAll("path").style("fill-opacity",1),l.hide()}),n.width(c).height(h).xTickLocations(t.xAxis.tickLocations).showX(!1).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),s.y1(0).y2(h).strokeDasharray(t._gridStrokeDasharray),i.data(u.domain()).bandWidth(u.step()).bandHeight(h).onMouseover(function(t,e){var n=t,i=[{text:n}],o=a.dataForStack[e];for(var r in o)"name"!==r&&!1!==a.states[r]&&i.push({color:a.colorMap[r],text:r+""+o[r]});l.data(i).update(),s.x(u(n)).update(),l.show(),s.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),s.hide()}),o.width(c).height(h).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+o.id+")"),n.update(),i.update(),o.update(),e.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy,e=i.colorMap,o=[];for(var n in e)o.push({name:n,color:e[n]});t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.name===e.name&&(t.active=!n)}),i.states[e.name]=!n,t.onDataChange()})}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.xScale,i=t.widthOfNoMargin,o=t.heightOfMainGroup;n.domain(t._xDomain).range([0,i]),e.scaleFunc(n).allowedMaxTextHeight(.3*o).type(t._xType).orient(t._xOrient).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),e.compute(),e.translate(0,o-e.height).update()}},{key:"computeDomain",value:function(){this.xDomain(this.activeData.dataForStack.map(function(t){return t.name}))}},{key:"sortData",value:function(){var t=this._data,e={};t.keys.forEach(function(t){return e[t]=!0}),t.states||(t.states=e),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new _e(t,e);return n.dataSolveFunc(fe),n}},{key:"activeData",get:function(){var e=this.sortedDataCopy,t=e.keys.filter(function(t){return!1!==e.states[t]}),n=d3.stack().keys(t).order(d3.stackOrderNone).offset(d3.stackOffsetWiggle)(e.dataForStack);return{states:e.states,keys:t,stackData:n,colorMap:e.colorMap,dataForStack:e.dataForStack}}}])}(),function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radar"),e._radius=200,e._donutCount=5,e._fillOpacity=.35,e._strokeWidth=2,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._circleRadius=3,e._tickTextColor="#333",e._tickTextSize=10,e}return c(n,T),a(n,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;if(e.length){var o=t._radius,i=t._donutCount,r=t._fontSize,a=e[0].data.map(function(t){return t.name}),l=a.length,s=d3.max(e,function(t){return d3.max(t.data,function(t){return t.value})});if(s<=1)s=1;else{var u=.5*Math.pow(10,Math.floor(Math.log10(s)));s=Math.ceil(s/u)*u}var c=d3.range(i+1).map(function(t){return s/i*t}),h=d3.scaleLinear().domain([0,s]).range([0,o]),d=d3.scaleLinear().domain([0,l]).range([0,2*Math.PI]),_=d3.areaRadial().angle(function(t,e){return d(e)}).outerRadius(function(t){return h(t.value)}).curve(d3.curveCardinalClosed),f=n.selectAll(".tick-text").data(c);f.exit().remove(),f.enter().append("text").attr("class","tick-text").merge(f).attr("x",4).attr("y",function(t,e){return-o/i*e}).attr("dy","0.35em").style("font-size",t._tickTextSize).style("fill",t._tickTextColor).text(function(t){return t});var p=n.selectAll(".radar-group").data(e,function(t){return t.key});p.exit().remove();var y=p.enter().append("g").attr("class","radar-group");y.append("path").attr("class","radar-area"),y.append("g").attr("class","radar-points");var v=y.merge(p).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);v.select(".radar-area").attr("d",function(t){return _(t.data)}).style("fill",function(t){return t.color}).style("fill-opacity",t._fillOpacity).style("stroke",function(t){return t.color}).style("stroke-width",t._strokeWidth);var g=v.select(".radar-points").selectAll("circle").data(function(e){return e.data.map(function(t){return t.color=e.color,t})});g.exit().remove(),g.enter().append("circle").merge(g).attr("r",t._circleRadius).attr("cx",function(t,e){return h(t.value)*Math.cos(d(e)-Math.PI/2)}).attr("cy",function(t,e){return h(t.value)*Math.sin(d(e)-Math.PI/2)}).style("fill",function(t){return t.color});var m=n.selectAll(".radar-text").data(a);return m.exit().remove(),m.enter().append("text").attr("class","radar-text").merge(m).attr("dy","0.35em").each(function(t,e){var n=d(e),i=o+r;d3.select(this).attr("x",function(){return i*Math.cos(n-Math.PI/2)}).attr("y",function(){return i*Math.sin(n-Math.PI/2)}).style("text-anchor",function(){return n%Math.PI?n<Math.PI?"start":"end":"middle"})}).style("font-size",r).style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t){return t}),t}n.selectAll("*").remove()}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"tickTextColor",value:function(t){return arguments.length?(this._tickTextColor=t,this):this._tickTextColor}},{key:"tickTextSize",value:function(t){return arguments.length?(this._tickTextSize=t,this):this._tickTextSize}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}}]),n}()),ve=(function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radar-chart"),e.grid=new Q(e.mainGroup),e.radar=new ye(e.mainGroup),e._sortValue=-1,e._donutCount=5,e}c(n,q),a(n,[{key:"updateCore",value:function(){var t=this,e=t.activeData,n=t.radar,i=t.grid,o=t.tooltip,r=t._fontSize,a=t.widthOfNoMargin,l=t.heightOfMainGroup,s=Math.min(a-12*r,l-4*r)/2;n.data(e).radius(s).donutCount(t._donutCount).fillOpacity(.35).fontSize(t._fontSize).fontFamily(t._fontFamily).fontColor(t._fontColor).tickTextColor(t._fontColor).translate(a/2,l/2).onMouseover(function(t){d3.select(this.parentNode).selectAll(".radar-area").transition().style("fill-opacity",.1),d3.select(this).select(".radar-area").transition().style("fill-opacity",.7);var e=[{color:t.color,text:t.name}];t.data.forEach(function(t){e.push({text:t.name+""+t.value})}),o.data(e).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(){d3.select(this.parentNode).transition().selectAll(".radar-area").style("fill-opacity",.35),o.hide()}),i.radius(s).donutCount(t._donutCount).sectorCount(e[0]?e[0].data.length:1).translate(a/2,l/2).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY),n.update(),i.update()}}])}(),function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=function(t){var e=[],n={};t.forEach(function(t){t.children.forEach(function(t){var e=t.name;n[e]?n[e]++:n[e]=0})});var i=0;for(var o in n)e.push({name:o,count:n[o],index:i}),i++;return e.sort(function(t,e){return e.count-t.count||t.index-e.index}),e.slice(0,2).map(function(t){return t.name})}(t.nodes),n=this.generateColorList(e.length),i={};return e.forEach(function(t,e){return i[t]=n[e]}),t.colorMap=i,t.keys=e,t}}]),n}());var ge=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pyramid"),e._xScale=null,e._yScale=null,e._stroke="#fff",e}return c(n,T),a(n,[{key:"update",value:function(){var t,e,n,i=this,o=i.group,r=i._data,a=r.nodes,l=r.colorMap,s=r.keys,u=i._xScale,c=i._yScale,h=Math.abs(u.range()[1]-u.range()[0]),d=h/2,_=c.bandwidth(),f=s[0],p=l[f],y=s[1],v=l[y],g=[],m=[];return a.forEach(function(t){var e=t.children.filter(function(t){return t.name===f})[0],n=t.children.filter(function(t){return t.name===y})[0];g.push({name:t.name,key:t.key,color:p,value:e&&Math.abs(e.value)||0}),m.push({name:t.name,key:t.key,color:v,value:n&&Math.abs(n.value)||0})}),(t=(o.select(".left-group").empty()?o.append("g").attr("class","left-group"):o.select(".left-group")).selectAll("rect").data(g,function(t){return t.key})).exit().remove(),t.enter().append("rect").merge(t).attr("x",function(t){return u(-t.value)}).attr("y",function(t){return c(t.name)}).attr("width",function(t){return d-u(-t.value)}).attr("height",_).style("fill",p).style("stroke",i._stroke),(e=(o.select(".right-group").empty()?o.append("g").attr("class","right-group"):o.select(".right-group")).selectAll("rect").data(g,function(t){return t.key})).exit().remove(),e.enter().append("rect").merge(e).attr("x",d).attr("y",function(t){return c(t.name)}).attr("width",function(t){return u(t.value)-d}).attr("height",_).style("fill",v).style("stroke",i._stroke),(n=(o.select(".overlay-group").empty()?o.append("g").attr("class","overlay-group"):o.select(".overlay-group")).selectAll("rect").data(a,function(t){return t.key})).exit().remove(),n.enter().append("rect").merge(n).attr("x",0).attr("y",function(t){return c(t.name)}).attr("width",h).attr("height",_).style("fill","#fff").style("stroke","none").style("fill-opacity",0).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout),i}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}}]),n}();!function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pyramid-chart"),e.grid=new vt(e.coreGroup),e.core=new ge(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._marginLeft=15,e._marginRight=20,e._xType="number",e._yType="category",e._yTitle="y",e._xTitle="x",e}c(n,ut),a(n,[{key:"updateCore",value:function(){var e=this,t=e.core,n=e.tooltip,i=e.grid,o=e.activeData,r=o.colorMap,a=e.widthOfCore,l=e.heightOfCore;t.data(o).xScale(e.xScale).yScale(e.yScale).onMouseover(function(t){d3.select(this).style("fill-opacity",.8);var e=[{text:t.name}];t.children.forEach(function(t){t.name in r&&e.push({color:r[t.name],text:t.name+""+t.value})}),n.data(e).update().show()}).onMousemove(function(){n.move()}).onMouseout(function(){d3.select(this).style("fill-opacity",0),n.hide()}),i.width(a).height(l).xTickLocations(e.xAxis.tickLocations.slice()).yTickLocations(e.yAxis.tickLocations.slice().map(function(t){return t+e.yScale.bandwidth()/2})).showX(e._gridShowX).showY(e._gridShowY).stroke(e._gridStroke).strokeDasharray(e._gridStrokeDasharray),e.coreGroup.call(E,e.yAxis.width+.5,e.yAxis.titleHeight),i.update(),t.update()}},{key:"configLegend",value:function(){var t=this._sortedDataCopy,e=[];for(var n in t.colorMap)e.push({name:n,color:t.colorMap[n]});this.legend.data(e)}},{key:"computeDomain",value:function(){var t=this._data.nodes,e=d3.max(t,function(t){return d3.max(t.children,function(t){return Math.abs(t.value)})});this._xDomain=[-e,e],this._yDomain=t.length?t.map(function(t){return t.name}):[0,1],this.xAxis.tickFormat(function(t){return Math.abs(t)})}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new ve(t,e);return n.dataSolveFunc(Jt),n}},{key:"activeData",get:function(){return this._sortedDataCopy}}])}();function me(t,e){t.on("mouseover",e._onMouseover).on("mousemove",e._onMousemove).on("mouseout",e._onMouseout)}var xe=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bar-plot"),e._xScale=null,e._yScale=null,e._fill=null,e._stroke="#fff",e._strokeWidth=1,e._showZeroLine=!0,e._zeroLineStroke="#000",e._fontColor="#000",e._fontSize=13,e._cornerRadius=0,e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._xScale,i=e._yScale.clamp(!0),o=n.bandwidth(),r=i.domain(),a=r.every(function(t){return 0<=t})?"up":r.every(function(t){return t<=0})?"down":"both",l=i.range()[0],s=e._transition?e._duration:0,u=e.group,c=u.selectAll(".rect").data(t);c.exit().transition().duration(s).remove();var h=c.enter().append("path").attr("class","rect").merge(c).style("fill",function(t){return e._fill||t.color}).style("stroke-width",e._strokeWidth).style("stroke",e._stroke).call(me,e),d=u.selectAll("text").data(t);d.exit().transition().duration(s).remove();var _=d.enter().append("text").attr("class","simple-bar-texts").merge(d).text(function(t){return t.value}).attr("fill",e._fontColor).attr("font-size",e._fontSize);if("up"===a)h.attr("d",function(t){return p({x:n(t.name),y:i(t.value),width:o,height:Math.abs(l-i(t.value)),cornerRadius:e._cornerRadius})}),_.attr("x",function(t){return n(t.name)}).attr("y",function(t){return i(t.value)}).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?Math.abs(l-i(t.value))-6:void 0}).attr("text-anchor","middle");else if("down"===a)h.attr("d",function(t){return p({x:n(t.name),y:0,width:o,height:i(t.value),cornerRadius:e._cornerRadius})}),_.attr("x",function(t){return n(t.name)}).attr("y",0).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?i(t.value)-6:void 0}).attr("text-anchor","middle");else{var f=Math.round(i(0));h.attr("d",function(t){return p({x:n(t.name),y:0<=t.value?i(t.value):f,width:o,height:Math.abs(f-i(t.value)),cornerRadius:e._cornerRadius})}),_.attr("x",function(t){return n(t.name)}).attr("y",function(t){return 0<=t.value?i(t.value):f}).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?Math.abs(f-i(t.value))-6:void 0}).attr("text-anchor","middle"),(u.select(".zero-line").empty()?u.append("line").attr("class","zero-line"):u.select(".zero-line")).attr("x1",n.range()[0]).attr("y1",f).attr("x2",n.range()[1]).attr("y2",f).style("stroke",e._showZeroLine?e._zeroLineStroke:"none")}return e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}}]),n}(),ke=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("rect").attr("class","overlay-rect"),e._width=0,e._height=0,e._onMouseover=function(){},e._onMousemove=function(){},e._onMouseout=function(){},e}return c(n,l),a(n,[{key:"update",value:function(){return this.elem.attr("x",0).attr("y",0).attr("width",this._width).attr("height",this._height).style("fill","#000").style("opacity",0).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),this}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Se=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","multiple-bar"),e.overlay=new ke(e.group),e._width=400,e._height=400,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._zeroLineStroke="#000",e._gapPadding=5,e._allowedMaxTextWidth=100,e._xScale=d3.scaleBand(),e._yScale=d3.scaleLinear(),e._mainLeft=0,e._mainWidth=0,e}return c(n,T),a(n,[{key:"update",value:function(){var r=this,t=r._data;if(!t.length)return r;var e,n=r._width,i=r._height,a=r._fontSize,l=r._fontFamily,s=r._gapPadding,u=i/t.length,o=d3.max(t,function(t){return d3.max(t.data,function(t){return Math.abs(t.value)})}),c=d3.max(t,function(t){return H(t.name,a,l)}),h=c>r._allowedMaxTextWidth,d=Math.min(c,r._allowedMaxTextWidth)+r._gapPadding,_=1.25*a+r._gapPadding,f=n-d-_,p=r._xScale.domain(t[0].data.map(function(t){return t.name})).range([0,f]),y=r._yScale.domain([-o,o]).range([u,0]);return(e=r.group.selectAll(".bar-plot-group").data(t,function(t){return t.key})).exit().remove(),e.enter().append("g").attr("class","bar-plot-group").merge(e).style("font-size",a+"px").style("font-family",l).each(function(t){var e=d3.select(this),n=e.property("bar-plot")||new xe(e);e.property("bar-plot",n);var i=e.select(".left-text").empty()?e.append("text").attr("class","left-text"):e.select(".left-text"),o=e.select(".right-text").empty()?e.append("text").attr("class","right-text"):e.select(".right-text");i.attr("x",-s).attr("y",u/2).attr("dy","0.35em").style("text-anchor","end").style("fill",r._fontColor).text(function(t){return h?I(t.name,d,a,l):t.name}),o.attr("x",f+s).attr("y",u/2).attr("dy","0.35em").style("text-anchor","start").style("fill",r._fontColor).text("0"),n.data(t.data).xScale(p).yScale(y).fill(t.color).showZeroLine(!0).zeroLineStroke(r._zeroLineStroke).transition(r._transition).duration(r._duration),n.update()}).attr("transform",function(t,e){return"translate("+d+", "+u*e+")"}),r.overlay.elem.raise(),r.overlay.width(f).height(i).translate(d,0).onMouseover(r._onMouseover).onMousemove(r._onMousemove).onMouseout(r._onMouseout).update(),r._mainLeft=d,r._mainWidth=f,r}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"xScale",get:function(){return this._xScale}},{key:"yScale",get:function(){return this._yScale}},{key:"mainLeft",get:function(){return this._mainLeft}},{key:"mainWidth",get:function(){return this._mainWidth}}]),n}(),we=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","multiple-bar-chart"),e.core=new Se(e.coreGroup),e.overlay=new gt(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.xAxis=new rt(e.mainGroup),e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var r=this.activeData,a=this.core,l=this.tooltip,t=this.overlay,s=this.guideLine,e=this.widthOfCore,n=this.heightOfCore,u=a.xScale;s.y1(0).y2(n),a.data(r).width(e).height(n).zeroLineStroke(this._axisLineStroke).allowedMaxTextWidth(e/5).update(),t.data(u.domain()).bandWidth(u.step()).bandHeight(n).isScalePoint(!1).translate(a.mainLeft,0).onMouseover(function(t,e){var i=t,n=u.step(),o=[{text:i}];r.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});o.push({text:t.name+": "+n[0].value,color:t.color})}),l.data(o).update(),s.x(u(i)+a.mainLeft+n/2).update(),l.show(),s.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),s.hide()}),t.update()}},{key:"updateAxis",value:function(){var t=this.xAxis;t.scaleFunc(d3.scaleLinear().range([0,this.widthOfNoMargin])).title(this._xTitle).fontSize(this._fontSize).fontColor(this._fontColor).fontFamily(this._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),t.translate(0,this.heightOfMainGroup-t.height).update()}}]),n}(),be=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bubble-plot"),e._radius=function(){},e._cx=function(){},e._cy=function(){},e._fill=null,e._stroke=null,e._strokeWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group,i=e._transition?e._duration:0,o=n.selectAll("circle").data(t,function(t){return t.key});return o.exit().transition().duration(i).attr("r",0).remove(),o.enter().append("circle").merge(o).attr("cx",e._cx).attr("cy",e._cy).style("fill",function(t){return e._fill||t.color}).style("stroke",function(t){return e._stroke||t.color}).style("stroke",e._strokeWidth).on("mouseover",e._onMouseover).on("mousemove",e._onMousemove).on("mouseout",e._onMouseout).transition().duration(i).attr("r",e._radius),e}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"cx",value:function(t){return arguments.length?(this._cx=t,this):this._cx}},{key:"cy",value:function(t){return arguments.length?(this._cy=t,this):this._cy}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),Oe=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.categories,i=this.generateColorList(e.length),o={},r=[];return e.forEach(function(t,e){var n=i[e];o[t]=n,r.push({name:t,color:n})}),t.nodes.forEach(function(t){return t.color=o[t.category]}),t.legendData=r,t}}]),n}();function Ce(t,e){var s=0,u=1,c=2,h=3,d=4;if(e.forEach(function(t){"typeCol"===t.function?s=t.index:"objCol"===t.function?u=t.index:"X"===t.name?c=t.index:"Y"===t.name?h=t.index:""===t.name&&(d=t.index)}),m(t,[s,u,c,h,d])||!O(t,c)||!O(t,h)||!O(t,d))return{categories:[],nodes:[],labels:[]};var _=[],f=[],p={};t.slice(1).forEach(function(t,e){var n=t[s],i=t[u],o=t[c],r=t[h],a=t[d],l=n+"-"+i+"-"+e;p[n]||(p[n]=n,_.push(n)),f.push({category:n,name:i,x:o,y:r,radius:a,key:l})});var n=t[0],i={category:n[s],name:n[u],x:n[c],y:n[h],radius:n[d]};return{categories:_,nodes:f,labels:i}}var Ae=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouping-bubble-chart"),e.clipArea=new ft(e.defs),e.grid=new vt(e.coreGroup),e.core=new be(e.coreGroup),e.xAxis=new rt(e.mainGroup).tickFormat(function(t){return t}),e.yAxis=new st(e.mainGroup),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleLinear(),e._xType="number",e._yType="number",e._sortValue=-1,e._maxRadius=15,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var t=this,e=t.core,n=t.tooltip,i=t.grid,o=t.clipArea,r=t.activeData,a=r.nodes,l=r.labels,s=t.widthOfCore,u=t.heightOfCore,c=t.xScale,h=t.yScale,d=t._maxRadius,_=d3.max(a,function(t){return Math.abs(t.radius)}),f=d3.scaleSqrt().domain([0,_]).range([0,d]);e.data(a).cx(function(t){return c(t.x)}).cy(function(t){return h(t.y)}).radius(function(t){return f(Math.abs(t.radius))}).stroke("#fff").transition(t._transition).duration(t._duration).onMouseover(function(t){d3.select(this).style("stroke","#000");var e=[{color:t.color,text:l.category+""+t.category},{text:l.name+""+t.name},{text:l.x+""+t.x},{text:l.y+""+t.y},{text:l.radius+""+t.radius}];n.data(e).update().show()}).onMousemove(function(){n.move()}).onMouseout(function(){d3.select(this).style("stroke","#fff"),n.hide()}),i.width(s).height(u).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),o.width(s).height(u).paddingVertical([d,0]).paddingHorizontal([d,d]),t.coreGroup.call(E,t.yAxis.width+.5,t.yAxis.titleHeight).attr("clip-path","url(#"+o.id+")"),e.update(),i.update(),o.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy,o=i.legendData;t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.name===e.name&&(t.active=!n)}),i.nodes.forEach(function(t){t.category===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"computeDomain",value:function(){var t=this.activeData.nodes,e=(this._xDomain||[]).slice().sort(d3.ascending),n=(this._yDomain||[]).slice().sort(d3.ascending),i=d3.extent(t,function(t){return t.x}),o=d3.extent(t,function(t){return t.y}),r=isNaN(parseFloat(e[0]))?Math.min(0,i[0]||0):parseFloat(e[0]),a=isNaN(parseFloat(e[1]))?Math.max(1,i[1]||0):parseFloat(e[1]),l=isNaN(parseFloat(n[0]))?Math.min(0,o[0]||0):parseFloat(n[0]),s=isNaN(parseFloat(n[1]))?Math.max(1,o[1]||0):parseFloat(n[1]);this._xDomain=[r,a],this._yDomain=[l,s]}},{key:"sortData",value:function(){var t=this._data;-1===this._sortValue?t.nodes.sort(function(t,e){return e.radius-t.radius||t.index-e.index}):1===this._sortValue&&t.nodes.sort(function(t,e){return t.radius-e.radius||t.index-e.index}),this._sortedDataCopy=t}},{key:"buildOption",value:function(t,e){var n=new Oe(t,e);return n.dataSolveFunc(Ce),n}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{nodes:t.nodes.filter(function(t){return!1!==t.active}),labels:t.labels}}}]),n}(),Me=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.minValue,n=t.maxValue,i=t.data,o=this.generateColorList(),r=o.length,a=(n-e)/(r-1),l=d3.range(r).map(function(t){return e+a*t}),s=d3.scaleLinear().domain(l).range(o);return i.forEach(function(t){t.nodes.forEach(function(t){return t.color=s(t.value)})}),t.colorScale=s,t}}]),n}();function Fe(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),m(t,[n,i])||!O(t,i))return{data:[],minValue:0,maxValue:0,dateLabel:"",valueLabel:""};for(var o={},r=/^\d{1,4}(\-|\/)\d{1,2}(\-|\/)\d{1,2}$/,a=1,l=t.length;a<l;a++){var s=t[a],u=s[n],c=parseFloat(s[i]);if(r.test(u)&&!isNaN(c)&&"Invalid Date"!==new Date(u)){u=y(u);var h=new Date(u),d=h.getFullYear();o[d]||(o[d]=[]),o[d].push({date:h,dateString:u,value:c})}}var _=[];for(var f in o)_.push({year:parseInt(f),nodes:o[f]});var p=d3.max(_,function(t){return d3.max(t.nodes,function(t){return t.value})});return{data:_,minValue:d3.min(_,function(t){return d3.min(t.nodes,function(t){return t.value})}),maxValue:p,dateLabel:t[0][n],valueLabel:t[0][i]}}var Re=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","calendar-heatmap"),e._cellSize=20,e._cellFill="#fff",e._cellStroke="#ccc",e._monthStroke="#000",e}return c(n,T),a(n,[{key:"update",value:function(){var t,e,n,i=this,o=i._data,r=parseInt(o.year),a=o.nodes,l=i._cellSize,s=i.group;function u(t){var e=new Date(t.getFullYear(),t.getMonth()+1,0),n=t.getDay(),i=d3.timeWeek.count(d3.timeYear(t),t),o=e.getDay(),r=d3.timeWeek.count(d3.timeYear(e),e);return"M"+(i+1)*l+","+n*l+"H"+i*l+"V"+7*l+"H"+r*l+"V"+(o+1)*l+"H"+(r+1)*l+"V0H"+(i+1)*l+"Z"}(t=(s.select(".bottom-group").empty()?s.append("g").attr("class","bottom-group"):s.select(".bottom-group")).selectAll(".bottom-rect").data(function(){return d3.timeDays(new Date(r,0,1),new Date(r+1,0,1))})).exit().remove(),t.enter().append("rect").attr("class","bottom-rect").merge(t).attr("x",function(t){return d3.timeWeek.count(d3.timeYear(t),t)*l}).attr("y",function(t){return t.getDay()*l}).attr("width",l).attr("height",l).style("fill",i._cellFill).style("stroke",i._cellStroke).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout),(e=(s.select(".active-group").empty()?s.append("g").attr("class","active-group"):s.select(".active-group")).selectAll(".color-rect").data(a,function(t){return t.date})).exit().remove(),e.enter().append("rect").attr("class","color-rect").merge(e).attr("x",function(t){return d3.timeWeek.count(d3.timeYear(t.date),t.date)*l}).attr("y",function(t){return t.date.getDay()*l}).attr("width",l).attr("height",l).style("fill",function(t){return t.color}).style("stroke",i._cellStroke).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout),(n=(s.select(".month-group").empty()?s.append("g").attr("class","month-group"):s.select(".month-group")).selectAll(".month-path").data(function(){return d3.timeMonths(new Date(r,0,1),new Date(r+1,0,1))})).exit().remove(),n.enter().append("path").attr("class","month-path").merge(n).style("fill","none").style("stroke",i._monthStroke).attr("d",u)}},{key:"cellSize",value:function(t){return arguments.length?(this._cellSize=t,this):this._cellSize}},{key:"cellFill",value:function(t){return arguments.length?(this._cellFill=t,this):this._cellFill}},{key:"cellStroke",value:function(t){return arguments.length?(this._cellStroke=t,this):this._cellStroke}},{key:"monthStroke",value:function(t){return arguments.length?(this._monthStroke=t,this):this._monthStroke}}]),n}(),We=function(){function e(t){r(this,e),this.id=i(""),this.elem=t.append("linearGradient").attr("id",this.id),this._colorList=[],this._offsetList=[]}return a(e,[{key:"update",value:function(){var t=this.elem,e=this._colorList,n=this._offsetList||[],i=e.length;if(n.length!==i){var o=1/(i-1);n=d3.range(i).map(function(t){return o*t})}var r=t.selectAll("stop").data(e);return r.exit().remove(),r.enter().append("stop").merge(r).attr("offset",function(t,e){return n[e]}).attr("stop-color",function(t){return t}),this}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"offsetList",value:function(t){return arguments.length?(this._offsetList=t,this):this._offsetList}}]),e}(),ze=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","gradient-legend"),e.group=e.elem.append("g"),e.defs=e.elem.append("defs"),e.gradient=new We(e.defs),e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._rectWidth=100,e._rectHeight=30,e._colorList=[],e._startText=0,e._endText=1,e._paddingHor=3,e._paddingVer=5,e._limitedWidth=400,e._horizontalAlign="center",e._title="title",e}return c(n,l),a(n,[{key:"update",value:function(){var t=this,e=t.gradient,n=t._rectWidth,i=t._rectHeight,o=t.group.style("font-size",t._fontSize+"px").style("font-family",t._fontFamily),r=o.select("rect").empty()?o.append("rect"):o.select("rect"),a=o.select(".start-text").empty()?o.append("text").attr("class","start-text"):o.select(".start-text"),l=o.select(".end-text").empty()?o.append("text").attr("class","end-text"):o.select(".end-text"),s=o.select(".legend-title").empty()?o.append("text").attr("class","legend-title"):o.select(".legend-title");e.colorList(t._colorList).update(),r.attr("x",0).attr("y",0).attr("width",n).attr("height",i).style("fill","url(#"+t.gradient.id+")"),s.attr("x",n/2).attr("y",i+t._paddingVer).attr("dy","1em").style("text-anchor","middle").text(t._title),a.attr("x",-t._paddingHor).attr("y",i/2).attr("dy","0.35em").style("text-anchor","end").style("fill",t._fontColor).text(t._startText),l.attr("x",n+t._paddingHor).attr("y",i/2).attr("dy","0.35em").style("text-anchor","start").style("fill",t._fontColor).text(t._endText);var u=t._horizontalAlign;return"left"===u?o.call(E,H(this._startText,t._fontSize,t._fontFamily),0):"right"===u?o.call(E,t._limitedWidth-n-H(this._endText,t._fontSize,t._fontFamily),0):o.call(E,t._limitedWidth/2-n/2,0),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"rectWidth",value:function(t){return arguments.length?(this._rectWidth=t,this):this._rectWidth}},{key:"rectHeight",value:function(t){return arguments.length?(this._rectHeight=t,this):this._rectHeight}},{key:"paddingHor",value:function(t){return arguments.length?(this._paddingHor=t,this):this._paddingHor}},{key:"paddingVer",value:function(t){return arguments.length?(this._paddingVer=t,this):this._paddingVer}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"startText",value:function(t){return arguments.length?(this._startText=t,this):this._startText}},{key:"endText",value:function(t){return arguments.length?(this._endText=t,this):this._endText}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}}]),n}(),Le=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","calendar-heatmap-chart"),e.legend=new ze(e.group),e.xAxis=new rt(e.mainGroup),e._sortValue=1,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var i=this,t=i.activeData,e=t.data,o=t.valueLabel,r=i.tooltip,n=i.widthOfCore,a=i.heightOfCore/e.length,l=Math.min(a/7,n/56),s=i._gridShowX||i._gridShowY?i._gridStroke:"none",u=i._xTickShow?i._axisLineStroke:"none",c=53*l,h=7*l,d=d3.timeFormat("%Y-%m-%d"),_=i.coreGroup.selectAll(".year-group").data(e,function(t){return t.year});_.exit().remove(),_.enter().append("g").attr("class","year-group").merge(_).attr("transform",function(t,e){return"translate("+(n-c)/2+", "+(a*e+(a-h)/2)+")"}).each(function(t){var e=d3.select(this),n=e.property("calendar")||new Re(e);e.property("calendar",n),n.data(t).cellSize(l).cellStroke(s).monthStroke(u).onMouseover(function(t){var e=[];e=t instanceof Date?[{text:d(t)}]:[{text:t.dateString,color:t.color},{text:o+""+t.value}],d3.select(this).raise().style("stroke","#000"),r.data(e).update().show()}).onMousemove(function(){r.move()}).onMouseout(function(){d3.select(this).style("stroke",s),r.hide()}),n.update(),(e.select("text").empty()?e.append("text"):e.select("text")).attr("transform","translate(-6, "+h/2+")rotate(-90)").style("font-size",i._fontSize).style("font-family",i._fontFamily).style("fill",i._fontColor).style("text-anchor","middle").text(t.year)})}},{key:"updateLegend",value:function(){var t=this.legend,e=this.widthOfNoMargin;if(!this._legendShow)return t.hide();t.show(),t.limitedWidth(e).horizontalAlign(this._legendX).rectWidth(e/5).rectHeight(e/5/10).fontSize(this._fontSize).fontFamily(this._fontFamily).fontColor(this._fontColor),this.configLegend(),t.update()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy;this.legend.colorList(t.colorScale.range()).startText(t.minValue).endText(t.maxValue).title(t.valueLabel)}},{key:"updateAxis",value:function(){var t=this.xAxis;t.scaleFunc(d3.scaleLinear().range([0,this.widthOfNoMargin])).title(this._xTitle).fontSize(this._fontSize).fontColor(this._fontColor).fontFamily(this._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),t.translate(0,this.heightOfMainGroup-t.height).update()}},{key:"computeDomain",value:function(){}},{key:"sortData",value:function(){var t=this._data.data;1===this._sortValue?t.sort(function(t,e){return t.year-e.year}):-1===this._sortValue&&t.sort(function(t,e){return e.year-t.year}),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new Me(t,e);return n.dataSolveFunc(Fe),n}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{data:t.data,valueLabel:t.valueLabel}}}]),n}(),Te=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rect-plot"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group.selectAll("rect").data(t,function(t){return t.key});n.exit().remove();var i=n.enter().append("g"),o=i.append("rect").merge(n).style("fill",function(t){return e._fillColor||t.color}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return e._strokeColor||t.color}).style("stroke-width",function(t){return e._strokeWidth||0});return this._rectObj?(o.attr("x",e._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj&&i.append("text").merge(n).text(this._textObj.textFunc).attr("fill",this._textObj.colorFunc).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc),o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"updateChangeWaterfall",value:function(){var e=this,t=e._data,n=e.group;d3.select(".change-rects").remove();var i=n.append("g").attr("class","change-rects").selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("rect").merge(i).style("fill",function(t){return 0<t.value?e._fillColor||t.color:e._fillColor||t.color_special}).style("fill-opacity",function(t){return e._fillOpacity}).style("rx",e._barCornerRadius).style("ry",e._barCornerRadius).style("stroke",function(t){return 0<t.value?e._borderColor||t.color:e._borderColor||t.color_special}).style("stroke-width",function(t){return e._borderWidth||0});if(this._rectObj?(o.attr("x",this._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){d3.select(".change-texts").remove();var r=n.append("g").attr("class","change-texts").selectAll("text").data(t,function(t){return t.key});r.exit().remove();r.enter().append("text").merge(r).text(this._textObj.textFunc).attr("fill",this._textObj.colorFunc).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("font-size",this._textObj.fontSize).style("display",this._textObj.labelShow?"block":"none");null!=e._labelShow&&null!=e._positionOptions&&null!=e._positionChoice||d3.selectAll(".change-texts text").style("display","none")}return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"updateFormWaterfall",value:function(){var e=this,t=e._data,n=e.group;d3.select(".form-rects").remove();var i=n.append("g").attr("class","form-rects").selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("rect").merge(i).style("fill",function(t){return 0<t.value?e._fillColor||t.color:e._fillColor||t.color_special}).style("fill-opacity",function(t){return e._fillOpacity}).style("rx",e._barCornerRadius).style("ry",e._barCornerRadius).style("stroke",function(t){return 0<t.value?e._borderColor||t.color:e._borderColor||t.color_special}).style("stroke-width",function(t){return e._borderWidth||0});if(this._rectObj?(o.attr("x",this._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){d3.select(".form-texts").remove();var r=n.append("g").attr("class","form-texts").selectAll("text").data(t,function(t){return t.key});r.exit().remove();r.enter().append("text").merge(r).text(this._textObj.textFunc).attr("fill",this._textObj.colorFunc).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("font-size",this._textObj.fontSize).style("display",this._textObj.labelShow?"block":"none");null!=e._labelShow&&null!=e._positionOptions&&null!=e._positionChoice||d3.selectAll(".form-texts text").style("display","none")}return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"updateHorizontalBar",value:function(){var n=this,t=n._data,e=n.group;d3.select(".horizontal-bar-rects").remove();var i=e.append("g").attr("class","horizontal-bar-rects").selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("rect").merge(i).style("fill",function(t){return n._fillColor||t.color}).style("fill-opacity",function(t){return n._fillOpacity}).style("stroke",function(t){return n._borderColor||n._strokeColor||t.color}).style("stroke-width",function(t){return n._borderWidth||n._strokeWidth||0}).style("fill-opacity",function(t){return n._fillOpacity}).style("rx",n._barCornerRadius).style("ry",n._barCornerRadius);if(this._rectObj?(o.attr("x",this._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){d3.select(".horizontal-bar-texts").remove();var r=e.append("g").attr("class","horizontal-bar-texts").selectAll("text").data(t,function(t){return t.key});r.exit().remove();r.enter().append("text").attr("class","horizontal-bar-text").merge(i).text(this._textObj.textFunc).attr("fill",this._textObj.colorFunc).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dy",this._textObj.dyFunc).attr("dx",function(t,e){return null==n._labelShow||null==n._positionOptions||null==n._positionChoice?0:0==n._positionOptions.indexOf(n._positionChoice)?.2*n._fontSize:1==n._positionOptions.indexOf(n._positionChoice)?-n._xScale(t.value)+.3*n._fontSize:2==n._positionOptions.indexOf(n._positionChoice)?.3*-n._fontSize-k(d3.select(d3.selectAll(".horizontal-bar-texts text").nodes()[e])).width:void 0}).style("display",this._textObj.labelShow?"block":"none");null!=n._labelShow&&null!=n._positionOptions&&null!=n._positionChoice||d3.selectAll(".horizontal-bar-texts text").style("display","none")}return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),n}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Pe=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t,n,e=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),i=this.generateColorList(e.length);return n=i,(t=e).forEach(function(e,t){e.color=n[t],e.color_special=n[t+1],e.data.forEach(function(t){t.color=e.color,t.color_special=e.color_special})}),t}}]),n}();function De(t,e){var n=t,i=0,o=0,r=0;if(e.forEach(function(t){"objCol"===t.function?(i=t.index,t.isLegend):"typeCol"===t.function?o=t.index:"vCol"===t.function&&(r=t.index)}),m(n,[i,o,r])||!O(n,r))return[];var a=[],l=[],s=n.slice(1);return s.forEach(function(t){-1==l.indexOf(t[i])&&l.push(t[i])}),l.forEach(function(t){a.push({name:t,data:[]})}),s.forEach(function(e){a.forEach(function(t){e[i]==t.name&&t.data.push({name:e[o],value:e[r]})})}),a.forEach(function(t,e){t.key=u(t.name)+"-"+e}),a}function je(t){var e=[];return t.forEach(function(t){t.data.forEach(function(t){e.push(t)})}),e}var Ge=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","hollow-chart"),e.rectPlot=new Te(e.coreGroup),e.grid=new vt(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var r=this,a=r.activeData,t=je(a),e=r.grid,n=r.rectPlot,l=r.tooltip,i=r.xScale,o=r.yScale,s=r.widthOfCore,u=r.heightOfCore,c=o.step();e.width(s).height(u).xTickLocations(r.xAxis.tickLocations.slice(1)).yTickLocations(r.yAxis.tickLocations.slice().map(function(t){return t+r.yScale.bandwidth()/2})).showX(r._gridShowX).showY(r._gridShowY).stroke(r._gridStroke).strokeDasharray(r._gridStrokeDasharray),n.data(t).xScale(i).yScale(o).fillColor("#fff").rectObj({xFunc:function(){return 0},yFunc:function(t,e){return r.yScale.range()[0]-(e*c+(c-.5*c)/2+.5*c)},widthFunc:function(t){return r.xScale(t.value)},heightFunc:function(t){return.5*c}}).onMousemove(function(n){var t=r.elem.node().parentNode,e=d3.mouse(t),i="";a.forEach(function(e){e.data.forEach(function(t){t==n&&(i=e.name)})});var o=[{text:i},{text:n.name+": "+n.value,color:n.color}];l.show(),l.data(o).update().move([e[0],e[1]])}).onMouseout(function(){l.hide()}),r.coreGroup.call(E,r.yAxis.width+.5,r.yAxis.titleHeight),n.update(),e.update()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,r=t._xType,a=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(r).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),o.domain(t._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(a).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var d=n?n.titleHeight:0;t.data().forEach(function(t){t.data.forEach(function(t){})});var _=t._tickCount?t._tickCount:(c-n.allowedMaxTextWidth())/(6*u);i.nice(),e.tickCount(_).compute(),o.range([h-d-e.height,0]),n.compute(),i.range([0,c-n.width]),e.compute();var f=n.width,p=h-e.height,y=n.width,v=d;e.translate(f,p).update(),n.translate(y,v).update()}},{key:"computeDomain",value:function(){var t=je(this.activeData),e=this._xDomain||[],n=t.length?t.map(function(t){return t.name}):[""],i=t.length?[Math.min(d3.min(t,function(t){return+t.value}),0),d3.max(t,function(t){return+t.value})]:[0,1];this._xDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])],this._yDomain=n}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=De;return n.dataSolveFunc(i),n}}]),n}(),Be=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._fill="#ffffff",e}return c(n,ht),a(n,[{key:"update",value:function(){var n=this,t=n.group,e=n._data,i=n._xScale,o=n._yScale,r=t.selectAll("g").data(e,function(t){return t.name});return r.exit().remove(),r.enter().append("g").merge(r).each(function(t){var e=d3.select(this).selectAll("circle").data(t.data);e.exit().remove(),e.enter().append("circle").attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.total)||0}).merge(e).style("fill",n._fill||t.color).style("stroke",n._stroke||t.color).style("stroke-width",n._strokeWidth).attr("r",n._radius).attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.total)||0})}),n}}]),n}(),Ne=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stacked-chart"),e.grid=new vt(e.coreGroup),e.areaPlot=new dt(e.coreGroup),e.linePlot=new mt(e.coreGroup),e.overlay=new ke(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.guideScatter=new Be(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e._curve=d3.curveCardinal,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){for(var s=this,u=s.activeData,t=s.grid,e=s.areaPlot,n=s.linePlot,c=s.guideScatter,h=s.tooltip,i=s.overlay,d=s.guideLine,o=s.clipArea,_=s.xScale,r=s.yScale,a=s.widthOfCore,l=s.heightOfCore,f=0;f<u.length;f++)for(var p=0;p<u[f].data.length;p++)u[f].data[p].value=parseFloat(u[f].data[p].value),u[f].data[p].total=0==f?parseFloat(u[f].data[p].value):u[f-1].data[p].total+parseFloat(u[f].data[p].value);t.width(a).height(l).xTickLocations(s.xAxis.tickLocations.slice(1)).yTickLocations(s.yAxis.tickLocations.slice(1)).showX(s._gridShowX).showY(s._gridShowY).stroke(s._gridStroke).strokeDasharray(s._gridStrokeDasharray),e.data(u).xScale(_).yScale(r).curve(s._curve).areaFunc(d3.area().x(function(t){return _(t.name)}).y0(function(t){return r(t.total-t.value)}).y1(function(t){return r(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),n.data(u).xScale(_).yScale(r).fontSize(s._fontSize).labelShow(s._labelShow).positionOptions(s._positionOptions).positionChoice(s._positionChoice).curve(s._curve).lineFunc(d3.line().x(function(t){return _(t.name)}).y(function(t){return r(t.total)}).defined(function(t){return!isNaN(parseFloat(t.total))})),c.data(u).xScale(_).yScale(r).fill("#fff"),d.y1(0).y2(l).strokeDasharray(s._gridStrokeDasharray),i.width(a).height(l).onMouseover(function(){h.show(),d.show(),c.show()}).onMousemove(function(){var t=s.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=_.step(),o=Math.floor(n/i)+(.5<=n%i/i?1:0),r=_.domain()[o],a=[{text:r}],l=[];u.forEach(function(t){var e=t.data.filter(function(t){return t.name===r});l.push({key:t.key,name:t.name,color:t.color,data:e}),a.push({text:t.name+": "+e[0].value,color:t.color})}),h.data(a).update().move([e[0]+_(r)-n,e[1]]),d.x(_(r)).update(),c.data(l).update()}).onMouseout(function(){h.hide(),d.hide(),c.hide()}),o.width(a).height(l).paddingVertical([0,0]).transition(s._transition).duration(s._duration),s.coreGroup.call(E,s.yAxis.width+.5,s.yAxis.titleHeight),0!=s._clipShow.length&&(s.coreGroup.attr("clip-path","url(#"+o.id+")"),o.update()),c.elem.style("pointer-events","none"),t.update(),i.update(),e.update(),n.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e.display?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice)}},{key:"buildOption",value:function(t,e){var n=new z(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)t[e].data[n].value=parseFloat(t[e].data[n].value),t[e].data[n].total=0==e?parseFloat(t[e].data[n].value):t[e-1].data[n].total+parseFloat(t[e].data[n].value);var i=(this._yDomain||[]).slice().sort(d3.ascending),o=t.length?t[0].data.map(function(t){return t.name}):[0,1],r=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})})]:[0,1];this._xDomain=o,this._yDomain=[isNaN(parseFloat(i[0]))?r[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?r[1]:parseFloat(i[1])]}}]),n}(),Ee=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("rect").attr("class","selectOverlay-rect"),e._width=0,e._height=0,e._shadowColor="#000",e}return c(n,l),a(n,[{key:"update",value:function(){return this.elem.attr("x",0).attr("y",0).attr("width",this._width).attr("height",this._height).style("fill",this._shadowColor).style("opacity",.15).style("transition","transform 0.15s"),this}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),n}(),He="legend-group",Ie=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","waterfalllegend"),e.group=e.elem.append("g"),e._data=[],e._shapeType="circle",e._shapeWidth=16,e._shapeHeight=16,e._shapeStroke="none",e._rowGap=6,e._colGap=20,e._innerGap=6,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._limitedWidth=400,e._horizontalAlign="center",e._onClick=function(){},e._each=function(){},e._orient="horizontal",e}return c(n,l),a(n,[{key:"update",value:function(){var r=this,a=r.group,l=Math.max(r._shapeHeight,r._fontSize),s=r._limitedWidth-r._shapeWidth-r._innerGap,u=0,c=0;r.elem.selectAll("."+He).remove();var h=a.append("g").attr("class",He),t={name:r._data[0].name,data:r._data[0].data,color:r._data[0].color,color_special:r._data[0].color_special,key:r._data[0].key,name1:""},e={name:r._data[0].name,data:r._data[0].data,color:r._data[0].color,color_special:r._data[0].color_special,key:r._data[0].key,name1:""},n=[];n.push(t),n.push(e),n.forEach(function(t,e){var n=I(t.name1,s,r._fontSize,r._fontFamily),i=r._shapeWidth+r._innerGap+H(n,r._fontSize,r._fontFamily);if("vertical"===r._orient)r._legendItem(t,h,0,c,e),c=c+l+r._rowGap;else{var o=u+i+r._colGap;o>r._limitedWidth&&(u=0,o=i+r._colGap,c+=l+r._rowGap,h=a.append("g").attr("class",He)),r._legendItem(t,h,u,c,e),u=o}});var i=k(a).width;return"center"===r._horizontalAlign?a.call(E,r._limitedWidth/2-i/2,0):"left"===r._horizontalAlign?a.call(E,0,0):"right"===r._horizontalAlign&&a.call(E,r._limitedWidth-i,0),r}},{key:"_shapeElem",value:function(t){var e=void 0;return(e="rect"===this._shapeType?t.append("rect").attr("width",this._shapeWidth).attr("height",this._shapeHeight):t.append("circle").attr("cx",this._shapeWidth/2).attr("cy",this._shapeHeight/2).attr("r",Math.min(this._shapeWidth,this._shapeHeight)/2)).attr("class","legend-shape"),e}},{key:"_legendItem",value:function(e,t,n,i,o){var r=t.append("g").datum(e).attr("class","legend-item").call(E,n,i).on("click",this._onClick).each(this._each);return this._shapeElem(r).style("fill",function(t){return 0==o?e.color:e.color_special}),r.append("text").attr("x",this._shapeWidth+this._innerGap).attr("y",this._shapeHeight/2).attr("dy","0.35em").style("text-anchor","start").style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("fill",this._fontColor).text(I(e.name1,this._limitedWidth-this._shapeWidth-this._innerGap,this._fontSize,this._fontFamily)),r}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}},{key:"shapeWidth",value:function(t){return arguments.length?(this._shapeWidth=t,this):this._shapeWidth}},{key:"shapeHeight",value:function(t){return arguments.length?(this._shapeHeight=t,this):this._shapeHeight}},{key:"rowGap",value:function(t){return arguments.length?(this._rowGap=t,this):this._rowGap}},{key:"colGap",value:function(t){return arguments.length?(this._colGap=t,this):this._colGap}},{key:"innerGap",value:function(t){return arguments.length?(this._innerGap=t,this):this._innerGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"onClick",value:function(t){return arguments.length?(this._onClick=t,this):this._onClick}},{key:"each",value:function(t){return arguments.length?(this._each=t,this):this._each}}]),n}();function Ve(t,e){var n=0,i=1;e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&(i=t.index)});var o={},r=[],a=t.length,l=t[0],s=l[i];o[s]={name:s,data:[]};for(var u=0,c=1;c<a;c++){var h=t[c],d=h[n];if(d){var _=l[i];1==c?u=parseInt(t[1][i]):u+=parseInt(t[c][i]),o[_].data.push({name:d,value:h[i],total:u})}}for(var f in o)r.push(o[f]);return r.forEach(function(t,e){t.key=t.name+"-"+e}),r}var Ye=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","change-water-fall-histogram-chart"),e.grid=new vt(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xAxis.minTickDistance(1),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=-1,e._curve=d3.curveCardinal,e.legend=new Ie(e.group),e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Te(e.coreGroup),e.overlay=new ke(e.coreGroup),e._histogramWidth=.7,e._yScaleHeight=1.05,e._marginTop=20,e.barWidthPercent=.7,e.barCornerRadius=0,e.borderWidth=0,e.borderColor=null,e.fillOpacity=1,e.labelShow=!0,e.positionOptions=["",""],e.positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var l=this,s=l.activeData,t=s.toString()?s[0].data:[],e=l.grid,u=l.tooltip,n=l.rectPlot,i=l.overlay,c=l.selectOverlay,o=l.barWidthPercent,h=l.xScale,r=l.yScale,a=l.widthOfCore,d=l.heightOfCore,_=d3.min(s,function(t){return d3.min(t.data,function(t){return+t.total})}),f=(d3.max(s,function(t){return d3.max(t.data,function(t){return+t.total})}),d3.min(s,function(t){return d3.min(t.data,function(t){return+t.value})}),s[0].data[0].value,l.widthOfNoMargin,l.heightOfMainGroup);l.yAxis.width,l.xAxis.height;_<0?(d3.selectAll(".change-water-fall-histogram-chart .axis-x path").attr("transform","translate(0, "+-(r.range()[0]-r(0))+")"),d3.selectAll(".change-water-fall-histogram-chart .axis-x line").attr("transform","translate(0, "+-(r.range()[0]-r(0))+")")):(d3.selectAll(".change-water-fall-histogram-chart .axis-x path").attr("transform","translate(0,0)"),d3.selectAll(".change-water-fall-histogram-chart .axis-x line").attr("transform","translate(0,0)")),i.width(a).height(d).onMouseover(function(){u.show(),c.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=h.step(),o=Math.floor(n/i),r=h.domain()[o],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),c.translate(h(r),0),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),c.hide()}),n.data(t).xScale(h).yScale(r).barCornerRadius(l.barCornerRadius).borderWidth(l.borderWidth).borderColor(l.borderColor).labelShow(l.labelShow).positionOptions(l.positionOptions).positionChoice(l.positionChoice).rectObj({xFunc:function(t,e){return h.step()*e+h.step()*(1-l._histogramWidth*o)/2},yFunc:function(t){return t.value<0?r(t.total-t.value):r(t.total)},widthFunc:function(){return h.step()*l._histogramWidth*o},heightFunc:function(t){return 0<_||0==_?Math.abs(r.range()[0]-r(Math.abs(t.value))):_<0?Math.abs(r(0)-r(Math.abs(t.value))):void 0}}).textObj({xFunc:function(t,e){return h.step()*e},yFunc:function(t){return t.value<0?r(t.total-t.value):r(t.total)},dxFunc:function(t,e){return 0<h.step()?(1-t.value.toString().length*l._fontSize/2/h.step())/2*h.step():0},dyFunc:function(t,e){return 0==l.positionOptions.indexOf(l.positionChoice)?.5*-l._fontSize:1==l.positionOptions.indexOf(l.positionChoice)?0<_?r.range()[0]-r(Math.abs(t.value))-.5*l._fontSize:r(0)-r(Math.abs(t.value))-.5*l._fontSize:void 0},colorFunc:function(){return l._fontColor},textFunc:function(t){return t.value},fontSize:l._fontSize,labelShow:l.labelShow}).fillOpacity(l.fillOpacity),e.width(a).height(d).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),c.width(h.step()).height(d).shadowColor(l._shadowColor).hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),n.updateChangeWaterfall(),c.update(),i.update();var p=l.yAxis.width;e.translate(p,l.yAxis.titleHeight).update()}},{key:"updateLegend",value:function(){var t=this.legend,e=this.widthOfNoMargin;if(!this._legendShow)return t.hide();t.show(),t.limitedWidth(e).fontSize(this._fontSize).fontFamily(this._fontFamily).fontColor(this._fontColor).horizontalAlign(this._legendX).each(function(t){var e=!1===t.active;d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}),this.configLegend(),t.update()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy;this.legend.data(t).onClick(function(t){})}},{key:"layout",value:function(){"bottom"===this._legendY?(this.mainGroup.call(E,0,0),this.legend.translate(0,this.heightOfNoMargin-this.legend.height())):(this.legend.translate(0,0),this.mainGroup.call(E,0,this._legendShow?this.legend.height()+this._gapPadding:0))}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this.barWidthPercent=e.barWidthPercent?e.barWidthPercent:this.barWidthPercent,this.barCornerRadius=e.barCornerRadius?e.barCornerRadius:this.barCornerRadius,this.borderWidth=e.borderWidth?e.borderWidth:this.borderWidth,this.borderColor=e.borderColor?e.borderColor:this.borderColor,this.fillOpacity=e.fillOpacity?e.fillOpacity:this.fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this.labelShow=n?n.display:this.labelShow,this.positionChoice=n.positionChoice?n.positionChoice:this.positionChoice)}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=Ve;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})}),0)*this._yScaleHeight]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}();function Xe(t,e){var n=0;e.forEach(function(t){"objCol"===t.function&&(n=t.index,t.isLegend)});var i={},o=[],r=t.length,a=t[0];a.forEach(function(t,e){e!==n&&t&&(i[t]={name:t,data:[]})});for(var l=1;l<r;l++){var s=t[l],u=s[n];if(u)for(var c=0;c<s.length;c++){var h=a[c];c!==n&&h&&i[h].data.push({name:u,value:s[c]})}}for(var d in i)o.push(i[d]);return o.forEach(function(t,e){t.key=t.name+"-"+e}),o}function Qe(t,e){var n=0,i=1;e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&(i=t.index)});var o={},r=[],a=t.length,l=t[0],s=l[i];o[s]={name:s,data:[]};for(var u=0,c=1;c<a;c++){var h=t[c],d=h[n];if(d){var _=l[i];1==c||2==c?u=parseInt(t[1][i]):u-=parseInt(t[c-1][i]),o[_].data.push({name:d,value:h[i],total:u})}}for(var f in o)r.push(o[f]);return r.forEach(function(t,e){t.key=t.name+"-"+e}),r}var qe=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","form-water-fall-histogram-chart"),e.grid=new vt(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xAxis.minTickDistance(1),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=-1,e._curve=d3.curveCardinal,e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Te(e.coreGroup),e.overlay=new ke(e.coreGroup),e._histogramWidth=.7,e._yScaleHeight=1.05,e._marginTop=20,e.barWidthPercent=.7,e.barCornerRadius=0,e.borderWidth=0,e.borderColor=null,e.fillOpacity=1,e.labelShow=!0,e.positionOptions=["",""],e.positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var l=this,s=l.activeData,t=s.toString()?s[0].data:[],e=l.grid,u=l.tooltip,n=l.rectPlot,i=l.overlay,c=l.selectOverlay,o=l.barWidthPercent?l.barWidthPercent:.8,h=l.xScale,r=l.yScale,a=l.widthOfCore,d=l.heightOfCore,_=d3.min(s,function(t){return d3.min(t.data,function(t){return+t.total-t.value})}),f=(l.widthOfNoMargin,l.heightOfMainGroup);l.yAxis.width,l.xAxis.height;_<0?(d3.selectAll(".form-water-fall-histogram-chart .axis-x path").attr("transform","translate(0, "+-(r.range()[0]-r(0))+")"),d3.selectAll(".form-water-fall-histogram-chart .axis-x line").attr("transform","translate(0, "+-(r.range()[0]-r(0))+")")):(d3.selectAll(".form-water-fall-histogram-chart .axis-x path").attr("transform","translate(0,0)"),d3.selectAll(".form-water-fall-histogram-chart .axis-x line").attr("transform","translate(0,0)")),i.width(a).height(d).onMouseover(function(){u.show(),c.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=h.step(),o=Math.floor(n/i),r=h.domain()[o],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),c.translate(h(r),0),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),c.hide()}),n.data(t).xScale(h).yScale(r).barCornerRadius(l.barCornerRadius).borderWidth(l.borderWidth).borderColor(l.borderColor).labelShow(l._labelShow).positionOptions(l.positionOptions).positionChoice(l.positionChoice).contentOption(l._contentOption).contentChoice(l._contentChoice).rectObj({xFunc:function(t,e){return h.step()*e+h.step()*(1-l._histogramWidth*o)/2},yFunc:function(t){return r(t.total)},widthFunc:function(){return h.step()*l._histogramWidth*o},heightFunc:function(t){return Math.abs(r(0)-r(t.value))}}).textObj({xFunc:function(t,e){return h.step()*e},yFunc:function(t){return r(t.total)},dxFunc:function(t,e){return 0<h.step()?(1-t.value.toString().length*l._fontSize/2/h.step())/2*h.step():0},dyFunc:function(t,e){return 0==l.positionOptions.indexOf(l.positionChoice)?.5*-l._fontSize:1==l.positionOptions.indexOf(l.positionChoice)?r(0)-r(Math.abs(t.value))-.5*l._fontSize:void 0},colorFunc:function(){return l._fontColor},textFunc:function(t){return t.value},fontSize:l._fontSize,labelShow:l._labelShow}).fillOpacity(l.fillOpacity),e.width(a).height(d).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),c.width(h.step()).height(d).shadowColor(l._shadowColor).hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),n.updateFormWaterfall(),c.update(),i.update();var p=l.yAxis.width;e.translate(p,l.yAxis.titleHeight).update()}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=Qe;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this.barWidthPercent=e.barWidthPercent?e.barWidthPercent:this.barWidthPercent,this.barCornerRadius=e.barCornerRadius?e.barCornerRadius:this.barCornerRadius,this.borderWidth=e.borderWidth?e.borderWidth:this.borderWidth,this.borderColor=e.borderColor?e.borderColor:this.borderColor,this.fillOpacity=e.fillOpacity?e.fillOpacity:this.fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this.labelShow=n.display?n.display:this.labelShow,this.positionChoice=n.positionChoice?n.positionChoice:this.positionChoice)}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total-t.value})}),0),t[0].data[0].value*this._yScaleHeight]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}(),Ze=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","simple-bar-chart"),e.core=new xe(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xScale=d3.scaleBand().padding(.05),e.yScale=d3.scaleLinear(),e._xTickShow=!0,e._yTickShow=!0,e._barWidthPercent=.9,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var t=this,e=t.activeData,n=t.core,i=t.tooltip,o=t.clipArea,r=t.widthOfCore,a=t.heightOfCore;n.data(e).xScale(t.xScale).yScale(t.yScale).zeroLineStroke(t._axisLineStroke).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).fontSize(t._fontSize).fontColor(t._fontColor).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).textObj({colorFunc:function(){return t._fontColor}}).onMouseover(function(t){d3.select(this).style("stroke","#000");var e=[{text:""+t.name,color:t.color},{text:t.valueLabel+": "+t.value}];i.data(e).update().show()}).onMousemove(function(){i.move()}).onMouseout(function(){i.hide(),d3.select(this).style("stroke",n.stroke())}),o.width(r).height(a).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.call(E,t.yAxis.width+.5,t.yAxis.titleHeight),0!=t._clipShow.length&&(t.coreGroup.attr("clip-path","url(#"+o.id+")"),o.update()),n.update()}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain||[]).slice().sort(d3.ascending),n=t.length?t.map(function(t){return t.name}):[0,1],i=void 0;if(t.length){var o=d3.min(t,function(t){return+t.value}),r=d3.max(t,function(t){return+t.value});i=o<0?r<=0?[o,0]:[o,r]:[0,r]}else i=[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"updateScale",value:function(){this.xScale.padding(1-this._barWidthPercent)}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&this.barWidthPercent(o(e.barWidthPercent?e.barWidthPercent:this._barWidthPercent)).cornerRadius(o(e.barCornerRadius?e.barCornerRadius:this._cornerRadius)).stroke(e.borderColor||this._stroke).strokeWidth(o(e.borderWidth?e.borderWidth:this._strokeWidth)),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice)}}]),n}(),Ue=function(t){function e(t){return r(this,e),h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return c(e,P),a(e,[{key:"update",value:function(){var t=this,e=(t._data,t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius).startAngle(t._startAngle).endAngle(t._endAngle));t.pieFunc.value(function(t){return+t.value}).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod);var n=t.pieFunc(t._data),i=t.group.selectAll("path").data(n,function(t){return t.data.key});i.exit().remove();i.merge(i.enter().append("path")).attr("d",e).style("stroke",t._stroke).style("stroke-width",t._strokeWidth).style("fill",function(t){return t.data.color_special});return t}}]),e}();function Ke(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),m(t,[n,i])||!O(t,i))return[];var o=[],r=t[0][n],a=t[0][i],l=t.slice(1,2),s=parseFloat(l[0][i]);return s=10<s||10==s?(s/Math.pow(10,String(parseInt(s)).length)).toFixed(4):s<10&&1<s?(s/Math.pow(10,String(parseInt(s)).length+1)).toFixed(4):s.toFixed(4),isNaN(s)||o.push({name:l[0][n],value:+s,nameLabel:r,valueLabel:a}),o.forEach(function(t,e){t.key=u(t.name)+"-"+e}),o}var Je=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","Progress-Round-pie-chart"),e.pieBg=new Ue(e.mainGroup),e.core=e.pie=new P(e.mainGroup),e._innerRadius=0,e._padAngle=0,e._startAngle=0,e._endAngle=2*Math.PI,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._numberShow=!0,e._nFontSize=35,e._nFontFamily="noto",e._nColor="red",e._textShow=!0,e._tFontSize=25,e._tFontFamily="noto",e._tColor="grey",e}return c(n,L),a(n,[{key:"updateCore",value:function(){var r=this,t=r.pieBg,a=r.pie,e=r.widthOfNoMargin,n=.9*e,i=r.heightOfMainGroup,o=r._startAngle,l=r._endAngle,s=S(n,i,o,l),u=s.radius,c=r._innerRadius||(r._innerRadiusRatio?r._innerRadiusRatio*u:.75*u),h=s.cx+(e-n)/2,d=s.cy;t.data(r.activeData).innerRadius(c).outerRadius(u).cornerRadius(r._cornerRadius).startAngle(o).endAngle(-l*(1-this._data[0].value)),r.pieBg.translate(h,d).update(),a.data(r.activeData).innerRadius(c).outerRadius(u).cornerRadius(r._cornerRadius).startAngle(o).endAngle(l*this._data[0].value).areaBorderColor(r._areaBorderColor).areaBorderWidth(r._areaBorderWidth).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(n.selectAll("text").remove(),1==a.data().length){var i=n.append("text").attr("class","middleNumber").attr("dy","-5px").style("text-anchor","middle").text(100*t.data.value+"% ").style("pointer-events","none").style("fill",r._nColor).attr("font-size",r._nFontSize).attr("font-family",r._nFontFamily),o=n.append("text").attr("class","middleText").attr("dy","1em").style("text-anchor","middle").text(t.data.name+" ").style("pointer-events","none").style("fill",r._tColor).attr("font-size",r._tFontSize).attr("font-family",r._tFontFamily);1==r._textShow?o.style("display","block"):o.style("display","none"),null!=r._textShow&&null!=r._tFontSize&&null!=r._tColor&&null!=r._tFontFamily||o.style("display","none"),1==r._numberShow?i.style("display","block"):i.style("display","none"),null!=r._numberShow&&null!=r._nFontSize&&null!=r._nColor&&null!=r._nFontFamily||i.style("display","none")}}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(u,1.05*u);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}});var e=[{text:i.data.name+": "+100*i.data.value+"%",color:i.data.color}];r.tooltip.data(e).update().show()}).onMousemove(function(){r.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*u,u);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}}),r.tooltip.hide()}),r.pie.translate(h,d).update()}},{key:"buildOption",value:function(t,e){var n=new z(t,e),i=Ke;switch(n.dataType){case"cross-table":i=_;break;default:i=Ke}return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._innerRadiusRatio=e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio,this._cornerRadius=e.cornerRadius?e.cornerRadius:this._cornerRadius,this._areaBorderWidth=e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth,this._areaBorderColor=e.areaBorderColor?e.areaBorderColor:this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(null!=n.numberLabel&&(this._numberShow=n.numberLabel.show?n.numberLabel.show:this._numberShow,this._nFontSize=n.numberLabel.fontSize?n.numberLabel.fontSize:this._nFontSize,this._nFontFamily=n.numberLabel.fontFamily?n.numberLabel.fontFamily:this._nFontFamily,this._nColor=n.numberLabel.color?n.numberLabel.color:this._nColor),null!=n.textLabel&&(this._textShow=n.textLabel.show?n.textLabel.show:this._textShow,this._tFontSize=n.textLabel.fontSize?n.textLabel.fontSize:this._tFontSize,this._tFontFamily=n.textLabel.fontFamily?n.textLabel.fontFamily:this._tFontFamily,this._tColor=n.textLabel.color?n.textLabel.color:this._tColor))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),n}(),$e=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","Half-Progress-pie-chart"),e.pieBg=new Ue(e.mainGroup),e.core=e.pie=new P(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI,e._padAngle=0,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._numberShow=!0,e._nFontSize=35,e._nFontFamily="noto",e._nColor="red",e._textShow=!0,e._tFontSize=25,e._tFontFamily="noto",e._tColor="grey",e}return c(n,L),a(n,[{key:"updateCore",value:function(){var r=this,t=r.pieBg,a=r.pie,e=r.widthOfNoMargin,n=.9*e,i=r.heightOfMainGroup,o=r._startAngle,l=r._endAngle,s=function(t,e,n,i){var o=Math.min(t,e),r=o/2,a=e/2+r/2;o==e&&(a=1.1*(r=.9*e),t/2<r&&(a=e/2+(r=t/2)/2));return{radius:r,cx:t/2,cy:a,quadrant:0}}(n,i),u=s.radius,c=r._innerRadius||(r._innerRadiusRatio?r._innerRadiusRatio*u:.75*u),h=s.cx+(e-n)/2,d=s.cy;t.data(r.activeData).innerRadius(c).outerRadius(u).cornerRadius(r._cornerRadius).startAngle(o+l*this._data[0].value).endAngle(l/2),a.data(r.activeData).innerRadius(c).outerRadius(u).cornerRadius(r._cornerRadius).startAngle(o).endAngle(o+l*this._data[0].value).areaBorderColor(r._areaBorderColor).areaBorderWidth(r._areaBorderWidth).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(n.selectAll("text").remove(),1==a.data().length){var i=n.append("text").attr("class","middleNumber").attr("dy","-"+(r._tFontSize+5)).style("text-anchor","middle").text(100*t.data.value+"% ").style("pointer-events","none").style("fill",r._nColor).attr("font-size",r._nFontSize).attr("font-family",r._nFontFamily),o=n.append("text").attr("class","middleText").attr("dy","-0.1em").style("text-anchor","middle").text(t.data.name+" ").style("pointer-events","none").style("fill",r._tColor).attr("font-size",r._tFontSize).attr("font-family",r._tFontFamily);1==r._textShow?o.style("display","block"):o.style("display","none"),null!=r._textShow&&null!=r._tFontSize&&null!=r._tColor&&null!=r._tFontFamily||o.style("display","none"),1==r._numberShow?i.style("display","block"):i.style("display","none"),null!=r._numberShow&&null!=r._nFontSize&&null!=r._nColor&&null!=r._nFontFamily||i.style("display","none")}}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(u,1.05*u);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}});var e=[{text:i.data.name+": "+100*i.data.value+"%",color:i.data.color}];r.tooltip.data(e).update().show()}).onMousemove(function(){r.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*u,u);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}}),r.tooltip.hide()}),r.pie.translate(h,d).update(),r.pieBg.translate(h,d).update()}},{key:"buildOption",value:function(t,e){var n=new z(t,e),i=Ke;switch(n.dataType){case"cross-table":i=_;break;default:i=Ke}return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._innerRadiusRatio=e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio,this._cornerRadius=e.cornerRadius?e.cornerRadius:this._cornerRadius,this._areaBorderWidth=e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth,this._areaBorderColor=e.areaBorderColor?e.areaBorderColor:this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(null!=n.numberLabel&&(this._numberShow=n.numberLabel.show?n.numberLabel.show:this._numberShow,this._nFontSize=n.numberLabel.fontSize?n.numberLabel.fontSize:this._nFontSize,this._nFontFamily=n.numberLabel.fontFamily?n.numberLabel.fontFamily:this._nFontFamily,this._nColor=n.numberLabel.color?n.numberLabel.color:this._nColor),null!=n.textLabel&&(this._textShow=n.textLabel.show?n.textLabel.show:_textShow,this._tFontSize=n.textLabel.fontSize?n.textLabel.fontSize:_tFontSize,this._tFontFamily=n.textLabel.fontFamily?n.textLabel.fontFamily:_tFontFamily,this._tColor=n.textLabel.color?n.textLabel.color:this._tColor))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),n}(),tn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","line-text"),e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._innerRadius=0,e._outerRadius=0,e._startAngle=0,e._endAngle=2*Math.PI,e._cornerRadius=0,e._padAngle=0,e._padRadius=null,e._areaBorderColor="#fff",e._areaBorderWidth=1,e._sortMethod=null,e}return c(n,T),a(n,[{key:"update",value:function(){var o=this,r=o.arcFunc.innerRadius(o._innerRadius).outerRadius(o._outerRadius).cornerRadius(o._cornerRadius).padAngle(o._padAngle).padRadius(o._padRadius);o.pieFunc.value(function(t){return+t.value}).startAngle(o._startAngle).endAngle(o._endAngle).sort(o._sortMethod);for(var t=o.pieFunc(o._data),e=[],n=0;n<t.length;n++)e.push([1.3*r.centroid(t[n])[0]+.1*o._outerRadius*(f(t[n])<0?-1:1),1.3*r.centroid(t[n])[1]]);var i=[],a=[];if("object"==b(o._contentChoice)){if(3==typeof o._contentChoice){for(var l=0;l<e.length;l++)0<e[l][0]&&0<e[l-1][0]?Math.abs(e[l][1]-e[l-1][1])<3*o._fontSize&&i.push(l):e[l][0]<0&&0<l&&Math.abs(e[l][1]-e[l-1][1])<3*o._fontSize&&i.push(l);for(var s=0;s<e.length;s++)0<e[s][0]&&0<e[s-1][0]?Math.abs(e[s][0]-e[s-1][0])>(String(o._values[s]).length-1.5)*o._fontSize&&Math.abs(e[s][1]-e[s-1][1])>.9*this._fontSize&&a.push(s):e[s][0]<0&&0<s&&Math.abs(e[s][0]-e[s-1][0])>(String(o._values[s]).length-1.5)*o._fontSize&&Math.abs(e[s][1]-e[s-1][1])>.9*this._fontSize&&a.push(s)}else if(2==o._contentChoice.length){for(var u=0;u<e.length;u++)0<e[u][0]&&0<e[u-1][0]?Math.abs(e[u][1]-e[u-1][1])<2*o._fontSize&&i.push(u):e[u][0]<0&&0<u&&Math.abs(e[u][1]-e[u-1][1])<2*o._fontSize&&i.push(u);for(var c=0;c<e.length;c++)0<e[c][0]&&0<e[c-1][0]?Math.abs(e[c][0]-e[c-1][0])>(String(o._values[c]).length-1.5)*o._fontSize&&Math.abs(e[c][1]-e[c-1][1])>.9*this._fontSize&&a.push(c):e[c][0]<0&&0<c&&Math.abs(e[c][0]-e[c-1][0])>(String(o._values[c]).length-1.5)*o._fontSize&&Math.abs(e[c][1]-e[c-1][1])>.9*this._fontSize&&a.push(c)}}else if("string"==typeof o._contentChoice){for(var h=0;h<e.length;h++)0<e[h][0]&&0<e[h-1][0]?Math.abs(e[h][1]-e[h-1][1])<.7*o._fontSize&&i.push(h):e[h][0]<0&&0<h&&Math.abs(e[h][1]-e[h-1][1])<.7*o._fontSize&&i.push(h);for(var d=0;d<e.length;d++)0<e[d][0]&&0<e[d-1][0]?Math.abs(e[d][0]-e[d-1][0])>(String(o._values[d]).length-1.5)*o._fontSize&&Math.abs(e[d][1]-e[d-1][1])>.9*this._fontSize&&a.push(d):e[d][0]<0&&0<d&&Math.abs(e[d][0]-e[d-1][0])>(String(o._values[d]).length-1.5)*o._fontSize&&Math.abs(e[d][1]-e[d-1][1])>.9*this._fontSize&&a.push(d)}for(var _=0;_<a.length;_++)-1!=i.indexOf(a[_])&&i.splice(i.indexOf(a[_]),1);function f(t){return t.startAngle+(t.endAngle-t.startAngle)/2}var p=o.group.append("g").attr("class","half-texts").selectAll("text").data(t);p.exit().remove(),p.merge(p.enter().append("text")).text(function(t){return t.data.name}).attr("dy","-0.6em").transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("transform",function(t){this._current=this._current||t;var i=d3.interpolate(this._current,t);return this._current=i(0),function(t){var e=i(t),n=r.centroid(e);return"translate("+[1.3*n[0]+.1*o._outerRadius*(f(e)<0?-1:1),1.3*n[1]]+")"}}).styleTween("text-anchor",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return 0<f(e(t))?"start":"end"}});var y=o.group.append("g").attr("class","half-numbers").selectAll("text").data(t);y.exit().remove(),y.merge(y.enter().append("text")).text(function(t){return t.data.value+"%"}).attr("dy","0.4em").transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("transform",function(t){this._current=this._current||t;var i=d3.interpolate(this._current,t);return this._current=i(0),function(t){var e=i(t),n=r.centroid(e);return"translate("+[1.3*n[0]+.1*o._outerRadius*(f(e)<0?-1:1),1.3*n[1]]+")"}}).styleTween("text-anchor",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return 0<f(e(t))?"start":"end"}});var v=o.group.append("g").attr("class","half-numbers1").selectAll("text").data(t);v.exit().remove(),v.merge(v.enter().append("text")).text(function(t){return t.data.value}).attr("dy","1.4em").transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("transform",function(t){this._current=this._current||t;var i=d3.interpolate(this._current,t);return this._current=i(0),function(t){var e=i(t),n=r.centroid(e);return"translate("+[1.3*n[0]+.1*o._outerRadius*(f(e)<0?-1:1),1.3*n[1]]+")"}}).styleTween("text-anchor",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return 0<f(e(t))?"start":"end"}});var g=o.group.selectAll("polyline").data(t);g.exit().remove(),g.merge(g.enter().append("polyline")).style("stroke",function(t){return t.data.color}).style("fill","none").transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("points",function(t){this._current=this._current||t;var i=d3.interpolate(this._current,t);return this._current=i(0),function(t){var e=i(t),n=r.centroid(e);return[n,1.3*n[0],1.3*n[1],1.3*n[0]+.1*o._outerRadius*(f(e)<0?-1:1),1.3*n[1]]}});var m=d3.selectAll(".half-texts text").nodes(),x=d3.selectAll(".half-numbers text").nodes(),k=d3.selectAll(".half-numbers1 text").nodes(),S=d3.selectAll("polyline").nodes();null==o._labelShow||null==o._positionOptions||null==o._positionChoice||null==o._contentOption||null==o._contentChoice?(d3.selectAll(m).style("display","none"),d3.selectAll(x).style("display","none"),d3.selectAll(k).style("display","none"),d3.selectAll(S).style("display","none")):0==o._labelShow?(d3.selectAll(m).style("display","none"),d3.selectAll(x).style("display","none"),d3.selectAll(k).style("display","none"),d3.selectAll(S).style("display","none")):0==o._positionOptions.indexOf(o._positionChoice)&&(0==o._contentOption.indexOf(o._contentChoice)?(d3.selectAll(m).style("display","block").attr("dy","0.3em"),d3.selectAll(x).style("display","none"),d3.selectAll(k).style("display","none")):1==o._contentOption.indexOf(o._contentChoice)?(d3.selectAll(x).style("display","block").attr("dy","0.3em"),d3.selectAll(m).style("display","none"),d3.selectAll(k).style("display","none")):2==o._contentOption.indexOf(o._contentChoice)?(d3.selectAll(k).style("display","block").attr("dy","0.3em"),d3.selectAll(x).style("display","none"),d3.selectAll(m).style("display","none")):2==o._contentChoice.length&&(0==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1])?(d3.selectAll(m).style("display","block").attr("dy","-0.1em"),d3.selectAll(x).style("display","block").attr("dy","0.9em"),d3.selectAll(k).style("display","none")):0==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])?(d3.selectAll(m).style("display","block").attr("dy","-0.1em"),d3.selectAll(k).style("display","block").attr("dy","0.9em"),d3.selectAll(x).style("display","none")):1==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])&&(d3.selectAll(x).style("display","block").attr("dy","-0.1em"),d3.selectAll(k).style("display","block").attr("dy","0.9em"),d3.selectAll(m).style("display","none"))));for(var w=0;w<i.length;w++)d3.select(m[i[w]]).style("display","none"),d3.select(x[i[w]]).style("display","none"),d3.select(k[i[w]]).style("display","none"),d3.select(S[i[w]]).style("display","none");return o}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"values",value:function(t){return arguments.length?(this._values=t,this):this._values}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}}]),n}(),en=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","half-pie-chart"),e.core=e.pie=new P(e.mainGroup),e.lineText=new tn(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e._padAngle=0,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=["",""],e}return c(n,L),a(n,[{key:"updateCore",value:function(){for(var a=this,l=a.pie,t=a.lineText,e=a.widthOfNoMargin,n=[],i=0;i<a.activeData.length;i++)n.push(a.activeData[i].name);var o=.65*e-M(n,a._fontSize,a._fontFamily);null==a._labelShow||null==a._positionOptions||null==a._positionChoice||null==a._contentOption||null==a._contentChoice?o=.9*e:0!=a._labelShow&&1!=a._positionOptions.indexOf(a._positionChoice)||(o=.9*e);var r=a.heightOfMainGroup,s=a._startAngle,u=a._endAngle,c=function(t,e,n,i){var o=Math.min(t,e),r=o/2,a=e/2+r/2;o==e&&(a=1.1*(r=.9*e),t/2<r&&(a=e/2+(r=t/2)/2));return{radius:r,cx:t/2,cy:a,quadrant:0}}(o,r),h=c.radius,d=a._innerRadius||(a._innerRadiusRatio?a._innerRadiusRatio*h:.75*h);for(var _=[],f=0;f<a.activeData.length;f++)_.push(a.activeData[f].value);l.data(a.activeData).innerRadius(d).outerRadius(h).cornerRadius(a._cornerRadius).startAngle(s).endAngle(u).areaBorderColor(a._areaBorderColor).areaBorderWidth(a._areaBorderWidth).transition(a._transition).duration(a._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(1!=l.data().length){var i="arc-path-"+t.data.key.replace(/\s*/g,"").replace(/\./g,"")+"-"+a.id;a.defs.select("#"+i).remove();var o=x((d+h)*a._labelRadiusRatio,t.startAngle+.025,t.endAngle-.025),r=a.defs.select("#"+i).empty()?a.defs.append("path").attr("d",o).attr("id",i):a.defs.select("#"+i).attr("d",o);null==a._labelShow||null==a._positionOptions||null==a._positionChoice||null==a._contentOption||null==a._contentChoice?d3.selectAll(".chart-label-text").style("display","none"):0==a._labelShow?d3.selectAll(".chart-label-text").style("display","none"):1==a._positionOptions.indexOf(a._positionChoice)&&(0==a._contentOption.indexOf(a._contentChoice)?A(n,r,t.data.name,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",0):1==a._contentOption.indexOf(a._contentChoice)?A(n,r,t.data.value+"%",a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",0):2==a._contentOption.indexOf(a._contentChoice)?A(n,r,t.data.value,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",0):2==a._contentChoice.length?0==a._contentOption.indexOf(a._contentChoice[0])&&1==a._contentOption.indexOf(a._contentChoice[1])?(A(n,r,t.data.name,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(-String(t.data.name).length/2.5)),A(n,r,t.data.value+"%",a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(String(t.data.value).length/3.5+1))):0==a._contentOption.indexOf(a._contentChoice[0])&&2==a._contentOption.indexOf(a._contentChoice[1])?(A(n,r,t.data.name,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(-String(t.data.name).length/2.5)),A(n,r,t.data.value,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(String(t.data.value).length/2.5))):1==a._contentOption.indexOf(a._contentChoice[0])&&2==a._contentOption.indexOf(a._contentChoice[1])&&(A(n,r,t.data.value+"%",a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(-String(t.data.value).length/3.5)),A(n,r,t.data.value,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(String(t.data.value).length/2.5))):3==a._contentChoice.length&&(A(n,r,t.data.name,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(-String(t.data.name).length/1.2)),A(n,r,t.data.value+"%",a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx",a._fontSize*(String(t.data.value).length/2+1)),A(n,r,t.data.value,a._fontSize,a._fontFamily).attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._fontColor).attr("dx","0")))}else n.append("text").attr("class",a.labelTextClass).attr("dy","0.35em").style("text-anchor","middle").text(t.data.name).style("pointer-events","none")}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(h,1.05*h);return function(t){var e=n(t);return l.arcFunc.outerRadius(e),l.arcFunc(i)}});var e=[{text:""+i.data.name,color:i.data.color},{text:i.data.valueLabel+": "+i.data.value}];a.tooltip.data(e).update().show()}).onMousemove(function(){a.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*h,h);return function(t){var e=n(t);return l.arcFunc.outerRadius(e),l.arcFunc(i)}}),a.tooltip.hide()});var p=c.cx+(e-o)/2,y=c.cy;a.pie.translate(p,y).update(),null!=a._labelShow&&0!=a._labelShow&&0==a._positionOptions.indexOf(a._positionChoice)&&(t.data(a.activeData).innerRadius(d).outerRadius(h).cornerRadius(a._cornerRadius).startAngle(s).endAngle(u).fontSize(a._fontSize).labelShow(a._labelShow).positionOptions(a._positionOptions).positionChoice(a._positionChoice).contentOption(a._contentOption).contentChoice(a._contentChoice).values(_).transition(a._transition).duration(a._duration),a.lineText.translate(p,y).update())}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(e.innerRadiusRatio).cornerRadius(e.cornerRadius).areaBorderWidth(e.areaBorderWidth).areaBorderColor(e.areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n.display?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}}]),n}(),nn=function(t){function o(t){r(this,o);var e=h(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.xAxis=null,e.yAxis=null,e.yAxisDoubleY=null,e.xScale=null,e.yScale=null,e._marginLeft=15,e._marginRight=20,e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yOrientRight="right",e._xDomain=null,e._yDomain=null,e._xTitle="",e._yTitle="",e._axisLineStroke=null,e._xTickShow=!0,e._yTickShow=!0,e}return c(o,q),a(o,[{key:"update",value:function(){return this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this.updateTitle(),this.updateAxis(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();t.xAxis;var e=t.yAxis,n=t.yAxisDoubleY,i=t.xScale,o=t.yScale,r=(t._xType,t._yType),a=(t._xOrient,t._yOrient),l=t._yOrientRight,s=t._fontSize,u=t.widthOfNoMargin,c=t.heightOfMainGroup;i.domain(t._xDomain),o.domain(t._yDomain),e.scaleFunc(o).allowedMaxTextWidth(.5*u).type(r).orient(a).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(s).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),n.scaleFunc(o).allowedMaxTextWidth(.5*u).type(r).orient(l).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(s).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var h=e.titleHeight,d=c/(3*s);e.tickCount(d),n.tickCount(d),o.nice().range([c-h,0]);e.width;var _=e.width,f=h;e.translate(_,f).update(),n.translate(_,f).update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"yOrientRight",value:function(t){return arguments.length?(this._yOrientRight=t,this):this._yOrientRight}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{};this.axisLineStroke(e.color).xTitle(n.name).yTitle(i.name).xTickShow(n.labelShow).yTickShow(i.labelShow).xDomain(n.range).yDomain(i.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return 0<e?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.yAxis?this.yAxis.titleHeight:0,n=this.heightOfMainGroup-t-e;return 0<n?n:0}}]),o}(),on="axis-group",rn="y-slope-title",an=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-slope"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return c(n,nt),a(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,r=t._tickValueTexts,a=void 0;a=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),a.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+on).empty()?i.append("g").attr("class",on):i.select("."+on);if(s.transition().duration(t._transition?t._duration:0).call(a).on("start",function(){s.selectAll(".tick text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return r[e]}),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")}),t._title="left"==e?t._title[0]:"right"==e?t._title[1]:t._title,t._titleShow&&t._title){var u=i.select("."+rn).empty()?i.append("g").attr("class",rn):i.select("."+rn),c=u.select("text").empty()?u.append("text"):u.select("text"),h=H(t._title,o,t._fontFamily);c.attr("x",h>=2*t.width?-h/2:0).attr("y",.8*-this._fontSize).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",h>=2*t.width?"start":"middle").text(t._title)}else i.select("."+rn).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,r=e._type,a=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===r?o.domain():o.ticks(e._tickCount);var s=d3.max(t,function(t){return H(t,a,e._fontFamily)});return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,a,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),ln=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","slope"),e._xScale=null,e._yScale=null,e._sWidth=null,e._stroke=null,e._lineWidth=1,e._strokeDasharry="",e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group.selectAll("line").data(t);return n.exit().remove(),n.enter().append("line").merge(n).style("fill","none").style("stroke",function(t){return e._stroke||t.color||"#000"}).style("stroke-width",e._lineWidth).style("stroke-dasharray",e._strokeDasharry).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(e._transition?e._duration:0).attr("x1",e._textLength).attr("y1",function(t){return e._yScale(t.data[0].value)}).attr("x2",e._sWidth).attr("y2",function(t){return e._yScale(t.data[1].value)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}}]),n}(),sn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","slope-scatter-plot"),e._xScale=null,e._yScale=null,e._sWidth=null,e._circleRadius=2,e._circleBorderWidth=1,e._circleBorderColor="#000",e._fill=null,e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){for(var r=this,t=r.group,a=r._data,l=(r._xScale,r._yScale),e=[],n=[],i=0;i<a.length;i++)e.push(l(a[i].data[0].value)),n.push(l(a[i].data[1].value));for(var o=[],s=[],u=0;u<e.length;u++)(e[u]-e[u-1]<.8*r._fontSize&&e[u+1]-e[u]<.8*r._fontSize||e[u+1]-e[u]<.8*r._fontSize)&&o.push(u);for(var c=0;c<n.length;c++)(n[c]-n[c-1]<.8*r._fontSize&&n[c+1]-n[c]<.8*r._fontSize||n[c+1]-n[c]<.8*r._fontSize)&&s.push(c);var h=t.selectAll("g").data(a,function(t){return t.name});h.exit().remove(),h.enter().append("g").merge(h).each(function(t,e){var n=d3.select(this).selectAll("circle").data(t.data);n.exit().remove(),n.enter().append("circle").merge(n).style("fill",r._fill||t.color).style("stroke",r._circleBorderColor||t.color).style("stroke-width",r._circleBorderWidth).attr("r",r._circleRadius).attr("cx",function(t){return 1==t.index?r._textLength:2==t.index?r._sWidth:void 0}).attr("cy",function(t){return l(t.value)||0});var i=d3.select(this).append("g").attr("class","slopeNumbers").selectAll("text").data(t.data);i.exit().remove(),i.enter().append("text").merge(i).text(function(t){return t.value}).style("text-anchor",function(t){return 1==t.index?"end":2==t.index?"start":void 0}).style("font-color",r._circleBorderColor||t.color).attr("x",function(t){return 1==t.index?r._textLength:2==t.index?r._sWidth:void 0}).attr("y",function(t){return l(t.value)||0}).attr("dx",function(t){return 1==t.index?"-0.5em":2==t.index?(a[e].name.length+1)*r._fontSize:void 0}).attr("dy","0.3em");var o=d3.select(this).append("g").attr("class","slopeTexts").selectAll("text").data(t.data);o.exit().remove(),o.enter().append("text").merge(o).text(a[e].name).style("text-anchor",function(t){return 1==t.index?"end":2==t.index?"start":void 0}).style("font-color",r._circleBorderColor||t.color).attr("x",function(t){return 1==t.index?r._textLength:2==t.index?r._sWidth:void 0}).attr("y",function(t){return l(t.value)||0}).attr("dx",function(t){return 1==t.index?-String(a[e].data[0].value).length/2*r._fontSize-r._fontSize:2==t.index?"0.5em":void 0}).attr("dy","0.3em")});for(var d=d3.selectAll(".slopeTexts text").nodes().filter(function(t,e,n){return e%2==0}),_=d3.selectAll(".slopeTexts text").nodes().filter(function(t,e){return e%2!=0}),f=0;f<o.length;f++)d3.select(d[o[f]]).style("display","none");for(var p=0;p<s.length;p++)d3.select(_[s[p]]).style("display","none");for(var y=d3.selectAll(".slopeNumbers text").nodes().filter(function(t,e,n){return e%2==0}),v=d3.selectAll(".slopeNumbers text").nodes().filter(function(t,e){return e%2!=0}),g=0;g<o.length;g++)d3.select(y[o[g]]).style("display","none");for(var m=0;m<s.length;m++)d3.select(v[s[m]]).style("display","none");return null==r._labelShow||null==r._positionOptions||null==r._positionChoice?(d3.selectAll(d).style("display","none"),d3.selectAll(_).style("display","none"),d3.selectAll(v).attr("dx","0.5em"),d3.selectAll(y).attr("dx","-0.5em")):0==r._labelShow?(d3.selectAll(d).style("display","none"),d3.selectAll(_).style("display","none"),d3.selectAll(v).attr("dx","0.5em"),d3.selectAll(y).attr("dx","-0.5em")):0==r._positionOptions.indexOf(r._positionChoice)?(d3.selectAll(_).style("display","none"),d3.selectAll(v).attr("dx","0.5em")):1==r._positionOptions.indexOf(r._positionChoice)&&(d3.selectAll(d).style("display","none"),d3.selectAll(y).attr("dx","-0.5em")),r}},{key:"circleRadius",value:function(t){return arguments.length?(this._circleRadius=t,this):this._circleRadius}},{key:"circleBorderWidth",value:function(t){return arguments.length?(this._circleBorderWidth=t,this):this._circleBorderWidth}},{key:"circleBorderColor",value:function(t){return arguments.length?(this._circleBorderColor=t,this):this._circleBorderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"numberLength",value:function(t){return arguments.length?(this._numberLength=t,this):this._numberLength}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}}]),n}(),un=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","slopeOverlay-polygon"),e._width=0,e._height=0,e._shadowColor="#000",e}return c(n,T),a(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group.selectAll("polygon").data(t);return n.exit().remove(),n.enter().append("polygon").merge(n).style("fill",e._shadowColor).style("fill-opacity",.85).style("opacity",0).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(e._transition?e._duration:0).attr("points",function(t){return e._textLength+","+(e._yScale(t.data[0].value)+.012*e._sHeight)+"\n        "+e._sWidth+","+(e._yScale(t.data[1].value)+.012*e._sHeight)+" \n        "+e._sWidth+","+(e._yScale(t.data[1].value)-.012*e._sHeight)+" \n        "+e._textLength+","+(e._yScale(t.data[0].value)-.012*e._sHeight)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),n}();function cn(t,e){var n=0;e.forEach(function(t){"objCol"===t.function&&(n=t.index,t.isLegend)});for(var i=[],o=t.length,r=t[0],a=1;a<o;a++){var l=t[a],s=l[n];if(s){for(var u={name:s,index:a-1,data:[]},c=0;c<l.length;c++){var h=r[c];c!==n&&u.data.push({name:h,value:l[c],index:c})}i.push(u)}}return i.forEach(function(t,e){t.key=t.name+"-"+e}),i}var hn=function(t){function l(t){r(this,l);var e=h(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,t));return e.elem.attr("class","slope-chart"),e.yAxis=new an(e.mainGroup),e.yAxisDoubleY=new an(e.mainGroup),e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.slopeOverlay=new un(e.coreGroup),e.slope=new ln(e.coreGroup),e.scatterPlot=new sn(e.mainGroup),e.clipArea=new ft(e.defs),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yOrientRight="right",e._curve=d3.curveCardinal,e._showPoints=!0,e._circleRadius=3,e._lineWidth=2,e._circleBorderWidth=1,e._circleBorderColor="#000",e._shadowColor="#ccc",e._labelShow=!0,e._positionOptions=["","",""],e._positionChoice="",e}return c(l,nn),a(l,[{key:"updateCore",value:function(){var a=this,t=a.activeData,e=a.slopeOverlay,n=a.slope,i=a.scatterPlot,o=a.clipArea,r=(a.tooltip,a.xScale),l=a.yScale,s=a.widthOfCore,u=a.heightOfCore;a.widthOfNoMargin;for(var c=function(t){for(var e,n=0;n<t.length;n++)for(var i=n;i<t.length;i++)t[n].data[0].value<t[i].data[0].value&&(e=t[i],t[i]=t[n],t[n]=e);return t}(t),h=0;h<c.length;h++)c[h].index=h;for(var d=[],_=0;_<t.length;_++)d.push(t[_].name);for(var f=[],p=0;p<t.length;p++)f.push(t[p].data[0].value),f.push(t[p].data[1].value);var y=M(d,a._fontSize,a._fontFamily),v=M(f,a._fontSize,a._fontFamily),g=y+2.5*a._fontSize,m=a.widthOfNoMargin-y-v;null==a._labelShow||null==a._positionOptions||null==a._positionChoice?(a.yAxis.translate(9+2.5*a._fontSize,a.yAxis.titleHeight),a.yAxisDoubleY.translate(a.widthOfNoMargin+9-v,a.yAxis.titleHeight),m=a.widthOfNoMargin-v,g=2.5*a._fontSize):0==a._labelShow?(a.yAxis.translate(9+2.5*a._fontSize,a.yAxis.titleHeight),a.yAxisDoubleY.translate(a.widthOfNoMargin+9-v,a.yAxis.titleHeight),m=a.widthOfNoMargin-v,g=2.5*a._fontSize):0==a._positionOptions.indexOf(a._positionChoice)?(a.yAxis.translate(y+9+2.5*a._fontSize,a.yAxis.titleHeight),a.yAxisDoubleY.translate(a.widthOfNoMargin+9-v,a.yAxis.titleHeight),m=a.widthOfNoMargin-v):1==a._positionOptions.indexOf(a._positionChoice)?(a.yAxis.translate(9+2.5*a._fontSize,a.yAxis.titleHeight),a.yAxisDoubleY.translate(a.widthOfNoMargin-y+9-v,a.yAxis.titleHeight),g=2.5*a._fontSize):2==a._positionOptions.indexOf(a._positionChoice)&&(a.yAxis.translate(y+9+2.5*a._fontSize,a.yAxis.titleHeight),a.yAxisDoubleY.translate(a.widthOfNoMargin-y+9-v,a.yAxis.titleHeight)),i.data(c).xScale(r).yScale(l).fontSize(a._fontSize).labelShow(a._labelShow).positionOptions(a._positionOptions).positionChoice(a._positionChoice).contentOption(a._contentOption).contentChoice(a._contentChoice).textLength(g).numberLength(v).sWidth(m).circleBorderColor(a._circleBorderColor).circleBorderWidth(a._circleBorderWidth).circleRadius(a._circleRadius),n.data(c).xScale(r).yScale(l).textLength(g).sWidth(m).lineWidth(a._lineWidth).onMouseover(function(t,e){var n=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),i=a.coreGroup.selectAll("polygon").nodes(),o=d3.select(this).node().__data__.index;d3.select(i[o]).style("opacity",.45),d3.select(n[2*o+1]).attr("r",1.8*a._circleRadius),d3.select(n[2*o]).attr("r",1.8*a._circleRadius);var r=[{text:t.name,color:t.color},{text:t.data[0].name+": "+t.data[0].value,color:"none"},{text:t.data[1].name+": "+t.data[1].value,color:"none"}];a.tooltip.data(r).update().show()}).onMousemove(function(){a.tooltip.move();var t=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),e=a.coreGroup.selectAll("polygon").nodes(),n=d3.select(this).node().__data__.index;d3.select(e[n]).style("opacity",.45),d3.select(t[2*n+1]).attr("r",1.8*a._circleRadius),d3.select(t[2*n]).attr("r",1.8*a._circleRadius)}).onMouseout(function(t){a.tooltip.hide();var e=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),n=a.coreGroup.selectAll("polygon").nodes(),i=d3.select(this).node().__data__.index;d3.select(n[i]).style("opacity",0),d3.select(e[2*i+1]).attr("r",a._circleRadius),d3.select(e[2*i]).attr("r",a._circleRadius)}),e.data(c).xScale(r).yScale(l).textLength(g).sWidth(m).sHeight(u).shadowColor(a._shadowColor).onMouseover(function(t,e){var n=a.coreGroup.selectAll("circle").nodes(),i=d3.select(this).node().__data__.index;d3.select(this).style("opacity",.35),d3.select(n[2*i+1]).attr("r",1.8*a._circleRadius),d3.select(n[2*i]).attr("r",1.8*a._circleRadius);var o=[{text:t.name,color:t.color},{text:t.data[0].name+": "+t.data[0].value,color:"none"},{text:t.data[1].name+": "+t.data[1].value,color:"none"}];a.tooltip.data(o).update().show()}).onMousemove(function(){a.tooltip.move();var t=a.coreGroup.selectAll("circle").nodes(),e=d3.select(this).node().__data__.index;d3.select(this).style("opacity",.35),d3.select(t[2*e+1]).attr("r",1.8*a._circleRadius),d3.select(t[2*e]).attr("r",1.8*a._circleRadius)}).onMouseout(function(t){a.tooltip.hide();var e=a.coreGroup.selectAll("circle").nodes(),n=d3.select(this).node().__data__.index;d3.select(this).style("opacity",0),d3.select(e[2*n+1]).attr("r",a._circleRadius),d3.select(e[2*n]).attr("r",a._circleRadius)}),o.width(s).height(u).transition(a._transition).duration(a._duration),a.coreGroup.call(E,a.yAxis.width+.5,a.yAxis.titleHeight).attr("clip-path","url(#"+o.id+")"),o.update(),e.update(),n.update(),i.translate(a.yAxis.width+.5,a.yAxis.titleHeight).update()}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=cn;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t.map(function(t){return t.name}):[0,1]),n=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=e,this._yDomain=n}},{key:"setPublicOption",value:function(t){s(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.y.name||null,i=e.y1.name||null,o=this._data.filter(function(t){return!1!==t.active})[0].data[0].name,r=this._data.filter(function(t){return!1!==t.active})[0].data[1].name,a=[];a.push(n||o),a.push(i||r),this.yTitle(a)}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._circleRadius=e.circleRadius?e.circleRadius:this._circleRadius,this._lineWidth=e.lineWidth?e.lineWidth:this._lineWidth,this._circleBorderWidth=e.circleBorderWidth?e.circleBorderWidth:this._circleBorderWidth,this._circleBorderColor=e.circleBorderColor?e.circleBorderColor:this._circleBorderColor,this._shadowColor=e.shadowColor?e.shadowColor:this._shadowColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n.display?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice)}},{key:"widthOfNoMargin",get:function(){var t=this._width-3*this._marginLeft-this._marginRight;return 0<t?t:0}}]),l}(),dn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bar-progress"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"bg",value:function(){var e=this,t=e._data;d3.selectAll(".bg-rect").remove();var n=e.group.append("g").selectAll("rect").data(t,function(t){return t.key});n.exit().remove();var i=n.enter().append("rect").attr("class","bg-rect").merge(n).style("fill",function(t){return t.color_special}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return t.color_special}).style("stroke-width",function(t){return e._strokeWidth||0});return this._rectObj?i.attr("x",this._rectObj.xFunc).attr("y",this._rectObj.yFunc).attr("width",this._rectObj.widthFunc).attr("height",this._rectObj.heightFunc):i.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),e}},{key:"update",value:function(){var e=this,t=e._data;d3.selectAll(".progress-rect").remove();var n=e.group.append("g").selectAll("rect").data(t,function(t){return t.key});n.exit().remove();var i=n.enter().append("g"),o=i.append("rect").attr("class","progress-rect").merge(n).style("fill",function(t){return e._fillColor||t.color}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return e._strokeColor||t.color}).style("stroke-width",function(t){return e._strokeWidth||0});return this._rectObj?(o.attr("x",this._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj&&(d3.selectAll(".bar-text").remove(),i.append("text").attr("class","bar-text").merge(n).text(this._textObj.textFunc).attr("fill",this._textObj.colorFunc).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc)),o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),_n=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bar-progress-chart"),e.rect=new dn(e.mainGroup),e.rectBg=new dn(e.mainGroup),e.labelShow=!0,e.positionOptions=["",""],e.positionChoice="",e}return c(n,L),a(n,[{key:"updateCore",value:function(){var i=this,t=i.rect,e=i.rectBg,n=i.activeData,o=.9*i.widthOfNoMargin,r=.9*i.heightOfMainGroup;var a,l,s,u=(s=.1*(a=o),(l=r)<a/6&&(s=.6*l),s);e.data(n).rectObj({xFunc:function(t){return o*t.value},yFunc:r/2,widthFunc:function(t){return o*(1-t.value)},heightFunc:u}),t.data(n).rectObj({xFunc:0,yFunc:r/2,widthFunc:function(t){return o*t.value},heightFunc:u}).textObj({xFunc:function(t){return t.value},yFunc:r/2,dyFunc:u/2+.5*i._fontSize,dxFunc:function(t,e){return 0==i.positionOptions.indexOf(i.positionChoice)?o*t.value-2*i._fontSize:1==i.positionOptions.indexOf(i.positionChoice)?o*t.value/2-.5*i._fontSize:void 0},colorFunc:function(){return i.labelShow?i._fontColor:"none"},textFunc:function(t){return 100*t.value},fontSize:i._fontSize}).fillOpacity(1).onMouseover(function(t,e){var n=[{text:t.name+": "+100*t.value+"%",color:t.color}];i.tooltip.data(n).update().show()}).onMousemove(function(){i.tooltip.move()}).onMouseout(function(t){i.tooltip.hide()}),i.rect.translate(.1*i.widthOfNoMargin/2,0).update(),i.rectBg.translate(.1*i.widthOfNoMargin/2,0).bg()}},{key:"buildOption",value:function(t,e){var n=new z(t,e),i=Ke;switch(n.dataType){case"cross-table":i=_;break;default:i=Ke}return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this.labelShow=e.display?e.display:this.labelShow,this.positionChoice=e.positionChoice?e.positionChoice:this.positionChoice)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),n}(),fn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polygon-radar"),e._lineFunc=null,e._startAngle=0,e._endAngle=2*Math.PI,e._radius=100,e._stroke=null,e._strokeWidth=1,e._strokeDasharry="",e._transition=!0,e}return c(n,T),a(n,[{key:"update",value:function(){for(var o=this,t=o._data,e=(o.startAngle,o.endAngle,o._radius),n=t.length?[0,1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1],i=d3.scaleLinear().domain(n).nice().range([0,e]),r=o._deadData[0].data.length,a=2*Math.PI/r,l=[],s=0;s<t.length;s++){l[s]=[];for(var u=0;u<t[s].data.length;u++){var c=t[s].data[u].value;l[s][u]=i(c)}}for(var h=[],d=0;d<l.length;d++)for(var _=l[d],f="",p=[],y=0;y<r;y++){var v=_[y],g=v*Math.sin(y*a),m=v*Math.cos(y*a);f+=g+","+m+" ",p.push({x:g,y:m,value:t[d].data[y].value}),h[d]={polygon:f,points:p}}console.log(h);var x=o.group,k=x.selectAll("polygon").data(t);k.exit().remove(),k.enter().append("polygon").merge(k).style("fill","none").style("stroke-opacity",.8).style("stroke",function(t){return o._stroke||t.color||"#000"}).style("stroke-width",o._borderWidth).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(o._transition?o._duration:0).attr("points",function(t,e){return h[e].polygon});var S=x.selectAll("g").data(t);S.exit().remove(),S.enter().append("g").attr("class","circle-g").merge(S).each(function(t,e){var n=d3.select(this).selectAll("circle").data(h[e].points);n.exit().remove(),n.enter().append("circle").attr("cx",function(t){return t.x||0}).attr("cy",function(t){return t.y||0}).merge(n).style("fill","white").style("stroke",t.color).style("stroke-width",o._strokeWidth).attr("r",o._endPointRadius).attr("cx",function(t){return t.x||0}).attr("cy",function(t){return t.y||0});var i=d3.select(this).append("g").selectAll("text").data(h[e].points);i.exit().remove(),i.enter().append("text").merge(i).text(function(t,e){return t.value}).attr("fill",o._fontColor).attr("font-size",o._fontSize).attr("x",function(t){return 0==e?1.1*t.x||0:.9*t.x||0}).attr("y",function(t){return 0==e?1.1*t.y||0:.9*t.y||0}).attr("text-anchor","middle").style("display",o._labelShow?"block":"none")});for(var w=[],b=1.1*e,O=0;O<r;O++){var C=b*Math.sin(O*a),A=b*Math.cos(O*a);w.push({x:C,y:A})}d3.selectAll(".angle-text").remove();var M=x.append("g").selectAll("text").data(w);M.exit().remove(),M.enter().append("text").attr("class","angle-text").text(function(t,e){return o._deadData[0].data[e].name}).attr("fill",o._fontColor).attr("font-size",o._fontSize).attr("x",function(t){return t.x}).attr("y",function(t){return t.y});for(var F=0;F<r;F++)F*a==0||F*a==Math.PI?d3.select(d3.selectAll(".angle-text").nodes()[F]).attr("text-anchor","middle"):F*a>Math.PI?d3.select(d3.selectAll(".angle-text").nodes()[F]).attr("text-anchor","end"):0<F*a&&F*a<Math.PI&&d3.select(d3.selectAll(".angle-text").nodes()[F]).attr("text-anchor","start");for(var R=0;R<r;R++)R*a==0&&d3.select(d3.selectAll(".angle-text").nodes()[R]).attr("dy","0.8em");return o}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"deadData",value:function(t){return arguments.length?(this._deadData=t,this):this._deadData}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),pn="grid-polygon-path",yn="grid-line",vn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","polygon-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=8,e}return c(n,V),a(n,[{key:"update",value:function(){for(var e=this,t=e._data,n=(e._startAngle,e._endAngle,e._radius),i=e._donutCount,o=t[0].data.length||e._sectorCount,r=2*Math.PI/o,a={webs:[],webPoints:[]},l=i;0<l;l--){for(var s="",u=[],c=n/i*l,h=0;h<o;h++){var d=c*Math.sin(h*r),_=c*Math.cos(h*r);s+=d+","+_+" ",u.push({x:d,y:_})}a.webs.push(s),a.webPoints.push(u)}var f=e.group.style("fill","none").style("stroke",e._stroke).style("stroke-dasharray","none");!function(){if(!e._showX)return f.selectAll("."+pn).remove();var t=f.selectAll("."+pn).data(a.webs);t.exit().remove(),t.enter().append("polygon").attr("class",pn).merge(t).attr("points",function(t){return t}).attr("fill","white").attr("fill-opacity",e._fillOpacity),d3.selectAll(t.nodes().filter(function(t,e){return e%2!=0})).attr("fill","#ccc").attr("fill-opacity",e._fillOpacity)}(),function(){if(!e._showY)return f.selectAll("."+yn).remove();var t=f.selectAll("."+yn).data(a.webPoints[0]);t.exit().remove(),t.enter().append("line").attr("class",yn).merge(t).attr("x1",0).attr("y1",0).attr("x2",function(t){return t.x}).attr("y2",function(t){return t.y})}()}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=parseFloat(t),this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}}]),n}(),gn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.gridPolygon=new vn(e.mainGroup),e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.radar=new fn(e.coreGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._showPoints=!0,e._fillOpacity=.8,e._endPointRadius=2,e._borderWidth=3,e._labelShow=!1,e}return c(n,q),a(n,[{key:"updateCore",value:function(){var o=this,r=o.activeData,t=o.gridPolygon,e=o.radar,n=(o.tooltip,o.widthOfCore,o.heightOfCore,o.widthOfNoMargin),i=(o.heightOfMainGroup,.7*n),a=S(i,o.heightOfMainGroup,o._startAngle,o._endAngle),l=a.radius-2*o._fontSize;e.data(r).deadData(o.sortedDataCopy).fontColor(o._fontColor).fontSize(o._fontSize).labelShow(o._labelShow).radius(l).borderWidth(o._borderWidth).endPointRadius(o._endPointRadius).fontColor(o._fontColor).fontSize(o._fontSize).onMouseover(function(t,e){var n=[{text:r[e].name,color:r[e].color}];r[e].data.forEach(function(t,e){n.push({text:t.name+": "+t.value,color:"none"})}),d3.select(this).style("stroke-opacity",1).style("stroke-width",1.5*o._borderWidth);var i=d3.selectAll(".circle-g").nodes();d3.selectAll(i[e].childNodes).style("r",2.5*o._endPointRadius),o.tooltip.data(n).update().show()}).onMousemove(function(t,e){d3.select(this).style("stroke-opacity",1).style("stroke-width",1.5*o._borderWidth);var n=d3.selectAll(".circle-g").nodes();d3.selectAll(n[e].childNodes).style("r",2.5*o._endPointRadius),o.tooltip.move()}).onMouseout(function(t,e){d3.select(this).style("stroke-opacity",.8).style("stroke-width",o._borderWidth);var n=d3.selectAll(".circle-g").nodes();d3.selectAll(n[e].childNodes).style("r",o._endPointRadius),o.tooltip.hide()}),t.data(o.sortedDataCopy).radius(l).fillOpacity(null==o._fillOpacity?0:o._fillOpacity).showX(o._gridShowX).showY(o._gridShowY).stroke(o._gridStroke).strokeDasharray(o._gridStrokeDasharray);var s=a.cx+(n-i+o._fontSize)/2,u=a.cy;o.gridPolygon.translate(s,u).update(),o.coreGroup.call(E,s,u),t.update(),e.update()}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow),0!==Object.getOwnPropertyNames(e).length&&this.fillOpacity(e.fillOpacity).endPointRadius(e.endPointRadius).borderWidth(e.borderWidth)}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"widthOfNoMargin",get:function(){var t=this._width-3*this._marginLeft-this._marginRight;return 0<t?t:0}}]),n}(),mn="axis-group",xn="y-ranking-title",kn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-ranking"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return c(n,nt),a(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,r=t._tickValueTexts,a=void 0;a=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),a.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+mn).empty()?i.append("g").attr("class",mn):i.select("."+mn);if(s.transition().duration(t._transition?t._duration:0).call(a).on("start",function(){s.selectAll(".tick text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return r[e]}),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")}),t._titleShow&&t._title){var u=i.select("."+xn).empty()?i.append("g").attr("class",xn):i.select("."+xn),c=u.select("text").empty()?u.append("text"):u.select("text"),h=H(t._title,o,t._fontFamily);c.attr("x",h>=2*t.width?2-t.width:0).attr("y",-this._fontSize).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",h>=2*t.width?"start":"middle").text(t._title)}else i.select("."+xn).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,r=e._type,a=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);(t="category"===r?o.domain():o.ticks(e._tickCount)).push(1),t.splice(t.indexOf(0),1);var s=d3.max(t,function(t){return H(t,a,e._fontFamily)});return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,a,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),Sn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.grid=new vt(e.coreGroup),e.linePlot=new mt(e.coreGroup),e.scatterPlot=new ht(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new kn(e.mainGroup),e.overlay=new ke(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.guideScatter=new ht(e.coreGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._curve=d3.curveCardinal,e._showPoints=!0,e._marginRight=35,e._endPointRadius=2,e._lineShadowColor="#ccc",e._lineWidth=1,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var s=this,u=s.activeData,t=s.grid,e=s.linePlot,n=s.scatterPlot,i=s.clipArea,c=s.tooltip,o=s.overlay,h=s.guideLine,d=s.guideScatter,_=s.xScale,r=s.yScale,a=s.widthOfCore,l=s.heightOfCore;s.xAxis,s.yAxis;t.width(a).height(l).xTickLocations(s.xAxis.tickLocations.slice(1)).yTickLocations(s.yAxis.tickLocations).showX(s._gridShowX).showY(s._gridShowY).stroke(s._gridStroke).strokeDasharray(s._gridStrokeDasharray),e.data(u).xScale(_).yScale(r).fontSize(s._fontSize).labelShow(s._labelShow).positionOptions(s._positionOptions).positionChoice(s._positionChoice).lineWidth(s._lineWidth),n.data(u).xScale(_).yScale(r).radius(s._endPointRadius),h.y1(0).y2(l).strokeDasharray(s._gridStrokeDasharray),d.xScale(_).yScale(r).radius(5).fill("#fff"),o.width(a).height(l).onMouseover(function(){c.show(),h.show(),d.show()}).onMousemove(function(){var t=s.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=_.step(),o=Math.floor(n/i)+(.5<=n%i/i?1:0),r=_.domain()[o],a=[{text:r}],l=[];u.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});l.push({key:t.key,name:t.name,color:t.color,data:n}),a.push({text:t.name+": "+n[0].value,color:t.color})}),c.data(a).update().move([e[0]+_(r)-n,e[1]]),h.x(_(r)).update(),d.data(l).update()}).onMouseout(function(){c.hide(),h.hide(),d.hide()}),i.width(a).height(l).transition(s._transition).duration(s._duration),s.coreGroup.call(E,s.yAxis.width+.5,s.yAxis.titleHeight).attr("clip-path","url(#"+i.id+")"),d.elem.style("pointer-events","none"),o.update(),i.update(),t.update(),e.update(),s._showPoints?n.update().show():n.hide()}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})}),Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0)]:[1,0];this._xDomain=e,this._yDomain=n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._endPointRadius=e.endPointRadius?e.endPointRadius:this._endPointRadius,this._lineShadowColor=e.lineShadowColor?e.lineShadowColor:this._lineShadowColor,this._lineWidth=e.lineWidth?e.lineWidth:this._lineWidth),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice)}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}}]),n}(),wn="axis-group",bn="y-percent-title",On=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-percent"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return c(n,nt),a(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,r=t._tickValueTexts,a=void 0;a=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),a.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+wn).empty()?i.append("g").attr("class",wn):i.select("."+wn);if(s.transition().duration(t._transition?t._duration:0).call(a).on("start",function(){s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dx",.6*-o).attr("dy",.4*o).text(function(t,e){return 100*r[e]+"%"}),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")}),t._titleShow&&t._title){var u=i.select("."+bn).empty()?i.append("g").attr("class",bn):i.select("."+bn),c=u.select("text").empty()?u.append("text"):u.select("text"),h=H(t._title,o,t._fontFamily);c.attr("x",h>=2*t.width?2-t.width:0).attr("y",-this._fontSize).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",h>=2*t.width?"start":"middle").text(t._title)}else i.select("."+bn).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,r=e._type,a=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===r?o.domain():o.ticks(e._tickCount);var s=d3.max(t,function(t){return H(t,a,e._fontFamily)})+a;return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,a,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),Cn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var i=this,t=i._data,e=i.group.selectAll("g").data(t,function(t){return t.name});return e.exit().remove(),e.enter().append("g").merge(e).each(function(t){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return i._fillColor||t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("x",function(t,e){return i._xScale.step()*e+.15*i._xScale.step()}).attr("y",function(t){return i._yScale(t.total)}).attr("width",.7*i._xScale.step()).attr("height",function(t){return 0<i._yScale(1-t.percent)?i._yScale(1-t.percent):0});var n=d3.select(this).append("g").attr("class","percentageStackBarTexts").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return null==i._contentOption||null==i._contentChoice?t.value:0==i._contentOption.indexOf(i._contentChoice[0])?(100*parseFloat(t.percent)).toFixed(2)+"%":1==i._contentOption.indexOf(i._contentChoice[0])?t.value:void 0}).attr("fill",i._textObj.colorFunc).attr("font-size",i._fontSize).attr("x",function(t,e){return i._xScale.step()*e+.15*i._xScale.step()}).attr("y",function(t){return i._yScale(t.total)}).attr("text-anchor","middle").attr("dx",.35*i._xScale.step()).attr("dy",function(t){return null==i._positionOptions||null==i._positionChoice?0:0==i._positionOptions.indexOf(i._positionChoice)?i._yScale(1-t.percent)/2+.4*i._fontSize:1==i._positionOptions.indexOf(i._positionChoice)?i._yScale(1-t.percent)-.3*i._fontSize:void 0}).style("display",i._labelShow?"block":"none"),null!=i._labelShow&&null!=i._positionOptions&&null!=i._positionChoice&&null!=i._contentOption&&null!=i._contentChoice||d3.selectAll(".percentageStackBarTexts text").style("display","none"),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),An=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Cn(e.coreGroup),e.overlay=new ke(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new On(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["",""],e._contentChoice=[""],e}return c(n,ut),a(n,[{key:"updateCore",value:function(){for(var l=this,s=l.activeData,t=[],e=0;e<(0==s.length?0:s[0].data.length);e++){for(var n=0,i=0;i<s.length;i++)n+=parseInt(s[i].data[e].value);t.push(n)}for(var o=0;o<s.length;o++)for(var r=0;r<s[o].data.length;r++)s[o].data[r].percent=s[o].data[r].value/t[r];for(var a=0;a<s.length;a++)for(var u=0;u<s[a].data.length;u++)s[a].data[u].total=0==a?parseFloat(s[a].data[u].percent):s[a-1].data[u].total+parseFloat(s[a].data[u].percent);var c=s,h=l.grid,d=l.tooltip,_=l.rectPlot,f=l.overlay,p=l.selectOverlay,y=l.xScale,v=l.yScale,g=l.widthOfCore,m=l.heightOfCore;f.width(g).height(m).onMouseover(function(){d.show(),p.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=y.step(),o=Math.floor(n/i),r=y.domain()[o],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),p.translate(y(r),0),d.data(a).update().move([e[0],e[1]])}).onMouseout(function(){d.hide(),p.hide()}),_.data(c).xScale(y).yScale(v).fontSize(l._fontSize).fontColor(l._fontColor).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).contentOption(l._contentOption).contentChoice(l._contentChoice).rectObj({xFunc:function(t,e){return y.step()*e+.15*y.step()},yFunc:function(t,e){return v(t.total)},widthFunc:function(t){return.7*y.step()},heightFunc:function(t){return v(1-t.percent)}}).textObj({colorFunc:function(){return l._fontColor}}).fillOpacity(1).onMousemove(function(t){var e=l.elem.node().parentNode,n=d3.mouse(e),i=s[0].name,o=[{text:t.name},{text:i+": "+t.value,color:t.color}];d.show(),d.data(o).update().move([n[0],n[1]]),d3.select(this).style("cursor","pointer")}).onMouseout(function(){d.hide()}),h.width(g).height(m).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations.slice(1)).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),p.width(y.step()).height(m).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),_.update(),p.update(),f.update(),h.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e.display?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice)}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]);this._xDomain=e,this._yDomain=[0,1]}}]),n}(),Mn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-area-text"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._strokeWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return c(n,T),a(n,[{key:"update",value:function(){var n=this,t=n._data,e=n.group.selectAll("g").data(t,function(t){return t.name});return e.exit().remove(),e.enter().append("g").merge(e).each(function(t){var e=d3.select(this).append("g").attr("class","stackAreaTexts").selectAll("text").data(t.data.slice(1));e.exit().remove(),e.enter().append("text").merge(e).text(function(t){return null==n._contentOption||null==n._contentChoice?t.value:0==n._contentOption.indexOf(n._contentChoice[0])?(100*parseFloat(t.percent)).toFixed(1)+"%":1==n._contentOption.indexOf(n._contentChoice[0])?t.value:void 0}).attr("fill",n._textObj.colorFunc).attr("font-size",n._fontSize).attr("x",function(t,e){return n._xScale.step()*(e+1)+.15*n._xScale.step()}).attr("y",function(t){return n._yScale(t.total)}).attr("text-anchor","middle").attr("dx",.15*-n._xScale.step()).attr("dy",function(t){return null==n._positionOptions||null==n._positionChoice?0:0==n._positionOptions.indexOf(n._positionChoice)?0:1==n._positionOptions.indexOf(n._positionChoice)?n._fontSize:void 0}).style("display",n._labelShow?"block":"none")}),n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),Fn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percent-stack-area-chart"),e.grid=new vt(e.coreGroup),e.areaPlot=new dt(e.coreGroup),e.linePlot=new _t(e.coreGroup),e.percentareatext=new Mn(e.mainGroup),e.overlay=new ke(e.mainGroup),e.guideLine=new ct(e.coreGroup),e.guideScatter=new Be(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new On(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=1,e._curve=null,e._marginRight=35,e._marginTop=20,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["",""],e._contentChoice=[""],e}return c(n,ut),a(n,[{key:"updateCore",value:function(){for(var s=this,u=s.activeData,t=[],e=0;e<(0==u.length?0:u[0].data.length);e++){for(var n=0,i=0;i<u.length;i++)n+=parseInt(u[i].data[e].value);t.push(n)}for(var o=0;o<u.length;o++)for(var r=0;r<u[o].data.length;r++)u[o].data[r].percent=u[o].data[r].value/t[r];for(var a=0;a<u.length;a++)for(var l=0;l<u[a].data.length;l++)u[a].data[l].total=0==a?parseFloat(u[a].data[l].percent):u[a-1].data[l].total+parseFloat(u[a].data[l].percent);var c=s.grid,h=s.areaPlot,d=s.linePlot,_=s.percentareatext,f=s.guideScatter,p=s.tooltip,y=s.overlay,v=s.guideLine,g=s.clipArea,m=s.xScale,x=s.yScale,k=s.widthOfCore,S=s.heightOfCore;s.widthOfNoMargin,s.heightOfMainGroup;c.width(k).height(S).xTickLocations(s.xAxis.tickLocations.slice(1)).yTickLocations(s.yAxis.tickLocations.slice(1)).showX(s._gridShowX).showY(s._gridShowY).stroke(s._gridStroke).strokeDasharray(s._gridStrokeDasharray),h.data(u).xScale(m).yScale(x).curve(s._curve).areaFunc(d3.area().x(function(t){return m(t.name)}).y0(function(t){return x(t.total-t.percent)}).y1(function(t){return x(t.total)}).defined(function(t){return!isNaN(parseFloat(t.percent))})),d.data(u).xScale(m).yScale(x).curve(s._curve).lineFunc(d3.line().x(function(t){return m(t.name)}).y(function(t){return x(t.total)}).defined(function(t){return!isNaN(parseFloat(t.total))})),_.data(u).xScale(m).yScale(x).fontSize(s._fontSize).fontColor(s._fontColor).labelShow(s._labelShow).positionOptions(s._positionOptions).positionChoice(s._positionChoice).contentOption(s._contentOption).contentChoice(s._contentChoice).textObj({colorFunc:function(){return s._fontColor}}),f.data(u).xScale(m).yScale(x).fill("#fff"),v.y1(0).y2(S).strokeDasharray(s._gridStrokeDasharray),y.width(k).height(S).onMouseover(function(){p.show(),v.show(),f.show()}).onMousemove(function(){var t=s.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=m.step(),o=Math.floor(n/i)+(.5<=n%i/i?1:0),r=m.domain()[o],a=[{text:r}],l=[];u.forEach(function(t){var e=t.data.filter(function(t){return t.name===r});l.push({key:t.key,name:t.name,color:t.color,data:e}),a.push({text:t.name+": "+e[0].value,color:t.color})}),p.data(a).update().move([e[0]+m(r)-n,e[1]]),v.x(m(r)).update(),f.data(l).update()}).onMouseout(function(){p.hide(),v.hide(),f.hide()}),g.width(k).height(S).transition(s._transition).duration(s._duration),s.coreGroup.call(E,s.yAxis.width+.5,s.yAxis.titleHeight).attr("clip-path","url(#"+g.id+")"),f.elem.style("pointer-events","none"),c.update(),g.update(),h.update(),d.update(),_.translate(s.yAxis.width+.5,s.yAxis.titleHeight).update(),y.translate(s.yAxis.width+.5,s.yAxis.titleHeight).update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e.display?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice)}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]);this._xDomain=e,this._yDomain=[0,1]}}]),n}(),Rn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","arcDiagram-chart"),e._xScale=null,e._yScale=null,e._radius=function(){return 3},e._fill=null,e._stroke=null,e._strokeWidth=1,e._transition=!1,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e._sWidth=null,e._areaBorderColor="#fff",e._areaBorderWidth=1,e._sortMethod=null,e}return c(n,T),a(n,[{key:"update",value:function(){var n=this,t=n.group,i=n._data,e=n._sWidth,o=(n._sHeight,e/(i[0].length-1)),r=(n._xScale,n._yScale,n.arcFunc.startAngle(n._startAngle).endAngle(n._endAngle));r.setRadius=function(t){var e=.5*Math.abs(t.x2-t.x1);this.innerRadius(e-n._lineWidth/2).outerRadius(e+n._lineWidth/2)};var a=t.selectAll("path").data(i[1]);a.exit().remove(),a.merge(a.enter().append("path")).attr("transform",function(t,e){return t.x1=i[0][t.target].displayOrder*o,t.x2=i[0][t.source].displayOrder*o,"translate("+(t.x1+t.x2)/2+",0)"}).attr("d",function(t){return r.setRadius(t),r()}).style("stroke",function(t){return i[0][t.source].color}).style("stroke-width",0).style("fill",function(t){return i[0][t.source].color}).style("fill-opacity",n._lineOpacity).on("mouseover",n._onMouseover).on("mousemove",n._onMousemove).on("mouseout",n._onMouseout).transition().duration(n._transition?n._duration:0).ease(d3.easeLinear).on("start",n._onTransitionStart).on("end",n._onTransitionEnd);for(var l=1e8,s=0,u=0;u<i[0].length;u++)l=Math.min(l,i[0][u].value),s=Math.max(s,i[0][u].value);d3.select(".arc-groups").remove();var c=t.append("g").attr("class","arc-groups").selectAll("circle").data(i[0]);c.exit().remove();c.enter().append("circle").attr("cx",function(t){return t.displayOrder*o||0}).attr("cy",0).merge(c).style("fill",function(t){return t.color}).style("fill-opacity",n._lineOpacity).attr("r",function(t){return e=t.value,n=l,i=s,r=8,(o=3)+(Math.min(Math.max(e,n),i)-n)/(i-n)*(r-o)||3;var e,n,i,o,r}).attr("cx",function(t){return t.displayOrder*o||0}).attr("cy",0);d3.select(".arc-texts").remove();var h=t.append("g").attr("class","arc-texts").selectAll("text").data(i[0]);return h.exit().remove(),h.enter().append("text").text(function(t){return t.name}).attr("fill","red").attr("font-size",n._fontSize).attr("text-anchor","start").attr("x",function(t){return t.displayOrder*o||0}).attr("y",0).attr("transform",function(t){return"rotate(90 "+(t.displayOrder*o-.6*n._fontSize||0)+" "+.3*n._fontSize+" )"}),n}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"lineOpacity",value:function(t){return arguments.length?(this._lineOpacity=t,this):this._lineOpacity}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}}]),n}(),Wn=function(t){function n(t,e){return r(this,n),h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return c(n,z),a(n,[{key:"data",get:function(){var t,n,e=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),i=this.generateColorList(e.length);return n=i,(t=e)[0].forEach(function(t,e){t.color=n[e]}),t}}]),n}();function zn(t,e){var n=0,i=1,o=2;e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"targetCol"===t.function?i=t.index:"vCol"===t.function&&(o=t.index)});for(var r=[],a=t.length,l=[],s=[],u=1;u<a;u++){var c=t[u];l.push(c[n]),s.push(c[i])}var h=l.concat(s);Array.prototype.distinct=function(){var t,e,n=this.length;for(t=0;t<n;t++)for(e=t+1;e<n;e++)this[t]==this[e]&&(this.splice(e,1),n--,e--);return this};for(var d=h.distinct(),_=[],f=0;f<d.length;f++)_.push({name:d[f]});for(var p=[],y=1;y<a;y++){var v=t[y];p.push({source:d.indexOf(v[n]),target:d.indexOf(v[i]),s:v[n],t:v[i],value:v[o]})}for(var g=0;g<_.length;g++)_[g].value=0,_[g].displayOrder=g;return r.push(_),r.push(p),r[0].forEach(function(t,e){t.key=t.name+"-"+e}),r}var Ln=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","arcDiagram-chart"),e.arcDiagram=new Rn(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e.lineOpacity=.8,e.lineWidth=2,e}return c(n,L),a(n,[{key:"updateCore",value:function(){var a=this,t=a.activeData,l=[];l.push(C(t[0]));for(var e=[],n=0;n<l[0].length;n++)e.push(l[0][n].name);for(var s=M(e,a._fontSize,a._fontFamily),i=0;i<t[1].length;i++)-1==e.indexOf(t[1][i].s)||-1==e.indexOf(t[1][i].t)?t[1][i].active=!1:t[1][i].active=!0;l.push(C(t[1]));for(var o=0;o<l[0].length;o++)l[0][o].value=0,l[0][o].displayOrder=o;for(var r=0;r<l[1].length;r++)for(var u=0;u<l[0].length;u++)l[1][r].s==l[0][u].name&&(l[1][r].source=l[0][u].displayOrder),l[1][r].t==l[0][u].name&&(l[1][r].target=l[0][u].displayOrder);for(var c=0;c<l[1].length;c++){var h=l[1][c];l[0][h.source].value+=h.value,l[0][h.target].value+=h.value}var d=a.arcDiagram,_=a.widthOfNoMargin,f=(a.heightOfNoMargin,.9*_),p=a.heightOfMainGroup,y=a._startAngle,v=a._endAngle,g=function(t,e,n,i){var o=Math.min(t,e),r=o/2,a=.1*t/2,l=e/2+r/2-s/2;o==e&&(a=(t/.9-2*(r=.9*e-s/2))/2,l=1.1*r-s/2,t/2<r&&(a=.1*t/2,l=e/2+(r=t/2)/2-s/2));return{radius:r,cx:a,cy:l,quadrant:0}}(f,p),m=g.radius;a._innerRadius||a._innerRadiusRatio&&a._innerRadiusRatio;for(var x=1e8,k=0,S=0;S<l[0].length;S++)x=Math.min(x,l[0][S].value),k=Math.max(k,l[0][S].value);function w(t,e,n,i,o){return i+(Math.min(Math.max(t,e),n)-e)/(n-e)*(o-i)}d.data(l).startAngle(y).endAngle(v).sWidth(2*m).lineWidth(a.lineWidth).lineOpacity(a.lineOpacity).fontSize(a._fontSize).transition(a._transition).duration(a._duration).onTransitionEnd(function(t,e){}).onMouseover(function(t,e){d3.select(this).style("stroke-width",a._lineWidth/2);var n=d3.select(this)._groups[0][0].__data__.source,i=d3.select(this)._groups[0][0].__data__.target,o=d3.selectAll(".arc-groups circle").nodes();d3.select(o[n]).attr("r",function(t){return 1.3*(w(t.value,x,k,3,8)||3)}),d3.select(o[i]).attr("r",function(t){return 1.3*(w(t.value,x,k,3,8)||3)});var r=[{text:l[0][t.source].name+""+l[0][t.target].name+""+t.value,color:l[0][t.source].color}];a.tooltip.data(r).update().show()}).onMousemove(function(){d3.select(this).style("stroke-width",a._lineWidth/2);var t=d3.select(this)._groups[0][0].__data__.source,e=d3.select(this)._groups[0][0].__data__.target,n=d3.selectAll(".arc-groups circle").nodes();d3.select(n[t]).attr("r",function(t){return 1.3*(w(t.value,x,k,3,8)||3)}),d3.select(n[e]).attr("r",function(t){return 1.3*(w(t.value,x,k,3,8)||3)}),a.tooltip.move()}).onMouseout(function(t){d3.select(this).style("stroke-width",0);var e=d3.select(this)._groups[0][0].__data__.source,n=d3.select(this)._groups[0][0].__data__.target,i=d3.selectAll(".arc-groups circle").nodes();d3.select(i[e]).attr("r",function(t){return w(t.value,x,k,3,8)||3}),d3.select(i[n]).attr("r",function(t){return w(t.value,x,k,3,8)||3}),a.tooltip.hide()});var b=g.cx,O=g.cy;a.arcDiagram.translate(b||0,O||0).update()}},{key:"configLegend",value:function(){var e=this,i=e.sortedDataCopy;e.legend.data(i[0]).onClick(function(t){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i[0].forEach(function(e){e.key===t.key&&(e.active=!n),i[1].forEach(function(t){e.active==!n&&(t.s!=e.name&&t.t!=e.name||(t.active=!n))})}),e.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new Wn(t,e),i=zn;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display;0!==Object.getOwnPropertyNames(e).length&&(this.lineOpacity=e.lineOpacity?e.lineOpacity:this.lineOpacity,this.lineWidth=e.lineWidth?e.lineWidth:this.lineWidth)}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}}]),n}(),Tn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","basic-horizontal-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Te(e.coreGroup),e.overlay=new ke(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e.barWidthPercent=.7,e.barCornerRadius=0,e.borderWidth=1,e.borderColor="#000",e.fillOpacity=1,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var l=this,s=l.activeData,u=s.toString()?s[0].data:[],t=l.grid,e=l.rectPlot,c=l.tooltip,n=l.overlay,h=l.selectOverlay,i=l.barWidthPercent?l.barWidthPercent:.8,o=l.xScale,d=l.yScale,r=l.widthOfCore,a=l.heightOfCore,_=d.step();t.width(r).height(a).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),n.width(r).height(a).onMouseover(function(){c.show(),h.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[1],i=d.step(),o=Math.floor(n/i),r=d.domain()[u.length-o-1==-1?0:u.length-o-1],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),h.translate(0,d(r)),c.data(a).update().move([e[0],e[1]])}).onMouseout(function(){c.hide(),h.hide()}),h.width(r).height(d.step()).shadowColor(l._shadowColor).hide(),e.data(u).xScale(o).yScale(d).fontSize(l._fontSize).barCornerRadius(l.barCornerRadius).borderWidth(l.borderWidth).borderColor(l.borderColor).fillOpacity(l.fillOpacity).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).rectObj({xFunc:function(){return 0},yFunc:function(t,e){return l.yScale.range()[0]-(e*_+(_-.7*_*i)/2+.7*_*i)},widthFunc:function(t){return 0<l.xScale(t.value)?l.xScale(t.value):0},heightFunc:function(t){return.7*_*i}}).textObj({xFunc:function(t,e){return l.xScale(t.value)},yFunc:function(t,e){return l.yScale.range()[0]-(e*_+(_-.7*_*i)/2+.7*_*i)},dyFunc:.7*_*i/2+l._fontSize/3,colorFunc:function(){return l._fontColor},textFunc:function(t){return t.value},fontSize:l._fontSize,labelShow:l._labelShow}),l.coreGroup.call(E,l.yAxis.width+.5,l.yAxis.titleHeight),t.update(),h.update(),e.updateHorizontalBar(),n.update()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,r=t._xType,a=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(r).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),o.domain(t._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(a).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var d=n?n.titleHeight:0;t.data().forEach(function(t){t.data.forEach(function(t){})});var _=t._tickCount?t._tickCount:(c-n.allowedMaxTextWidth())/(6*u);i.nice(),e.tickCount(_).compute(),o.range([h-d-e.height,0]),n.compute(),i.nice().range([0,c-n.width]),e.compute();var f=n.width,p=h-e.height,y=n.width,v=d;e.translate(f,p).update(),n.translate(y,v).update()}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._xDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[""],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])],this._yDomain=n}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=Xe;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display;0!==Object.getOwnPropertyNames(e).length&&(this.barWidthPercent=e.barWidthPercent?e.barWidthPercent:this.barWidthPercent,this.barCornerRadius=e.barCornerRadius?e.barCornerRadius:this.barCornerRadius,this.borderWidth=e.borderWidth?e.borderWidth:this.borderWidth,this.borderColor=e.borderColor?e.borderColor:this.borderColor,this.fillOpacity=e.fillOpacity?e.fillOpacity:this.fillOpacity)}}]),n}(),Pn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var i=this,t=i._data,o=i.group;console.log(t);var e=o.selectAll("g").data(t,function(t){return t.name});return e.exit().remove(),e.enter().append("g").merge(e).each(function(t){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return i._fillColor||t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("x",function(t,e){return i._xScale.step()*e+.15*i._xScale.step()}).attr("y",function(t){return i._yScale(t.total)}).attr("width",.7*i._xScale.step()).attr("height",function(t){return 0<i._yScale(0)-i._yScale(t.value)?i._yScale(0)-i._yScale(t.value):0});var n=d3.select(this).append("g").attr("class","stackBarTexts").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return t.value}).attr("fill",i._textObj.colorFunc).attr("font-size",i._fontSize).attr("x",function(t,e){return i._xScale.step()*e+.15*i._xScale.step()}).attr("y",function(t){return i._yScale(t.total)}).attr("text-anchor","middle").attr("dx",.35*i._xScale.step()).attr("dy",function(t){return null==i._positionOptions||null==i._positionChoice?0:0==i._positionOptions.indexOf(i._positionChoice)?(i._yScale(0)-i._yScale(t.value))/2+.4*i._fontSize:1==i._positionOptions.indexOf(i._positionChoice)?i._yScale(0)-i._yScale(t.value)-.2*i._fontSize:void 0}).style("display",function(t){return i._labelShow&&t.textShow?"block":"none"}),null==i._labelShow||null==i._positionOptions||null==i._positionChoice||-1==i._positionOptions.indexOf(i._positionChoice)?o.selectAll(".stackBarTexts").style("display","none"):o.selectAll(".stackBarTexts").style("display","block"),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Dn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Pn(e.coreGroup),e.overlay=new ke(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){for(var l=this,s=l.activeData,t=0;t<(0==s.length?0:s[0].data.length);t++)for(var e=0;e<s.length;e++)parseInt(s[e].data[t].value);for(var n=0;n<s.length;n++)for(var i=0;i<s[n].data.length;i++)s[n].data[i].total=0==n?parseFloat(s[n].data[i].value):s[n-1].data[i].total+parseFloat(s[n].data[i].value),l.yScale(0)-l.yScale(s[n].data[i].value)<l._fontSize?s[n].data[i].textShow=!1:s[n].data[i].textShow=!0;var o=s,r=l.grid,u=l.tooltip,a=l.rectPlot,c=l.overlay,h=l.selectOverlay,d=l.clipArea,_=l.xScale,f=l.yScale,p=l.widthOfCore,y=l.heightOfCore;c.width(p).height(y).onMouseover(function(){u.show(),h.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=_.step(),o=Math.floor(n/i),r=_.domain()[o],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),h.translate(_(r),0),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),h.hide()}),a.data(o).xScale(_).yScale(f).fontSize(l._fontSize).fontColor(l._fontColor).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).contentOption(l._contentOption).contentChoice(l._contentChoice).textObj({colorFunc:function(){return l._fontColor}}).fillOpacity(1),r.width(p).height(y).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations.slice(1)).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),d.width(p).height(y).paddingVertical([0,0]).transition(l._transition).duration(l._duration),h.width(_.step()).height(y).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),0!=l._clipShow.length&&(l.coreGroup.attr("clip-path","url(#"+d.id+")"),d.update()),a.update(),h.update(),c.update(),r.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice)}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)t[e].data[n].total=0==e?parseFloat(t[e].data[n].value):t[e-1].data[n].total+parseFloat(t[e].data[n].value);var i=this._yDomain||[],o=t.length?t[0].data.map(function(t){return t.name}):[0,1],r=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total+1})}),0)]:[0,1];this._xDomain=o,this._yDomain=[isNaN(parseFloat(i[0]))?r[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?r[1]:parseFloat(i[1])]}}]),n}(),jn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-horizontal-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var i=this,t=i._data,o=i.group,e=o.selectAll("g").data(t,function(t){return t.name});return e.exit().remove(),e.enter().append("g").merge(e).each(function(t){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return i._fillColor||t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("y",function(t,e){return i._yScale(t.name)+.15*i._yScale.step()}).attr("x",function(t){return i._xScale(t.total)-i._xScale(t.value)}).attr("height",.7*i._yScale.step()).attr("width",function(t){return 0<i._xScale(t.value)?i._xScale(t.value):0});var n=d3.select(this).append("g").attr("class","stackHorizontalBarTexts").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return t.value}).attr("fill",i._textObj.colorFunc).attr("font-size",i._fontSize).attr("y",function(t,e){return i._yScale(t.name)+.15*i._yScale.step()}).attr("x",function(t){return i._xScale(t.total)}).attr("dy",i._yScale.step()/2-i._fontSize/4).attr("dx",function(t,e){return null==i._labelShow||null==i._positionOptions||null==i._positionChoice?0:0==i._positionOptions.indexOf(i._positionChoice)?-i._xScale(t.value)+.3*i._fontSize:1==i._positionOptions.indexOf(i._positionChoice)?-i._xScale(t.value)/2-k(d3.select(d3.selectAll(".stackHorizontalBarTexts text").nodes()[e])).width/2+.3*i._fontSize:void 0}).style("display",i._labelShow?"block":"none"),null==i._labelShow||null==i._positionOptions||null==i._positionChoice?o.selectAll(".stackHorizontalBarTexts").style("display","none"):o.selectAll(".stackHorizontalBarTexts").style("display","block"),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Gn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-horizontal-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new jn(e.coreGroup),e.overlay=new ke(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){for(var l=this,s=l.activeData,t=0;t<(0==s.length?0:s[0].data.length);t++)for(var e=0;e<s.length;e++)parseInt(s[e].data[t].value);for(var n=0;n<s.length;n++)for(var i=0;i<s[n].data.length;i++)s[n].data[i].total=0==n?parseFloat(s[n].data[i].value):s[n-1].data[i].total+parseFloat(s[n].data[i].value);var o=s,r=l.grid,u=l.tooltip,a=l.rectPlot,c=l.overlay,h=l.selectOverlay,d=l.xScale,_=l.yScale,f=l.widthOfCore,p=l.heightOfCore;c.width(f).height(p).onMouseover(function(){u.show(),h.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[1],i=_.step(),o=Math.floor(n/i),r=_.domain()[_.domain().length-o-1==-1?0:_.domain().length-o-1],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),h.translate(0,_(r)),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),h.hide()}),a.data(o).xScale(d).yScale(_).fontSize(l._fontSize).fontColor(l._fontColor).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).contentOption(l._contentOption).contentChoice(l._contentChoice).textObj({colorFunc:function(){return l._fontColor}}).fillOpacity(1),r.width(f).height(p).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),h.width(f).height(_.step()).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),a.update(),h.update(),c.update(),r.update()}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,r=e._xType,a=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e.widthOfNoMargin,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(r).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(a).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).transition(e._transition).duration(e._duration);var d=n?n.titleHeight:0;e.data().forEach(function(t){t.data.forEach(function(t){})});var _=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(6*u);i.nice(),t.tickCount(_).compute();var f=(c-n.width)/t._tickValues.length,p=d3.max(t._tickValues,function(t){return H(t,u,e._fontFamily)}),y=(t._tickShow?t._tickSize+t._tickPadding+(p<f?1.125*t._fontSize*1.5:1.5*t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-d-y,0]),n.compute(),i.nice().range([0,c-n.width]),t.compute();var v=n.width,g=h-t.height,m=n.width,x=d;t.translate(v,g).update(),n.translate(m,x).update()}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)t[e].data[n].total=0==e?parseFloat(t[e].data[n].value):t[e-1].data[n].total+parseFloat(t[e].data[n].value);this._yDomain;var i=t.length?t[0].data.map(function(t){return t.name}):[0,1],o=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})}),0)]:[0,1];this._xDomain=o,this._yDomain=i}}]),n}(),Bn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var o=this,r=o._data,a=o.group,t=a.selectAll("g").data(r,function(t){return t.name});return t.exit().remove(),t.enter().append("g").merge(t).each(function(t,n){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return o._fillColor||t.color}).style("fill-opacity",function(t){return o._fillOpacity}).style("stroke",function(t){return o._strokeColor||t.color}).style("stroke-width",function(t){return o._strokeWidth||0}).attr("x",function(t,e){return(.7*o._xScale.step()/r.length+.1*o._xScale.step()/(r.length-1==0?1:r.length-1))*n+.1*o._xScale.step()+o._xScale.step()*e+(1==r.length?.1*o._xScale.step()/2:0)}).attr("y",function(t){return o._yScale(t.value)}).attr("width",0<.7*o._xScale.step()/r.length?.7*o._xScale.step()/r.length:0).attr("height",function(t){return 0<o._yScale(0)-o._yScale(t.value)?o._yScale(0)-o._yScale(t.value):0});var i=d3.select(this).append("g").attr("class","groupedBarTexts").selectAll("text").data(t.data);i.exit().remove(),i.enter().append("text").merge(i).text(function(t){return t.value}).attr("fill",o._textObj.colorFunc).attr("font-size",o._fontSize).attr("x",function(t,e){return(.7*o._xScale.step()/r.length+.1*o._xScale.step()/(r.length-1==0?1:r.length-1))*n+.1*o._xScale.step()+o._xScale.step()*e+(1==r.length?.1*o._xScale.step()/2:0)}).attr("y",function(t){return o._yScale(t.value)}).attr("text-anchor","middle").attr("dx",(0<.7*o._xScale.step()/r.length?.7*o._xScale.step()/r.length:0)/2).attr("dy",function(t){return null==o._positionOptions||null==o._positionChoice?0:0==o._positionOptions.indexOf(o._positionChoice)?.3*-o._fontSize:1==o._positionOptions.indexOf(o._positionChoice)?o._yScale(0)-o._yScale(t.value)-.3*o._fontSize:void 0}).style("display",o._labelShow?"block":"none"),null==o._labelShow||null==o._positionOptions||null==o._positionChoice?a.selectAll(".groupedBarTexts").style("display","none"):a.selectAll(".groupedBarTexts").style("display","block"),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),o}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Nn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Bn(e.coreGroup),e.overlay=new ke(e.coreGroup),e.clipArea=new ft(e.defs),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var l=this,s=l.activeData,t=s,e=l.grid,u=l.tooltip,n=l.rectPlot,i=l.overlay,c=l.selectOverlay,o=l.clipArea,h=l.xScale,r=l.yScale,a=l.widthOfCore,d=l.heightOfCore;d3.selectAll(".grouped-bar-chart .axis-x line").attr("transform","translate("+h.step()/2+", 0)"),i.width(a).height(d).onMouseover(function(){u.show(),c.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=h.step(),o=Math.floor(n/i),r=h.domain()[o],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),c.translate(h(r),0),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),c.hide()}),n.data(t).xScale(h).yScale(r).fontSize(l._fontSize).fontColor(l._fontColor).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).textObj({colorFunc:function(){return l._fontColor}}).fillOpacity(1),e.width(a).height(d).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations.slice(1)).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),o.width(a).height(d).paddingVertical([0,0]).transition(l._transition).duration(l._duration),c.width(h.step()).height(d).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),0!=l._clipShow.length&&(l.coreGroup.attr("clip-path","url(#"+o.id+")"),o.update()),n.update(),c.update(),i.update(),e.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice)}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}(),En=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-horizontal-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var i=this,o=i._data,t=i.group.selectAll("g").data(o,function(t){return t.name});return t.exit().remove(),t.enter().append("g").merge(t).each(function(t,n){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return i._fillColor||t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("y",function(t,e){return i._yScale.range()[0]-((.7*i._yScale.step()/o.length+.1*i._yScale.step()/(o.length-1==0?1:o.length-1))*n+.06*i._yScale.step()+.8*i._yScale.step()/o.length+i._yScale.step()*e+(1==o.length?.1*i._yScale.step()/2:0))}).attr("x",function(t){return 0<i._xScale(0)-i._xScale(t.value)?i._xScale(0)-i._xScale(t.value):0}).attr("height",0<.7*i._yScale.step()/o.length?.7*i._yScale.step()/o.length:0).attr("width",function(t){return 0<i._xScale(t.value)?i._xScale(t.value):0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Hn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-horizontal-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new En(e.coreGroup),e.overlay=new ke(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var l=this,s=l.activeData,t=s,e=l.grid,u=l.tooltip,n=l.rectPlot,i=l.overlay,c=l.selectOverlay,o=l.xScale,h=l.yScale,r=l.widthOfCore,a=l.heightOfCore;d3.selectAll(".grouped-horizontal-bar-chart .axis-y line").attr("transform","translate(0,"+h.step()/2+")"),i.width(r).height(a).onMouseover(function(){u.show(),c.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[1],i=h.step(),o=Math.floor(n/i),r=h.domain()[h.domain().length-o-1==-1?0:h.domain().length-o-1],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),c.translate(0,h(r)),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),c.hide()}),n.data(t).xScale(o).yScale(h).fontSize(l._fontSize).fontColor(l._fontColor).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).contentOption(l._contentOption).contentChoice(l._contentChoice).textObj({colorFunc:function(){return l._fontColor}}).fillOpacity(1),e.width(r).height(a).xTickLocations(l.xAxis.tickLocations.slice(1)).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),c.width(r).height(h.step()).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),n.update(),c.update(),i.update(),e.update()}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,r=e._xType,a=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e.widthOfNoMargin,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(r).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(a).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).transition(e._transition).duration(e._duration);var d=n?n.titleHeight:0;e.data().forEach(function(t){t.data.forEach(function(t){})});var _=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(6*u);i.nice(),t.tickCount(_).compute();var f=(c-n.width)/t._tickValues.length,p=d3.max(t._tickValues,function(t){return H(t,u,e._fontFamily)}),y=(t._tickShow?t._tickSize+t._tickPadding+(p<f?1.125*t._fontSize*1.5:1.5*t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-d-y,0]),n.compute(),i.nice().range([0,c-n.width]),t.compute();var v=n.width,g=h-t.height,m=n.width,x=d;t.translate(v,g).update(),n.translate(m,x).update()}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})}),0)]:[0,1];this._xDomain=n,this._yDomain=e}}]),n}(),In=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","negative-horizontal-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return c(n,T),a(n,[{key:"update",value:function(){var i=this,o=i._data,t=i.group.selectAll("g").data(o,function(t){return t.name});return t.exit().remove(),t.enter().append("g").merge(t).each(function(t,n){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return i._fillColor||t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("y",function(t,e){return i._yScale.range()[0]-((.7*i._yScale.step()/o.length+.1*i._yScale.step()/(o.length-1==0?1:o.length-1))*n+.06*i._yScale.step()+.8*i._yScale.step()/o.length+i._yScale.step()*e+(1==o.length?.1*i._yScale.step()/2:0))}).attr("x",function(t){return 0<t.value?i._xScale(0):t.value<0?i._xScale(t.value):void 0}).attr("height",.7*i._yScale.step()/o.length).attr("width",function(t){return 0<t.value?i._xScale(t.value)-i._xScale(0):t.value<0?i._xScale(0)-i._xScale(t.value):void 0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Vn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","negative-horizontal-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new In(e.coreGroup),e.overlay=new ke(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._gridStrokeDasharray="0 0",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var l=this,s=l.activeData,t=s,e=l.grid,u=l.tooltip,n=l.rectPlot,i=l.overlay,c=l.selectOverlay,o=l.xScale,h=l.yScale,r=l.widthOfCore,a=l.heightOfCore;d3.min(s,function(t){return d3.min(t.data,function(t){return+t.value})})<0?(d3.selectAll(".negative-horizontal-bar-chart .axis-y path").attr("transform","translate("+-(o.range()[0]-o(0))+",0)"),d3.selectAll(".negative-horizontal-bar-chart .y-title text").attr("transform","translate("+-(o.range()[0]-o(0))+",0)"),d3.selectAll(".negative-horizontal-bar-chart .axis-y line").attr("transform","translate("+-(o.range()[0]-o(0))+","+-h.step()/2+")")):(d3.selectAll(".negative-horizontal-bar-chart .axis-y path").attr("transform","translate(0,0)"),d3.selectAll(".negative-horizontal-bar-chart .y-title text").attr("transform","translate(0,0)"),d3.selectAll(".negative-horizontal-bar-chart .axis-y line").attr("transform","translate(0,"+-h.step()/2+")")),i.width(r).height(a).onMouseover(function(){u.show(),c.show()}).onMousemove(function(){var t=l.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[1],i=h.step(),o=Math.floor(n/i),r=h.domain()[h.domain().length-o-1==-1?0:h.domain().length-o-1],a=[{text:r}];s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===r});a.push({text:t.name+": "+n[0].value,color:t.color})}),c.translate(0,h(r)),u.data(a).update().move([e[0],e[1]])}).onMouseout(function(){u.hide(),c.hide()}),n.data(t).xScale(o).yScale(h).fontSize(l._fontSize).fontColor(l._fontColor).labelShow(l._labelShow).positionOptions(l._positionOptions).positionChoice(l._positionChoice).contentOption(l._contentOption).contentChoice(l._contentChoice).textObj({colorFunc:function(){return l._fontColor}}).fillOpacity(1),e.width(r).height(a).xTickLocations(l.xAxis.tickLocations).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),c.width(r).height(h.step()).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+l.yAxis.width+","+l.yAxis.titleHeight+")"),n.update(),c.update(),i.update(),e.update()}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,r=e._xType,a=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e.widthOfNoMargin,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(r).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(a).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).transition(e._transition).duration(e._duration);var d=n?n.titleHeight:0;e.data().forEach(function(t){t.data.forEach(function(t){})});var _=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(6*u);i.nice(),t.tickCount(_).compute();var f=(c-n.width)/t._tickValues.length,p=d3.max(t._tickValues,function(t){return H(t,u,e._fontFamily)}),y=(t._tickShow?t._tickSize+t._tickPadding+(p<f?1.125*t._fontSize*1.5:1.5*t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-d-y,0]),n.compute(),i.nice().range([0,c-n.width]),t.compute();var v=n.width,g=h-t.height,m=n.width,x=d;t.translate(v,g).update(),n.translate(m,x).update()}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})}),0)]:[0,1];this._xDomain=n,this._yDomain=e}}]),n}(),Yn="axis-group",Xn="y-mix-title",Qn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-mix"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return c(n,nt),a(n,[{key:"update",value:function(){var n=this,i=n._orient,t=n._scaleFunc,e=n.group,o=n._fontSize,r=n._tickValueTexts,a=void 0;a=n.axisFunc="right"===i?d3.axisRight(t):d3.axisLeft(t);var l=null;"number"===n._type&&n._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),a.tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding).tickFormat(l),e.select(".axis-group").remove();var s=e.select("."+Yn).empty()?e.append("g").attr("class",Yn):e.select("."+Yn);if(s.transition().duration(n._transition?n._duration:0).call(a).on("start",function(){s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dx",function(t,e){return"left"==i?.6*-o:"right"==i?.6*o:void 0}).attr("dy",.4*o).text(function(t,e){return r[e]+(n._unit?n._unit:"")}),s.selectAll(".tick line").style("stroke",n._lineStroke),s.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")}),n._titleShow&&n._title){var u=e.select("."+Xn).empty()?e.append("g").attr("class",Xn):e.select("."+Xn),c=u.select("text").empty()?u.append("text"):u.select("text"),h=H(n._title,o,n._fontFamily);c.attr("x",h>=2*n.width?2-n.width:0).attr("y",-this._fontSize).style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).style("text-anchor",h>=2*n.width?"start":"middle").text(n._title)}else e.select("."+Xn).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,r=e._type,a=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===r?o.domain():o.ticks(e._tickCount);for(var s=0;s<t.length;s++)t[s]=t[s]+(e._unit?e._unit:"");var u=d3.max(t,function(t){return H(t,a,e._fontFamily)});return t="category"===r?o.domain():o.ticks(e._tickCount),u<=l?(n=t,i=u):(n=t.map(function(t){return I(t,l,a,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),qn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-tooltip"),e._width=0,e._height=0,e._shadowColor="#000",e}return c(n,T),a(n,[{key:"update",value:function(){var t=this._data,e=this.group;d3.selectAll("filter").remove();var n=this._defs.append("filter").attr("x","-15%").attr("y","-25%").attr("width","135%").attr("height","150%").attr("id","bg");n.append("feFlood").attr("flood-color","black"),n.append("feComposite").attr("in","SourceGraphic");var i=e.selectAll("text").attr("class","axis-tooltip-text").data(t);i.exit().remove();i.enter().append("g").append("text").merge(i).text(function(t){return t.text}).attr("filter","url(#bg)").style("fill","white").style("fill-opacity",1).style("opacity",.8).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("dy","0.4em").attr("font-size",10).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);return this}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),n}();function Zn(t,e){var n=0,i=0;e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&""==t.name&&(i=t.index)});for(var o={},r=[],a=t.length,l=t[0],s=1;s<l.length;s++)s!==n&&l[s]&&(o[l[s]]=s==i?{name:l[s],data:[],type:""}:{name:l[s],data:[]});for(var u=1;u<a;u++){var c=t[u],h=c[n];if(h)for(var d=0;d<c.length;d++){var _=l[d];d!==n&&_&&o[_].data.push({name:h,value:c[d]})}}for(var f in o)r.push(o[f]);return r.forEach(function(t,e){t.key=t.name+"-"+e}),r}var Un=function(t){function o(t){r(this,o);var e=h(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.elem.attr("class","mix-line-bar-chart"),e.grid=new vt(e.coreGroup),e.selectOverlay=new Ee(e.coreGroup),e.rectPlot=new Bn(e.coreGroup),e.linePlot=new _t(e.coreGroup),e.scatterPlot=new ht(e.coreGroup),e.guideLine=new ct(e.coreGroup),e.overlay=new ke(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new Qn(e.mainGroup),e.yAxisDoubleY=new Qn(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e.yScaleRight=d3.scaleLinear(),e.axisTooltip=new qn(e.mainGroup),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yOrientRight="right",e._sortValue=0,e._curve=null,e._histogramWidth=.7,e._yScaleHeight=1.05,e}return c(o,ut),a(o,[{key:"updateCore",value:function(){var u=this,c=u.activeData,t=c,e=u.grid,h=u.tooltip,d=u.axisTooltip,n=u.rectPlot,i=(u.linePlot,u.overlay),_=(u.scatterPlot,u.selectOverlay),f=u.guideLine,p=u.xScale,y=u.yScale,v=u.yScaleRight;d3.selectAll(".mix-line-bar-chart .axis-x line").attr("transform","translate("+p.step()/2+", 0)");var g=u.yAxisDoubleY.width;0==c.filter(function(t){return""==t.type}).length&&(g=u.yAxis.width),0==c.filter(function(t){return""!=t.type}).length&&(g=u.yAxisDoubleY.width);var m=u.widthOfNoMargin-g,o=u.heightOfCore;e.width(m-g+5).height(o).xTickLocations(u.xAxis.tickLocations.slice(1)).yTickLocations(u.yAxis.tickLocations.slice(1)).showX(u._gridShowX).showY(u._gridShowY).stroke(u._gridStroke).strokeDasharray(u._gridStrokeDasharray),0==c.filter(function(t){return""==t.type}).length&&(m=u.widthOfNoMargin,e.width(m-g+5).height(o).xTickLocations(u.xAxis.tickLocations.slice(1)).yTickLocations(u.yAxis.tickLocations.slice(1)).showX(u._gridShowX).showY(u._gridShowY).stroke(u._gridStroke).strokeDasharray(u._gridStrokeDasharray)),0==c.filter(function(t){return""!=t.type}).length&&(m=u.widthOfNoMargin,e.width(m-g+5).height(o).xTickLocations(u.xAxis.tickLocations.slice(1)).yTickLocations(u.yAxisDoubleY.tickLocations.slice(1)).showX(u._gridShowX).showY(u._gridShowY).stroke(u._gridStroke).strokeDasharray(u._gridStrokeDasharray)),0==c.length&&(m=u.widthOfNoMargin-g,e.width(m-g+5).height(o).xTickLocations(u.xAxis.tickLocations.slice(1)).yTickLocations(u.yAxis.tickLocations.slice(1)).showX(u._gridShowX).showY(u._gridShowY).stroke(u._gridStroke).strokeDasharray(u._gridStrokeDasharray)),i.width(0<m-g?m-g:0).height(o).onMouseover(function(){h.show(),d.show(),f.show(),_.show();var t=u.elem.node().parentNode,e=(d3.mouse(t),d3.mouse(this)[0]),n=p.step(),i=Math.floor(e/n);d3.select(d3.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes()[i]).attr("r",5),d3.selectAll(d3.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes().filter(function(t,e){return e!=i})).attr("r",2)}).onMousemove(function(){var t=u.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=d3.mouse(this)[1],o=p.step(),r=Math.floor(n/o),a=p.domain()[r],l=[{text:a}];c.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===a});l.push({text:t.name+": "+n[0].value,color:t.color})}),_.translate(p(a),0),f.y(i).update(),h.data(l).update().move([e[0],e[1]]);var s=[{text:parseFloat(y.invert(i)).toFixed(2),x:0,y:i},{text:parseFloat(v.invert(i)).toFixed(2),x:m-g+14-(0==c.filter(function(t){return""!=t.type}).length?g:0),y:i},{text:a,x:p(a)-(0==c.filter(function(t){return""!=t.type}).length?g:0),y:u.heightOfMainGroup-u.xAxis.height}];d.data(s).defs(u.defs).translate(g,u.yAxis.titleHeight).update(),d3.select(".axis-tooltip g g").attr("transform","translate("+(-k(d3.select(".axis-tooltip g g")).width-10)+", 0)"),d3.select(d3.selectAll(".axis-tooltip g g").nodes()[2]).attr("transform","translate("+(p.step()-k(d3.select(d3.selectAll(".axis-tooltip g g").nodes()[2])).width)/2+","+k(d3.select(d3.selectAll(".axis-tooltip g g").nodes()[2])).height+")"),0==c.filter(function(t){return""!=t.type}).length?d3.select(".axis-tooltip g g").style("display","none"):d3.select(".axis-tooltip g g").style("display","block"),0==c.filter(function(t){return""==t.type}).length?d3.select(d3.selectAll(".axis-tooltip g g").nodes()[1]).style("display","none"):d3.select(d3.selectAll(".axis-tooltip g g").nodes()[1]).style("display","block"),0==c.length?d3.select(d3.selectAll(".axis-tooltip g g").nodes()[2]).style("display","none"):d3.select(d3.selectAll(".axis-tooltip g g").nodes()[2]).style("display","block"),d3.select(d3.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes()[r]).attr("r",5),d3.selectAll(d3.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes().filter(function(t,e){return e!=r})).attr("r",2)}).onMouseout(function(){h.hide(),d.hide(),f.hide(),_.hide(),d3.selectAll(d3.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes()).attr("r",2)}),n.data(t).xScale(p).yScale(y).fontSize(u._fontSize).fontColor(u._fontColor).labelShow(u._labelShow).positionOptions(u._positionOptions).positionChoice(u._positionChoice).contentOption(u._contentOption).contentChoice(u._contentChoice).textObj({colorFunc:function(){return u._fontColor}}).fillOpacity(1),f.x1(0).x2(m-g+5).strokeDasharray(u._gridStrokeDasharray),_.width(p.step()).height(o).shadowColor("#ccc").hide(),u.coreGroup.attr("transform","translate("+g+","+u.yAxis.titleHeight+")"),0==c.filter(function(t){return""==t.type}).length&&u.coreGroup.attr("transform","translate("+g+","+u.yAxis.titleHeight+")"),0==c.filter(function(t){return""!=t.type}).length&&u.coreGroup.attr("transform","translate(0,"+u.yAxis.titleHeight+")"),0==c.length&&u.coreGroup.attr("transform","translate("+g+","+u.yAxis.titleHeight+")"),n.update(),_.update(),i.update(),e.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.yAxisDoubleY,o=t.xScale,r=t.yScale,a=t.yScaleRight,l=t._xType,s=t._yType,u=t._xOrient,c=t._yOrient,h=t._yOrientRight,d=t._fontSize,_=t.widthOfNoMargin,f=t.heightOfMainGroup;o.domain(t._xDomain),r.domain(t._yDomain),a.domain(t._yDomain1),e.scaleFunc(o).allowedMaxTextHeight(.3*f).type(l).orient(u).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),n.scaleFunc(r).allowedMaxTextWidth(.5*_).type(s).orient(c).title(t._yLeftName).unit(t._yLeftTitle?t._yLeftTitle:null).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),i.scaleFunc(a).allowedMaxTextWidth(.5*_).type(s).orient(h).title(t._yRightName).unit(t._yRightTitle?t._yRightTitle:null).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var p=n.titleHeight,y=f/(3*d);n.compute(),i.compute();var v=t.activeData,g=i.width;0==v.filter(function(t){return""==t.type}).length&&(g=n.width),0==v.filter(function(t){return""!=t.type}).length&&(g=i.width),o.range([0,_-2*g+5]),0==v.filter(function(t){return""==t.type}).length&&o.range([0,_-g+5]),0==v.filter(function(t){return""!=t.type}).length&&o.range([0,_-g+5]),0==v.length&&o.range([0,_-2*g+5]),e.compute(),n.tickCount(y),i.tickCount(y),r.nice().range([f-p-e.height,0]),a.nice().range([f-p-e.height,0]);var m=g,x=f-e.height,k=g,S=p;e.translate(m,x),n.translate(k,S);var w=_-g;i.translate(w+5,S),0==v.filter(function(t){return""==t.type}).length&&(e.translate(m,x),i.translate(_+5,S)),0==v.filter(function(t){return""!=t.type}).length&&(e.translate(0,x),n.translate(0,S)),0==v.length&&(e.translate(m,x),n.translate(k,S),i.translate(w+5,S)),e.update(),n.update(),i.update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{};this.axisLineStroke(e.color).xTitle(n.name).yTitle(i.name).xTickShow(n.labelShow).yTickShow(i.labelShow).xDomain(n.range).yDomain(i.range).yLeftName(i.leftName).yLeftTitle(i.leftTitle).yRightName(i.rightName).yRightTitle(i.rightTitle)}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=Zn;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[Math.min(d3.min(t.filter(function(t){return""!=t.type}),function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t.filter(function(t){return""!=t.type}),function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1],i=t.length?[Math.min(d3.min(t.filter(function(t){return""==t.type}),function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t.filter(function(t){return""==t.type}),function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=e,this._yDomain=n,this._yDomain1=i}}]),o}(),Kn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","deformed-pie-chart"),e.core=e.rose=new N(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e}return c(n,L),a(n,[{key:"updateCore",value:function(){var i=this,n=i.rose,t=i._startAngle,e=i._endAngle,o=i.widthOfNoMargin,r=i.heightOfMainGroup,a=i._fontSize,l=o,s=r,u=S(l,s,t,e),c=u.radius,h=u.cx,d=u.cy,_=c+a;n.data(i.activeData).radius(c).startAngle(t).endAngle(e).cornerRadius(i._cornerRadius).stroke(i._stroke).strokeWidth(i._strokeWidth).sortMethod(i._sortMethod).transition(i._transition).duration(i._duration).onTransitionEnd(function(t,e){n.arcFunc.outerRadius()(t),d3.select(this.parentNode),t.startAngle,t.endAngle}).onMouseover(function(t,e){d3.select(this).transition().style("opacity",.8);var n=[{text:""+t.data.name,color:t.data.color},{text:t.data.valueLabel+": "+t.data.value}];i.tooltip.data(n).update().show()}).onMousemove(function(){i.tooltip.move()}).onMouseout(function(t){d3.select(this).transition().style("opacity",1),i.tooltip.hide()});var f=(o-l)/2+h,p=(r-s)/2+d,y=(_-c)/2;switch(u.quadrant){case 4:f+=y,p+=y;break;case 1:f-=y,p+=y;break;case 2:f-=y,p-=y;break;case 3:f+=y,p-=spcae}n.translate(f,p).update()}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"setSelfOption",value:function(t){var e=t.display;this.cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).stroke(e.areaBorderColor||this._stroke).strokeWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._strokeWidth))}}]),n}(),Jn=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._padAngle=.01,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=null,e._areaBorderColor="#fff",e._areaBorderWidth=0,e._labelShow=!0,e}return c(n,D),a(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow)}}]),n}(),$n=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","funnel-polygon"),e._fontColor="#ffffff",e}return c(n,T),a(n,[{key:"update",value:function(){var n=this,i=n._data,t=d3.max(i,function(t){return Math.abs(t.value)}),o=d3.scaleLinear().domain([0,t]).range([0,n._sWidth]),r=(0<n._sHeight?n._sHeight:0)/i.length,e=n.group;d3.selectAll(".funnel-groups").remove();var a=e.selectAll("polygon").data(i);a.exit().remove();var l=a.enter().append("g").attr("class","funnel-groups");return l.append("polygon").merge(a).attr("class","funnel-polygons").style("fill",function(t){return t.color}).style("fill-opacity",1).style("stroke","#ffffff").style("opacity",1).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(n._transition?n._duration:0).attr("points",function(t,e){return e==i.length-1?o(i[e].total)/2+.05*n._sWidth+","+r*e+"\n        "+(o(t.value)+o(i[e].total)/2+.05*n._sWidth)+","+r*e+" \n        "+(o(t.value)/2+o(i[e].total)/2+.05*n._sWidth)+","+r*(e+1):o(i[e].total)/2+.05*n._sWidth+","+r*e+"\n        "+(o(t.value)+o(i[e].total)/2+.05*n._sWidth)+","+r*e+" \n        "+(o(i[e+1].value)+o(i[e+1].total)/2+.05*n._sWidth)+","+r*(e+1)+" \n        "+(o(i[e+1].total)/2+.05*n._sWidth)+","+r*(e+1)}),l.append("text").merge(a).text(function(t){return t.name}).attr("class","funnel-texts").attr("fill",n._fontColor).attr("x",function(t,e){return o(t.value)/2+o(i[e].total)/2+.05*n._sWidth}).attr("y",function(t,e){return r*(e+1)-r/2}).attr("text-anchor","middle").attr("dy","0.5em").style("display",n._labelShow?"block":"none"),null==n._labelShow&&d3.selectAll(".funnel-texts").style("display","none"),n}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}}]),n}(),ti=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","funnel-chart"),e.funnel=new $n(e.mainGroup),e._sortValue=-1,e._labelShow=!0,e}return c(n,L),a(n,[{key:"updateCore",value:function(){for(var i=this,t=i.activeData,e=i.funnel,n=.9*i.widthOfNoMargin,o=i.heightOfMainGroup,r=0;r<t.length;r++)t[r].percent=0==r?0:t[r-1].value-t[r].value;for(var a=0;a<t.length;a++)t[a].total=0==a?0:t[a-1].total+parseFloat(t[a].percent);e.data(t).sWidth(n).sHeight(o).labelShow(i._labelShow).transition(i._transition).duration(i._duration).fontColor(i._fontColor).onTransitionEnd(function(t,e){}).onMouseover(function(t,e){d3.select(this).transition().duration(30).style("opacity",.8);var n=[{text:""+t.name,color:t.color},{text:t.valueLabel+": "+t.value}];i.tooltip.data(n).update().show()}).onMousemove(function(){i.tooltip.move()}).onMouseout(function(t){d3.select(this).transition().duration(30).style("opacity",1),i.tooltip.hide()}),i.funnel.update()}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e.display?e.display:this._labelShow)}}]),n}(),ei=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","histogram-chart"),e.selectOverlay=new Ee(e.coreGroup),e.grid=new vt(e.coreGroup),e.rectPlot=new Te(e.coreGroup),e.overlay=new gt(e.coreGroup),e.xAxis=new rt(e.mainGroup),e.yAxis=new st(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e}return c(n,ut),a(n,[{key:"updateCore",value:function(){var r=this,a=r.activeData,t=a.toString()?a[0].data:[],e=r.grid,l=r.tooltip,n=r.rectPlot,i=r.overlay,o=r.selectOverlay,s=r.xScale,u=r.yScale,c=r.widthOfCore,h=r.heightOfCore;i.data(s.domain()).bandWidth(s.step()).bandHeight(h).isScalePoint(!1).onMouseover(function(t,e){var n=s.domain()[e],i=[{text:n}];a.forEach(function(t){var e=t.data.filter(function(t){return t.name===n});i.push({text:t.name+": "+e[0].value,color:t.color})}),o.translate(s(n),0),l.data(i).update(),l.show(),o.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),o.hide()}),n.data(t).xScale(s).yScale(u).rectObj({xFunc:function(t,e){return s.step()*e+.15*s.step()},yFunc:function(t,e){return u(t.value)},widthFunc:function(t){return.7*s.step()},heightFunc:function(t){return u.range()[0]-u(t.value)}}).fillOpacity(1).onMousemove(function(t){var e=r.elem.node().parentNode,n=d3.mouse(e),i=a[0].name,o=[{text:t.name},{text:i+": "+t.value,color:t.color}];l.show(),l.data(o).update().move([n[0],n[1]]),d3.select(this).style("cursor","pointer")}).onMouseout(function(){l.hide()}),e.width(c).height(h).xTickLocations(r.xAxis.tickLocations.slice(1)).yTickLocations(r.yAxis.tickLocations.slice(1)).showX(r._gridShowX).showY(r._gridShowY).stroke(r._gridStroke).strokeDasharray(r._gridStrokeDasharray),o.width(s.step()).height(h).hide(),r.coreGroup.attr("transform","translate("+r.yAxis.width+","+r.yAxis.titleHeight+")"),n.update(),o.update(),i.update(),e.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e),i=Xe;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain||[]).slice().sort(d3.ascending),n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}(),ni=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bee-line-chart"),e._showPoints=!1,e._curve=d3.curveLinear,e._strokeWidth=2,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,xt),a(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n.display?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&this.strokeWidth(o(e.lineWidth?e.lineWidth:this._strokeWidth)).curve(i[e.lineType]||this._curve)}}]),n}(),ii=function(t){function n(t){r(this,n);var e=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stacked-linear-chart"),e.StackedScatterPlot=new Be(e.coreGroup),e.guideScatter=new Be(e.coreGroup),e._endPointRadius=2,e._radius=5,e._curve=d3.curveLinear,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e}return c(n,Ne),a(n,[{key:"updateCore",value:function(){for(var s=this,u=s.activeData,t=s.grid,e=s.areaPlot,n=s.linePlot,i=s.StackedScatterPlot,c=s.tooltip,o=s.overlay,h=s.guideLine,d=s.guideScatter,r=s.clipArea,_=s.xScale,a=s.yScale,l=s.widthOfCore,f=s.heightOfCore,p=0;p<u.length;p++)for(var y=0;y<u[p].data.length;y++)u[p].data[y].value=parseFloat(u[p].data[y].value),u[p].data[y].total=0==p?parseFloat(u[p].data[y].value):u[p-1].data[y].total+parseFloat(u[p].data[y].value);i.data(u).xScale(s.xScale).yScale(s.yScale).radius(s._endPointRadius).fill("#fff"),t.width(l).height(f).xTickLocations(s.xAxis.tickLocations.slice(1)).yTickLocations(s.yAxis.tickLocations.slice(1)).showX(s._gridShowX).showY(s._gridShowY).stroke(s._gridStroke).strokeDasharray(s._gridStrokeDasharray),e.data(u).xScale(_).yScale(a).curve(s._curve).areaFunc(d3.area().x(function(t){return _(t.name)}).y0(function(t){return a(t.total-t.value)}).y1(function(t){return a(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),n.data(u).xScale(_).yScale(a).fontSize(s._fontSize).labelShow(s._labelShow).positionOptions(s._positionOptions).positionChoice(s._positionChoice).curve(s._curve).lineFunc(d3.line().x(function(t){return _(t.name)}).y(function(t){return a(t.total)}).defined(function(t){return!isNaN(parseFloat(t.total))})),d.data(u).xScale(_).yScale(a).fill("#fff"),h.y1(0).y2(f).strokeDasharray(s._gridStrokeDasharray),o.width(l).height(f).onMouseover(function(){c.show(),h.show(),d.show()}).onMousemove(function(){var t=s.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[0],i=_.step(),o=Math.floor(n/i)+(.5<=n%i/i?1:0),r=_.domain()[o],a=[{text:r}],l=[];u.forEach(function(t){var e=t.data.filter(function(t){return t.name===r});l.push({key:t.key,name:t.name,color:t.color,data:e}),a.push({text:t.name+": "+e[0].value,color:t.color})}),c.data(a).update().move([e[0]+_(r)-n,e[1]]),h.x(_(r)).update(),d.data(l).radius(s._radius).update()}).onMouseout(function(){c.hide(),h.hide(),d.hide()}),r.width(l).height(f).paddingVertical([0,0]).transition(s._transition).duration(s._duration),s.coreGroup.call(E,s.yAxis.width+.5,s.yAxis.titleHeight),0!=s._clipShow.length&&(s.coreGroup.attr("clip-path","url(#"+r.id+")"),r.update()),d.elem.style("pointer-events","none"),t.update(),o.update(),e.update(),n.update(),i.update()}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e.display?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice)}}]),n}();var oi=new Date;oi.toLocaleDateString(),console.log("d3Chart update"+oi),t.RoundCornerDonutChart=j,t.RoundCornerPieChart=G,t.StepLineChart=kt,t.MultipleBarChart=we,t.GroupingBubbleChart=Ae,t.CalendarHeatmapChart=Le,t.HollowChart=Ge,t.StackedChart=Ne,t.FormWaterfallHistogramChart=qe,t.ChangeWaterfallHistogramChart=Ye,t.SimpleBarChart=Ze,t.PieChart=D,t.HistogramChart=ei,t.ProgressRoundPieChart=Je,t.HalfProgressPieChart=$e,t.HalfPieChart=en,t.SlopeChart=hn,t.BarProgressChart=_n,t.PolygonRadarChart=gn,t.RankingChangeChart=Sn,t.PercentageBarChart=An,t.PercentageAreaChart=Fn,t.ArcDiagramChart=Ln,t.BasicHorizontalBarChart=Tn,t.StackBarChart=Dn,t.StackHorizontalBarChart=Gn,t.GroupedBarChart=Nn,t.GroupedHorizontalBarChart=Hn,t.NegativeHorizontalBarChart=Vn,t.MixLineBarChart=Un,t.MultipleLineChart=xt,t.DeformedPieChart=Kn,t.DonutChart=Jn,t.FunnelChart=ti,t.BeeLineChart=ni,t.StackedLinearChart=ii,t.setUserMd=function(t){window.userId=t},Object.defineProperty(t,"__esModule",{value:!0})});
